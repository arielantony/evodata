------------------------------------------------------------------------
r70505 | drsassafras | 2019-07-26 15:20:21 -0400 (sex, 26 jul 2019) | 1 line

[ENH][DB] OCR - Implements gallery level language control over OCR, (with code style, performance and php notice improvements)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 70504)
+++ tiki.sql	(revision 70505)
@@ -799,6 +799,7 @@
   `image_max_size_y` int(8) NOT NULL default '0',
   `show_source` char(1) NOT NULL DEFAULT 'o',
   `icon_fileId` int(14) UNSIGNED NULL DEFAULT NULL,
+  `ocr_lang` VARCHAR(255) default NULL,
   PRIMARY KEY (`galleryId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
@@ -838,7 +839,7 @@
   `archiveId` int(14) default 0,
   `deleteAfter` int(14) default NULL,
   `ocr_state` TINYINT(1) default NULL,
-  `ocr_lang` VARCHAR(11) default NULL,
+  `ocr_lang` VARCHAR(255) default NULL,
   `ocr_data` MEDIUMTEXT default NULL,
   PRIMARY KEY (`fileId`),
   KEY `name` (name(191)),

------------------------------------------------------------------------
r70288 | drsassafras | 2019-06-28 15:15:38 -0400 (sex, 28 jun 2019) | 1 line

[ENH][DB] OCR - usability enhancements & viewing features

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 70287)
+++ tiki.sql	(revision 70288)
@@ -785,6 +785,7 @@
   `show_explorer` char(1) default NULL,
   `show_path` char(1) default NULL,
   `show_slideshow` char(1) default NULL,
+  `show_ocr_state` char(1) default NULL,
   `default_view` varchar(20) default NULL,
   `quota` int(8) default 0,
   `size` int(14) default NULL,

------------------------------------------------------------------------
r70205 | pom2ter | 2019-06-11 21:52:30 -0400 (ter, 11 jun 2019) | 1 line

[MRG] Automatic merge, branches/20.x 70196 to 70204

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 70204)
+++ tiki.sql	(revision 70205)
@@ -4005,15 +4005,6 @@
 	`groups` BLOB NOT NULL
 ) ENGINE=MyISAM;
 
-DROP TABLE IF EXISTS `tiki_addon_profiles`;
-CREATE TABLE `tiki_addon_profiles` (
-  `addon` VARCHAR(100) NOT NULL DEFAULT '',
-  `version` VARCHAR(100) NOT NULL DEFAULT '',
-  `profile` VARCHAR(100) NOT NULL DEFAULT '',
-  `install_date` TIMESTAMP,
-  PRIMARY KEY (`addon`,`version`(10),`profile`(81))
-) ENGINE=MyISAM;
-
 DROP TABLE IF EXISTS `tiki_tabular_formats`;
 CREATE TABLE `tiki_tabular_formats` (
 	`tabularId` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,

------------------------------------------------------------------------
r70082 | kroky6 | 2019-05-27 04:54:11 -0400 (seg, 27 mai 2019) | 1 line

[FIX] update tiki.sql with webmail removal changes

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 70081)
+++ tiki.sql	(revision 70082)
@@ -2563,30 +2563,6 @@
     PRIMARY KEY (`userId`, `secret`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
-DROP TABLE IF EXISTS `tiki_user_mail_accounts`;
-CREATE TABLE `tiki_user_mail_accounts` (
-  `accountId` int(12) NOT NULL auto_increment,
-  `user` varchar(200) NOT NULL default '',
-  `account` varchar(50) NOT NULL default '',
-  `pop` varchar(255) default NULL,
-  `current` char(1) default NULL,
-  `port` int(4) default NULL,
-  `username` varchar(100) default NULL,
-  `pass` varchar(100) default NULL,
-  `msgs` int(4) default NULL,
-  `smtp` varchar(255) default NULL,
-  `useAuth` char(1) default NULL,
-  `smtpPort` int(4) default NULL,
-  `flagsPublic` char(1) default 'n',                -- COMMENT 'MatWho - Shared Group Mail box if y',
-  `autoRefresh` int(4) NOT NULL default 0,        -- COMMENT 'seconds for mail list to refresh, 0 = none',
-  `imap` varchar( 255 ) default NULL,
-  `mbox` varchar( 255 ) default NULL,
-  `maildir` varchar( 255 ) default NULL,
-  `useSSL` char( 1 ) NOT NULL default 'n',
-  `fromEmail` varchar( 255 ) NOT NULL default '',
-  PRIMARY KEY (`accountId`)
-) ENGINE=MyISAM AUTO_INCREMENT=1 ;
-
 DROP TABLE IF EXISTS `tiki_user_menus`;
 CREATE TABLE `tiki_user_menus` (
   `user` varchar(200) NOT NULL default '',
@@ -2763,18 +2739,6 @@
   PRIMARY KEY (`contactId`,`groupName`(179))
 ) ENGINE=MyISAM ;
 
-DROP TABLE IF EXISTS `tiki_webmail_messages`;
-CREATE TABLE `tiki_webmail_messages` (
-  `accountId` int(12) NOT NULL default '0',
-  `mailId` varchar(255) NOT NULL default '',
-  `user` varchar(200) NOT NULL default '',
-  `isRead` char(1) default NULL,
-  `isReplied` char(1) default NULL,
-  `isFlagged` char(1) default NULL,
-  `flaggedMsg` varchar(50) default '',
-  PRIMARY KEY (`accountId`,`mailId`(179))
-) ENGINE=MyISAM;
-
 DROP TABLE IF EXISTS `tiki_wiki_attachments`;
 CREATE TABLE `tiki_wiki_attachments` (
   `attId` int(12) NOT NULL auto_increment,

------------------------------------------------------------------------
r70069 | xorti | 2019-05-24 09:54:24 -0400 (sex, 24 mai 2019) | 1 line

[FIX] Fix issues in schedulers and user notes to support database strict mode on

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 70068)
+++ tiki.sql	(revision 70069)
@@ -2615,7 +2615,7 @@
   `created` int(14) default NULL,
   `name` varchar(255) default NULL,
   `lastModif` int(14) default NULL,
-  `data` text,
+  `data` LONGBLOB,
   `size` int(14) default NULL,
   `parse_mode` varchar(20) default NULL,
   PRIMARY KEY (`noteId`)

------------------------------------------------------------------------
r70027 | xorti | 2019-05-20 12:03:32 -0400 (seg, 20 mai 2019) | 1 line

[ENH] Improvements in scheduler runs when cron is not set to run on every minute

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 70026)
+++ tiki.sql	(revision 70027)
@@ -4070,7 +4070,8 @@
   `params` TEXT,
   `run_time` VARCHAR(255),
   `status` VARCHAR(10),
-  `re_run` TINYINT
+  `re_run` TINYINT,
+  `creation_date` INT(14)
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_scheduler_run`;

------------------------------------------------------------------------
r69370 | jonnybradley | 2019-03-05 21:26:13 -0400 (ter, 05 mar 2019) | 2 lines

[FIX] objects: Missed from r69345 for new installs (thanks marclaporte)
...For tiki pages tiki_objects.href needs to be long enough for the 160 char page name to be url encoded plus adding tiki-index.php?page= before it. This still may not be enough 100% of the time but gives us extra wiggle room...

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 69369)
+++ tiki.sql	(revision 69370)
@@ -478,7 +478,7 @@
   `description` text,
   `created` int(14) default NULL,
   `name` varchar(200) default NULL,
-  `href` varchar(200) default NULL,
+  `href` varchar(256) default NULL,
   `hits` int(8) default NULL,
   `comments_locked` char(1) NOT NULL default 'n',
   PRIMARY KEY (`objectId`),

------------------------------------------------------------------------
r69037 | rjsmelo | 2019-02-10 20:45:47 -0400 (dom, 10 fev 2019) | 1 line

[MRG] Automatic merge, branches/19.x 69032 to 69035

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 69036)
+++ tiki.sql	(revision 69037)
@@ -1069,18 +1069,24 @@
 	title        VARCHAR(255) NOT NULL,
 	library_id   INT UNSIGNED NOT NULL,
 	parameters   LONGTEXT     NOT NULL,
-	filtered     LONGTEXT     NOT NULL,
+	filtered     LONGTEXT     NULL,
 	slug         VARCHAR(127) NOT NULL,
 	embed_type   VARCHAR(127) NOT NULL,
 	disable      INT UNSIGNED NOT NULL DEFAULT 0,
 	content_type VARCHAR(127) NULL,
-	author       VARCHAR(127) NULL,
-	license      VARCHAR(7)   NULL,
+	authors      MEDIUMTEXT   NULL,
+	license      VARCHAR(32)  NULL DEFAULT NULL,
 	keywords     TEXT         NULL,
 	description  TEXT         NULL,
+	source       VARCHAR(2083) NULL,
+	year_from    INT UNSIGNED NULL,
+	year_to      INT UNSIGNED NULL,
+	license_version VARCHAR(10) NULL,
+	license_extras  LONGTEXT NULL,
+	author_comments LONGTEXT NULL,
+	changes      MEDIUMTEXT NULL,
 	PRIMARY KEY (id),
 	UNIQUE KEY `fileId` (`file_id`)
-
 )	ENGINE = MyISAM;
 
 # Keep track of content dependencies
@@ -1114,6 +1120,9 @@
 	drop_library_css TEXT          NULL,
 	semantics        TEXT          NOT NULL,
 	tutorial_url     VARCHAR(1023) NOT NULL,
+	has_icon         INT  UNSIGNED  NOT NULL  DEFAULT '0',
+	metadata_settings TEXT NULL,
+	add_to           TEXT DEFAULT NULL,
 	PRIMARY KEY (id),
 	KEY name_version (name, major_version, minor_version, patch_version),
 	KEY runnable (runnable)

------------------------------------------------------------------------
r68910 | montefuscolo | 2019-01-29 14:43:06 -0400 (ter, 29 jan 2019) | 1 line

[FIX] Ambiguity on OAuth property name

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 68909)
+++ tiki.sql	(revision 68910)
@@ -4078,12 +4078,12 @@
 
 DROP TABLE IF EXISTS `tiki_oauthserver_clients`;
 CREATE TABLE `tiki_oauthserver_clients` (
-    `identifier` INT(14) NOT NULL AUTO_INCREMENT,
+    `id` INT(14) NOT NULL AUTO_INCREMENT,
     `name` VARCHAR(128) NOT NULL DEFAULT '',
     `client_id` VARCHAR(128) UNIQUE NOT NULL DEFAULT '',
     `client_secret` VARCHAR(255) NOT NULL DEFAULT '',
     `redirect_uri` VARCHAR(255) NOT NULL DEFAULT '',
-    PRIMARY KEY (`identifier`)
+    PRIMARY KEY (`id`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1;
 
 SET FOREIGN_KEY_CHECKS = 1;

------------------------------------------------------------------------
r68713 | montefuscolo | 2019-01-17 20:44:21 -0400 (qui, 17 jan 2019) | 1 line

[NEW][WIP] Creating user interface to register oauth clients id and secrets

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 68712)
+++ tiki.sql	(revision 68713)
@@ -4076,4 +4076,14 @@
   `healed` TINYINT DEFAULT 0
 ) ENGINE=MyISAM;
 
+DROP TABLE IF EXISTS `tiki_oauthserver_clients`;
+CREATE TABLE `tiki_oauthserver_clients` (
+    `identifier` INT(14) NOT NULL AUTO_INCREMENT,
+    `name` VARCHAR(128) NOT NULL DEFAULT '',
+    `client_id` VARCHAR(128) UNIQUE NOT NULL DEFAULT '',
+    `client_secret` VARCHAR(255) NOT NULL DEFAULT '',
+    `redirect_uri` VARCHAR(255) NOT NULL DEFAULT '',
+    PRIMARY KEY (`identifier`)
+) ENGINE=MyISAM AUTO_INCREMENT=1;
+
 SET FOREIGN_KEY_CHECKS = 1;

------------------------------------------------------------------------
r68460 | jonnybradley | 2018-11-30 07:50:32 -0400 (sex, 30 nov 2018) | 1 line

[MRG] Automatic merge, branches/19.x 68452 to 68459

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 68459)
+++ tiki.sql	(revision 68460)
@@ -4045,7 +4045,7 @@
 CREATE TABLE `tiki_tabular_formats` (
 	`tabularId` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
 	`trackerId` INT NOT NULL,
-	`name` VARCHAR(30) NOT NULL,
+	`name` VARCHAR(255) NOT NULL,
 	`format_descriptor` TEXT,
 	`filter_descriptor` TEXT,
 	`config` TEXT,

------------------------------------------------------------------------
r68295 | drsassafras | 2018-11-13 01:07:39 -0400 (ter, 13 nov 2018) | 1 line

[NEW] OCR functionality, basic framework

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 68294)
+++ tiki.sql	(revision 68295)
@@ -836,6 +836,9 @@
   `comment` varchar(200) default NULL,
   `archiveId` int(14) default 0,
   `deleteAfter` int(14) default NULL,
+  `ocr_state` TINYINT(1) default NULL,
+  `ocr_lang` VARCHAR(11) default NULL,
+  `ocr_data` MEDIUMTEXT default NULL,
   PRIMARY KEY (`fileId`),
   KEY `name` (name(191)),
   KEY `description` (description(191)),

------------------------------------------------------------------------
r67998 | amnabilal | 2018-10-15 15:06:14 -0400 (seg, 15 out 2018) | 1 line

[MRG] Automatic merge, branches/19.x 67988 to 67997

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 67997)
+++ tiki.sql	(revision 67998)
@@ -984,7 +984,7 @@
   `user` varchar(200) default '',
   `timestamp` int(14) default NULL,
   `reason` varchar(250) default NULL,
-  PRIMARY KEY (`threadId`)
+  PRIMARY KEY (`threadId`, `forumId`, `parentId`, `user`(182))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_galleries`;
@@ -3208,8 +3208,8 @@
 
 DROP TABLE IF EXISTS `tiki_pages_changes`;
 CREATE TABLE `tiki_pages_changes` (
-  `page_id` int(14),
-  `version` int(10),
+  `page_id` int(14) DEFAULT '0',
+  `version` int(10) DEFAULT '0',
   `segments_added` int(10),
   `segments_removed` int(10),
   `segments_total` int(10),
@@ -4031,9 +4031,9 @@
 
 DROP TABLE IF EXISTS `tiki_addon_profiles`;
 CREATE TABLE `tiki_addon_profiles` (
-  `addon` VARCHAR(100),
-  `version` VARCHAR(100),
-  `profile` VARCHAR(100),
+  `addon` VARCHAR(100) NOT NULL DEFAULT '',
+  `version` VARCHAR(100) NOT NULL DEFAULT '',
+  `profile` VARCHAR(100) NOT NULL DEFAULT '',
   `install_date` TIMESTAMP,
   PRIMARY KEY (`addon`,`version`(10),`profile`(81))
 ) ENGINE=MyISAM;

------------------------------------------------------------------------
r67955 | rjsmelo | 2018-10-11 19:21:16 -0400 (qui, 11 out 2018) | 1 line

[MRG] Automatic merge, branches/19.x 67949 to 67954

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 67954)
+++ tiki.sql	(revision 67955)
@@ -23,7 +23,7 @@
   `isFlagged` char(1) default NULL,
   `priority` int(2) default NULL,
   PRIMARY KEY (`msgId`),
-  KEY `userIsRead` (user(191), `isRead`)
+  KEY `userIsRead` (user(190), `isRead`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `messu_archive`;
@@ -100,7 +100,7 @@
   `name` varchar(40) NOT NULL,
   `value` text,
   KEY `actionId` (`actionId`),
-  KEY `nameValue` (`name`, `value`(191))
+  KEY `nameValue` (`name`, `value`(151))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_activity_stream`;
@@ -483,7 +483,7 @@
   `comments_locked` char(1) NOT NULL default 'n',
   PRIMARY KEY (`objectId`),
   KEY (`type`, `objectId`),
-  KEY (`itemId`(191), `type`)
+  KEY (`itemId`(141), `type`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `tiki_categorized_objects`;
@@ -541,7 +541,7 @@
   `nickname` varchar(200) NOT NULL default '',
   `channelId` int(8) NOT NULL default '0',
   `timestamp` int(14) default NULL,
-  PRIMARY KEY (`nickname`(191),`channelId`)
+  PRIMARY KEY (`nickname`(183),`channelId`)
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_comments`;
@@ -572,14 +572,14 @@
   `approved` char(1) NOT NULL default 'y',
   `locked` char(1) NOT NULL default 'n',
   PRIMARY KEY (`threadId`),
-  UNIQUE KEY `no_repeats` (`parentId`, `userName`(40), `title`(100), `commentDate`, `message_id`(40), `in_reply_to`(40)),
+  UNIQUE KEY `no_repeats` (`parentId`, `userName`(40), `title`(43), `commentDate`, `message_id`(40), `in_reply_to`(40)),
   KEY `title` (`title`(191)),
   KEY `data` (`data`(191)),
   KEY `hits` (hits),
   KEY `tc_pi` (`parentId`),
-  KEY `objectType` (object(191), `objectType`),
+  KEY `objectType` (object(160), `objectType`),
   KEY `commentDate` (`commentDate`),
-  KEY `threaded` (message_id, in_reply_to, `parentId`)
+  KEY `threaded` (message_id(89), in_reply_to(88), `parentId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `tiki_content`;
@@ -604,7 +604,7 @@
 CREATE TABLE `tiki_content_templates_sections` (
   `templateId` int(10) NOT NULL default '0',
   `section` varchar(250) NOT NULL default '',
-  PRIMARY KEY (`templateId`,`section`(191))
+  PRIMARY KEY (`templateId`,`section`(181))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_cookies`;
@@ -858,7 +858,7 @@
   `metadata` longtext,
   `lastModif` integer(14) DEFAULT NULL,
   `lockedby` varchar(200) default '',
-  PRIMARY KEY (`fileId`, `user`(191))
+  PRIMARY KEY (`fileId`, `user`(177))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_forum_attachments`;
@@ -884,7 +884,7 @@
   `threadId` int(14) NOT NULL default '0',
   `forumId` int(14) default NULL,
   `timestamp` int(14) default NULL,
-  PRIMARY KEY (`user`(191),`threadId`)
+  PRIMARY KEY (`user`(177),`threadId`)
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_forums`;
@@ -1024,7 +1024,7 @@
   KEY `description` (description(191)),
   KEY `hits` (hits),
   KEY `parentgallery` (parentgallery),
-  KEY `visibleUser` (visible, user(191))
+  KEY `visibleUser` (visible, user(190))
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `tiki_galleries_scales`;
@@ -1305,7 +1305,7 @@
 CREATE TABLE `tiki_links` (
   `fromPage` varchar(160) NOT NULL default '',
   `toPage` varchar(160) NOT NULL default '',
-  PRIMARY KEY (`fromPage`,`toPage`),
+  PRIMARY KEY (`fromPage`(96),`toPage`(95)),
   KEY `toPage` (`toPage`)
 ) ENGINE=MyISAM;
 
@@ -1744,7 +1744,7 @@
   `subscribed` int(14) default NULL,
   `isUser` char(1) NOT NULL default 'n',
   `included` char(1) NOT NULL default 'n',
-  PRIMARY KEY (`nlId`,`email`(191),`isUser`)
+  PRIMARY KEY (`nlId`,`email`(178),`isUser`)
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_newsletter_groups`;
@@ -1753,7 +1753,7 @@
   `groupName` varchar(255) NOT NULL default '',
   `code` varchar(32) default NULL,
   `include_groups` char(1) DEFAULT 'y',
-  PRIMARY KEY (`nlId`,`groupName`(191))
+  PRIMARY KEY (`nlId`,`groupName`(179))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_newsletter_included`;
@@ -1878,7 +1878,7 @@
   `voteConsiderationSpan` int(4) default 0,
   PRIMARY KEY (`pollId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
-ALTER TABLE tiki_polls ADD INDEX tiki_poll_lookup ( active , title(191) );
+ALTER TABLE tiki_polls ADD INDEX tiki_poll_lookup ( active , title(190) );
 
 DROP TABLE IF EXISTS `tiki_preferences`;
 CREATE TABLE `tiki_preferences` (
@@ -2106,7 +2106,7 @@
   `filename` varchar(250) NOT NULL,
   `tiki_version` varchar(60) NOT NULL,
   `severity` int(4) NOT NULL default '0',
-  PRIMARY KEY (`filename`(191),`tiki_version`),
+  PRIMARY KEY (`filename`(171),`tiki_version`(20)),
   KEY `sdb_fn` (filename(191))
 ) ENGINE=MyISAM;
 
@@ -2518,7 +2518,7 @@
   `ord` int(4) NOT NULL default 0,
   `type` char(1) default NULL,
   `user` varchar(200) NOT NULL default '',
-  PRIMARY KEY (`name`(30),`user`(191),`position`, `ord`),
+  PRIMARY KEY (`name`(30),`user`(137),`position`, `ord`),
   KEY `id` (moduleId)
 ) ENGINE=MyISAM;
 
@@ -2528,7 +2528,7 @@
   `parentId` int(12) default NULL,
   `user` varchar(200) NOT NULL default '',
   `name` varchar(30) default NULL,
-  PRIMARY KEY (`user`(191),`folderId`)
+  PRIMARY KEY (`user`(179),`folderId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `tiki_user_bookmarks_urls`;
@@ -2624,7 +2624,7 @@
   `user` varchar(200) NOT NULL default '',
   `prefName` varchar(40) NOT NULL default '',
   `value` TEXT,
-  PRIMARY KEY (`user`(191),`prefName`)
+  PRIMARY KEY (`user`(151),`prefName`)
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_user_quizzes`;
@@ -2644,7 +2644,7 @@
 CREATE TABLE `tiki_user_taken_quizzes` (
   `user` varchar(200) NOT NULL default '',
   `quizId` varchar(255) NOT NULL default '',
-  PRIMARY KEY (`user`(191),`quizId`(50))
+  PRIMARY KEY (`user`(141),`quizId`(50))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_user_tasks_history`;
@@ -2681,7 +2681,7 @@
   `completed` int(14) default NULL,
   `percentage` int(4) default NULL,
   PRIMARY KEY (`taskId`),
-  UNIQUE(creator(191), created)
+  UNIQUE(creator(177), created)
 ) ENGINE=MyISAM AUTO_INCREMENT=1;
 
 DROP TABLE IF EXISTS `tiki_user_votings`;
@@ -2748,7 +2748,7 @@
 CREATE TABLE `tiki_webmail_contacts_groups` (
   `contactId` int(12) NOT NULL,
   `groupName` varchar(255) NOT NULL,
-  PRIMARY KEY (`contactId`,`groupName`(191))
+  PRIMARY KEY (`contactId`,`groupName`(179))
 ) ENGINE=MyISAM ;
 
 DROP TABLE IF EXISTS `tiki_webmail_messages`;
@@ -2760,7 +2760,7 @@
   `isReplied` char(1) default NULL,
   `isFlagged` char(1) default NULL,
   `flaggedMsg` varchar(50) default '',
-  PRIMARY KEY (`accountId`,`mailId`(191))
+  PRIMARY KEY (`accountId`,`mailId`(179))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_wiki_attachments`;
@@ -2795,7 +2795,7 @@
   `date` int(14) NOT NULL default '0',
   `IP` varchar(50) NOT NULL default '',
   PRIMARY KEY (`id`),
-  KEY `object` (object(191),`userId`,type),
+  KEY `object` (object(163),`userId`,type),
   KEY `userId` (`userId`),
   KEY `type` (type),
   KEY `date` (date)
@@ -2845,7 +2845,7 @@
   `permName` varchar(40) NOT NULL default '',
   `objectType` varchar(20) NOT NULL default '',
   `objectId` varchar(32) NOT NULL default '',
-  PRIMARY KEY `uo` (`objectId`, `objectType`, `groupName`(170),`permName`)
+  PRIMARY KEY `uo` (`objectId`, `objectType`, `groupName`(99),`permName`)
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `users_permissions`;
@@ -2861,7 +2861,7 @@
   `groupName` varchar(255) NOT NULL default '',
   `created` int(14) default NULL,
   `expire` int(14) default NULL,
-  PRIMARY KEY (`userId`,`groupName`(191))
+  PRIMARY KEY (`userId`,`groupName`(183))
 ) ENGINE=MyISAM;
 
 INSERT INTO users_groups (`groupName`,`groupDesc`) VALUES ('Anonymous','Public users not logged');
@@ -2947,7 +2947,7 @@
   `type` varchar(50) NOT NULL,
   `objId` varchar(255) NOT NULL,
   `lang` varchar(16) default NULL,
-  PRIMARY KEY (`type`, `objId`(191)),
+  PRIMARY KEY (`type`, `objId`(141)),
   KEY `traId` ( `traId` )
 ) ENGINE=MyISAM AUTO_INCREMENT=1;
 
@@ -3049,7 +3049,7 @@
   `type` varchar(20) NOT NULL default '',
   `day` int(14) NOT NULL default '0',
   `hits` int(14) NOT NULL default '0',
-  PRIMARY KEY (`object`(191),`type`,`day`)
+  PRIMARY KEY (`object`(157),`type`,`day`)
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_registration_fields`;
@@ -3150,7 +3150,7 @@
   `objectId` int(11) NOT NULL default 0,
   `user` varchar(200) default '',
   `created` int(14) NOT NULL default '0',
-  PRIMARY KEY (`tagId`,`user`(191),`objectId`),
+  PRIMARY KEY (`tagId`,`user`(168),`objectId`),
   KEY (`tagId`),
   KEY (user(191)),
   KEY (`objectId`)
@@ -3237,7 +3237,7 @@
   `value` VARCHAR(160) NOT NULL,
   `named` ENUM('y','n') NOT NULL,
   `creation_date` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
-  PRIMARY KEY ( `domain`, `profile`, `object` ),
+  PRIMARY KEY ( `domain`, `profile`(70), `object`(71) ),
   INDEX(`named`)
 ) ENGINE=MyISAM;
 
@@ -3306,7 +3306,7 @@
   `objectType` varchar( 20 ) NOT NULL default '',
   `objectId` varchar(10) NOT NULL default '',
   `displayEachuser` char( 1 ) default NULL ,
-  PRIMARY KEY (`groupName`(191), `objectType`, `objectId` )
+  PRIMARY KEY (`groupName`(161), `objectType`, `objectId` )
 ) ENGINE=MyISAM ;
 
 DROP TABLE IF EXISTS `tiki_sent_newsletters_files`;
@@ -3435,7 +3435,7 @@
   `last_objectType` VARCHAR(20) NOT NULL,
   `last_objectId` VARCHAR(200) NOT NULL,
   PRIMARY KEY (`fingerprint`(191)),
-  KEY `last_object` (last_objectType, last_objectId(191))
+  KEY `last_object` (last_objectType, last_objectId(171))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_user_reports`;
@@ -3485,7 +3485,7 @@
     `to` varchar(255) NOT NULL,
     `guards` text,
     PRIMARY KEY(`transitionId`),
-    KEY `transition_lookup` (`type`, `from`(191))
+    KEY `transition_lookup` (`type`, `from`(171))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_auth_tokens`;
@@ -3576,7 +3576,7 @@
     `content` TEXT,
     `categories` TEXT,
     KEY `tiki_rss_items_rss` (`rssId`),
-    KEY `tiki_rss_items_item` (`rssId`, `guid`(191))
+    KEY `tiki_rss_items_item` (`rssId`, `guid`(177))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_object_attributes`;
@@ -3587,8 +3587,8 @@
     `attribute` varchar(70) NOT NULL,
     `value` varchar(255),
 	`comment` varchar(255),
-    UNIQUE `item_attribute_uq` ( `type`, `itemId`, `attribute` ),
-    KEY `attribute_lookup_ix` (`attribute`, `value`(191))
+    UNIQUE `item_attribute_uq` ( `type`, `itemId`(91), `attribute`(50) ),
+    KEY `attribute_lookup_ix` (`attribute`, `value`(121))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_rating_configs`;
@@ -3633,7 +3633,7 @@
     `from` VARCHAR(255) default NULL,
     `to` VARCHAR(255) default NULL,
     PRIMARY KEY (`todoId`),
-    KEY `what` (`objectType`, `objectId`(191)),
+    KEY `what` (`objectType`, `objectId`(141)),
     KEY `after` (`after`)
 ) ENGINE=MyISAM;
 DROP TABLE IF EXISTS `tiki_todo_notif`;
@@ -3884,7 +3884,7 @@
     `path` VARCHAR(200) NOT NULL,
     `method` VARCHAR(20) NOT NULL,
     `arguments` TEXT NOT NULL,
-    KEY `tiki_source_auth_ix` (`scheme`, `domain`(191))
+    KEY `tiki_source_auth_ix` (`scheme`, `domain`(171))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_connect`;
@@ -4035,7 +4035,7 @@
   `version` VARCHAR(100),
   `profile` VARCHAR(100),
   `install_date` TIMESTAMP,
-  PRIMARY KEY (`addon`,`version`,`profile`)
+  PRIMARY KEY (`addon`,`version`(10),`profile`(81))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_tabular_formats`;

------------------------------------------------------------------------
r67620 | rjsmelo | 2018-09-23 22:22:13 -0400 (dom, 23 set 2018) | 2 lines

[REF] Upgrade tiki to utf8mb4


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 67619)
+++ tiki.sql	(revision 67620)
@@ -1,9 +1,8 @@
 -- --------------------------------------------------------
--- --------------------------------------------------------
 -- Database : Tiki
 -- --------------------------------------------------------
 
-ALTER DATABASE DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci;
+ALTER DATABASE DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
 SET FOREIGN_KEY_CHECKS = 0;  /* tiki doesn't officially use foreign keys but sometimes they "appear", leading to table dropping errors */
 
 DROP TABLE IF EXISTS `messu_messages`;
@@ -24,7 +23,7 @@
   `isFlagged` char(1) default NULL,
   `priority` int(2) default NULL,
   PRIMARY KEY (`msgId`),
-  KEY `userIsRead` (user, `isRead`)
+  KEY `userIsRead` (user(191), `isRead`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `messu_archive`;
@@ -101,7 +100,7 @@
   `name` varchar(40) NOT NULL,
   `value` text,
   KEY `actionId` (`actionId`),
-  KEY `nameValue` (`name`, `value`(200))
+  KEY `nameValue` (`name`, `value`(191))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_activity_stream`;
@@ -167,9 +166,9 @@
   `isfloat` char(1) default NULL,
   `ispublished` char(1) NOT NULL DEFAULT 'y',
   PRIMARY KEY (`articleId`),
-  KEY `title` (`title`),
-  KEY `heading` (`heading`(255)),
-  KEY `body` (`body`(255)),
+  KEY `title` (`title` (191)),
+  KEY `heading` (`heading`(191)),
+  KEY `body` (`body`(191)),
   KEY `nbreads` (`nbreads`),
   KEY `author` (`author`(32)),
   KEY `topicId` (`topicId`),
@@ -298,7 +297,7 @@
   `priv` varchar(1) default 'n',
   `wysiwyg` varchar(1) default NULL,
   PRIMARY KEY (`postId`),
-  KEY `data` (`data`(255)),
+  KEY `data` (`data`(191)),
   KEY `blogId` (`blogId`),
   KEY `created` (`created`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
@@ -344,8 +343,8 @@
   `show_related` char(1) default NULL,
   `related_max` int(4) default 5,
   PRIMARY KEY (`blogId`),
-  KEY `title` (`title`),
-  KEY `description` (`description`(255)),
+  KEY `title` (`title`(191)),
+  KEY `description` (`description`(191)),
   KEY `hits` (`hits`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
@@ -484,7 +483,7 @@
   `comments_locked` char(1) NOT NULL default 'n',
   PRIMARY KEY (`objectId`),
   KEY (`type`, `objectId`),
-  KEY (`itemId`, `type`)
+  KEY (`itemId`(191), `type`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `tiki_categorized_objects`;
@@ -542,7 +541,7 @@
   `nickname` varchar(200) NOT NULL default '',
   `channelId` int(8) NOT NULL default '0',
   `timestamp` int(14) default NULL,
-  PRIMARY KEY (`nickname`,`channelId`)
+  PRIMARY KEY (`nickname`(191),`channelId`)
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_comments`;
@@ -574,11 +573,11 @@
   `locked` char(1) NOT NULL default 'n',
   PRIMARY KEY (`threadId`),
   UNIQUE KEY `no_repeats` (`parentId`, `userName`(40), `title`(100), `commentDate`, `message_id`(40), `in_reply_to`(40)),
-  KEY `title` (`title`),
-  KEY `data` (`data`(255)),
+  KEY `title` (`title`(191)),
+  KEY `data` (`data`(191)),
   KEY `hits` (hits),
   KEY `tc_pi` (`parentId`),
-  KEY `objectType` (object, `objectType`),
+  KEY `objectType` (object(191), `objectType`),
   KEY `commentDate` (`commentDate`),
   KEY `threaded` (message_id, in_reply_to, `parentId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
@@ -605,7 +604,7 @@
 CREATE TABLE `tiki_content_templates_sections` (
   `templateId` int(10) NOT NULL default '0',
   `section` varchar(250) NOT NULL default '',
-  PRIMARY KEY (`templateId`,`section`)
+  PRIMARY KEY (`templateId`,`section`(191))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_cookies`;
@@ -659,7 +658,7 @@
 CREATE TABLE `tiki_directory_search` (
   `term` varchar(250) NOT NULL default '',
   `hits` int(14) default NULL,
-  PRIMARY KEY (`term`)
+  PRIMARY KEY (`term`(191))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_directory_sites`;
@@ -677,7 +676,7 @@
   `cache_timestamp` int(14) default NULL,
   PRIMARY KEY (`siteId`),
   KEY (`isValid`),
-  KEY (url)
+  KEY (url(191))
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `tiki_dsn`;
@@ -715,8 +714,8 @@
   `created` int(14) default NULL,
   PRIMARY KEY (`questionId`),
   KEY `faqId` (`faqId`),
-  KEY `question` (question(255)),
-  KEY `answer` (answer(255)),
+  KEY `question` (question(191)),
+  KEY `answer` (answer(191)),
   KEY `created` (`created`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
@@ -730,8 +729,8 @@
   `hits` int(8) default NULL,
   `canSuggest` char(1) default NULL,
   PRIMARY KEY (`faqId`),
-  KEY `title` (title),
-  KEY `description` (description(255)),
+  KEY `title` (title(191)),
+  KEY `description` (description(191)),
   KEY `hits` (hits)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
@@ -743,7 +742,7 @@
   `hits` int(8) default NULL,
   `position` int(6) default NULL,
   `type` char(1) default NULL,
-  PRIMARY KEY (`url`)
+  PRIMARY KEY (`url`(191))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_file_galleries`;
@@ -838,8 +837,8 @@
   `archiveId` int(14) default 0,
   `deleteAfter` int(14) default NULL,
   PRIMARY KEY (`fileId`),
-  KEY `name` (name),
-  KEY `description` (description(255)),
+  KEY `name` (name(191)),
+  KEY `description` (description(191)),
   KEY `created` (created),
   KEY `archiveId` (`archiveId`),
   KEY `galleryId` (`galleryId`),
@@ -859,7 +858,7 @@
   `metadata` longtext,
   `lastModif` integer(14) DEFAULT NULL,
   `lockedby` varchar(200) default '',
-  PRIMARY KEY (`fileId`, `user`)
+  PRIMARY KEY (`fileId`, `user`(191))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_forum_attachments`;
@@ -885,7 +884,7 @@
   `threadId` int(14) NOT NULL default '0',
   `forumId` int(14) default NULL,
   `timestamp` int(14) default NULL,
-  PRIMARY KEY (`user`,`threadId`)
+  PRIMARY KEY (`user`(191),`threadId`)
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_forums`;
@@ -1022,10 +1021,10 @@
   `showcategories` char(1) NOT NULL default 'n',
   PRIMARY KEY (`galleryId`),
   KEY `name` (name),
-  KEY `description` (description(255)),
+  KEY `description` (description(191)),
   KEY `hits` (hits),
   KEY `parentgallery` (parentgallery),
-  KEY `visibleUser` (visible, user)
+  KEY `visibleUser` (visible, user(191))
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `tiki_galleries_scales`;
@@ -1171,7 +1170,7 @@
 	created_at INT UNSIGNED NOT NULL,
 	PRIMARY KEY (id),
 	KEY created_at (created_at),
-	KEY path (path)
+	KEY path (path(191))
 ) ENGINE = MyISAM;
 
 # Keep track of results (contents >-< users)
@@ -1212,7 +1211,7 @@
   `type` varchar(50) default NULL,
   `is_html` TINYINT(1) NOT NULL DEFAULT 0,
   PRIMARY KEY (`pageName`,`version`),
-  KEY `user` (`user`),
+  KEY `user` (`user`(191)),
   KEY (`historyId`)
 ) ENGINE=MyISAM;
 
@@ -1220,7 +1219,7 @@
 CREATE TABLE `tiki_hotwords` (
   `word` varchar(255) NOT NULL default '',
   `url` varchar(255) NOT NULL default '',
-  PRIMARY KEY (`word`)
+  PRIMARY KEY (`word`(191))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_html_pages`;
@@ -1230,7 +1229,7 @@
   `refresh` int(10) default NULL,
   `type` char(1) default NULL,
   `created` int(14) default NULL,
-  PRIMARY KEY (`pageName`)
+  PRIMARY KEY (`pageName`(191))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_html_pages_dynamic_zones`;
@@ -1255,12 +1254,12 @@
   `hits` int(14) default NULL,
   `path` varchar(255) default NULL,
   PRIMARY KEY (`imageId`),
-  KEY `name` (name),
-  KEY `description` (description(255)),
+  KEY `name` (name(191)),
+  KEY `description` (description(191)),
   KEY `hits` (hits),
   KEY `ti_gId` (`galleryId`),
   KEY `ti_cr` (created),
-  KEY `ti_us` (user)
+  KEY `ti_us` (user(191))
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `tiki_images_data`;
@@ -1298,9 +1297,9 @@
   `data` longblob,
   `refresh` int(14) default NULL,
   PRIMARY KEY (`cacheId`),
-  KEY `url` (url)
+  KEY `url` (url(191))
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
-CREATE INDEX urlindex ON tiki_link_cache (url(250));
+CREATE INDEX urlindex ON tiki_link_cache (url(191));
 
 DROP TABLE IF EXISTS `tiki_links`;
 CREATE TABLE `tiki_links` (
@@ -1374,7 +1373,7 @@
   `votes` int(10) default NULL,
   `points` int(10) default NULL,
   `status_since` int(14) default NULL,
-  PRIMARY KEY (`user`)
+  PRIMARY KEY (`user`(191))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_live_support_requests`;
@@ -1745,7 +1744,7 @@
   `subscribed` int(14) default NULL,
   `isUser` char(1) NOT NULL default 'n',
   `included` char(1) NOT NULL default 'n',
-  PRIMARY KEY (`nlId`,`email`,`isUser`)
+  PRIMARY KEY (`nlId`,`email`(191),`isUser`)
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_newsletter_groups`;
@@ -1754,7 +1753,7 @@
   `groupName` varchar(255) NOT NULL default '',
   `code` varchar(32) default NULL,
   `include_groups` char(1) DEFAULT 'y',
-  PRIMARY KEY (`nlId`,`groupName`)
+  PRIMARY KEY (`nlId`,`groupName`(191))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_newsletter_included`;
@@ -1839,7 +1838,7 @@
   PRIMARY KEY (`page_id`),
   UNIQUE KEY `pageName` (`pageName`),
   UNIQUE KEY `pageSlug` (`pageSlug`),
-  KEY `data` (`data`(255)),
+  KEY `data` (`data`(191)),
   KEY `pageRank` (`pageRank`),
   KEY `lastModif`(`lastModif`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1;
@@ -1879,13 +1878,13 @@
   `voteConsiderationSpan` int(4) default 0,
   PRIMARY KEY (`pollId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
-ALTER TABLE tiki_polls ADD INDEX tiki_poll_lookup ( active , title );
+ALTER TABLE tiki_polls ADD INDEX tiki_poll_lookup ( active , title(191) );
 
 DROP TABLE IF EXISTS `tiki_preferences`;
 CREATE TABLE `tiki_preferences` (
   `name` varchar(255) NOT NULL default '',
   `value` text,
-  PRIMARY KEY (`name`)
+  PRIMARY KEY (`name`(191))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_private_messages`;
@@ -2048,7 +2047,7 @@
   `page_alias` varchar(250) default '',
   `pos` int(4) default NULL,
   PRIMARY KEY (`receivedPageId`),
-  KEY `structureName` (`structureName`)
+  KEY `structureName` (`structureName`(191))
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `tiki_referer_stats`;
@@ -2057,7 +2056,7 @@
   `hits` int(10) default NULL,
   `last` int(14) default NULL,
   `lasturl` text default NULL,
-  PRIMARY KEY (`referer`)
+  PRIMARY KEY (`referer`(191))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_related_categories`;
@@ -2107,8 +2106,8 @@
   `filename` varchar(250) NOT NULL,
   `tiki_version` varchar(60) NOT NULL,
   `severity` int(4) NOT NULL default '0',
-  PRIMARY KEY (`filename`,`tiki_version`),
-  KEY `sdb_fn` (filename)
+  PRIMARY KEY (`filename`(191),`tiki_version`),
+  KEY `sdb_fn` (filename(191))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_semaphores`;
@@ -2118,7 +2117,7 @@
   `user` varchar(200) NOT NULL default '',
   `timestamp` int(14) default NULL,
   `value` VARCHAR(255) NULL,
-  PRIMARY KEY (`semName`)
+  PRIMARY KEY (`semName`(191))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_sent_newsletters`;
@@ -2151,7 +2150,7 @@
   `timestamp` int(14) default NULL,
   `tikihost` varchar(200) default NULL,
   PRIMARY KEY (`sessionId`),
-  KEY `user` (user),
+  KEY `user` (user(191)),
   KEY `timestamp` (`timestamp`)
 ) ENGINE=MyISAM;
 
@@ -2361,7 +2360,7 @@
 CREATE TABLE `tiki_theme_control_sections` (
   `section` varchar(250) NOT NULL default '',
   `theme` varchar(250) NOT NULL default '',
-  PRIMARY KEY (`section`)
+  PRIMARY KEY (`section`(191))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_topics`;
@@ -2433,7 +2432,7 @@
   `value` text,
   PRIMARY KEY (`itemId`,`fieldId`),
   INDEX `fieldId` (`fieldId`),
-  INDEX value (value(250))
+  INDEX value (value(191))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_tracker_item_field_logs`;
@@ -2519,7 +2518,7 @@
   `ord` int(4) NOT NULL default 0,
   `type` char(1) default NULL,
   `user` varchar(200) NOT NULL default '',
-  PRIMARY KEY (`name`(30),`user`,`position`, `ord`),
+  PRIMARY KEY (`name`(30),`user`(191),`position`, `ord`),
   KEY `id` (moduleId)
 ) ENGINE=MyISAM;
 
@@ -2529,7 +2528,7 @@
   `parentId` int(12) default NULL,
   `user` varchar(200) NOT NULL default '',
   `name` varchar(30) default NULL,
-  PRIMARY KEY (`user`,`folderId`)
+  PRIMARY KEY (`user`(191),`folderId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `tiki_user_bookmarks_urls`;
@@ -2594,7 +2593,7 @@
   `data` longblob,
   `parse` char(1) default NULL,
   `status` VARCHAR(60) default '',
-  PRIMARY KEY (`name`)
+  PRIMARY KEY (`name`(191))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_user_notes`;
@@ -2617,7 +2616,7 @@
   `last` int(14) default NULL,
   `first` int(14) default NULL,
   `level` int(8) default NULL,
-  PRIMARY KEY (`user`)
+  PRIMARY KEY (`user`(191))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_user_preferences`;
@@ -2625,7 +2624,7 @@
   `user` varchar(200) NOT NULL default '',
   `prefName` varchar(40) NOT NULL default '',
   `value` TEXT,
-  PRIMARY KEY (`user`,`prefName`)
+  PRIMARY KEY (`user`(191),`prefName`)
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_user_quizzes`;
@@ -2645,7 +2644,7 @@
 CREATE TABLE `tiki_user_taken_quizzes` (
   `user` varchar(200) NOT NULL default '',
   `quizId` varchar(255) NOT NULL default '',
-  PRIMARY KEY (`user`,`quizId`(50))
+  PRIMARY KEY (`user`(191),`quizId`(50))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_user_tasks_history`;
@@ -2682,7 +2681,7 @@
   `completed` int(14) default NULL,
   `percentage` int(4) default NULL,
   PRIMARY KEY (`taskId`),
-  UNIQUE(creator, created)
+  UNIQUE(creator(191), created)
 ) ENGINE=MyISAM AUTO_INCREMENT=1;
 
 DROP TABLE IF EXISTS `tiki_user_votings`;
@@ -2694,7 +2693,7 @@
   `time` int(14) NOT NULL default 0,
   KEY (`user`(100),id(100)),
   KEY `ip` (`ip`),
-  KEY `id` (`id`)
+  KEY `id` (`id`(191))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_user_watches`;
@@ -2749,7 +2748,7 @@
 CREATE TABLE `tiki_webmail_contacts_groups` (
   `contactId` int(12) NOT NULL,
   `groupName` varchar(255) NOT NULL,
-  PRIMARY KEY (`contactId`,`groupName`(200))
+  PRIMARY KEY (`contactId`,`groupName`(191))
 ) ENGINE=MyISAM ;
 
 DROP TABLE IF EXISTS `tiki_webmail_messages`;
@@ -2761,7 +2760,7 @@
   `isReplied` char(1) default NULL,
   `isFlagged` char(1) default NULL,
   `flaggedMsg` varchar(50) default '',
-  PRIMARY KEY (`accountId`,`mailId`)
+  PRIMARY KEY (`accountId`,`mailId`(191))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_wiki_attachments`;
@@ -2778,7 +2777,7 @@
   `created` int(14) default NULL,
   `comment` varchar(250) default NULL,
   PRIMARY KEY (`attId`),
-  KEY `page` (page)
+  KEY `page` (page(191))
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `tiki_zones`;
@@ -2796,7 +2795,7 @@
   `date` int(14) NOT NULL default '0',
   `IP` varchar(50) NOT NULL default '',
   PRIMARY KEY (`id`),
-  KEY `object` (object,`userId`,type),
+  KEY `object` (object(191),`userId`,type),
   KEY `userId` (`userId`),
   KEY `type` (type),
   KEY `date` (date)
@@ -2836,7 +2835,7 @@
   `anniversary` char(4) default '',
   `prorateInterval` varchar(255) default '',
   PRIMARY KEY (`id`),
-  UNIQUE KEY `groupName` (`groupName`),
+  UNIQUE KEY `groupName` (`groupName` (191)),
   KEY `expireAfter` (`expireAfter`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1;
 
@@ -2862,7 +2861,7 @@
   `groupName` varchar(255) NOT NULL default '',
   `created` int(14) default NULL,
   `expire` int(14) default NULL,
-  PRIMARY KEY (`userId`,`groupName`(225))
+  PRIMARY KEY (`userId`,`groupName`(191))
 ) ENGINE=MyISAM;
 
 INSERT INTO users_groups (`groupName`,`groupDesc`) VALUES ('Anonymous','Public users not logged');
@@ -2894,9 +2893,9 @@
   `openid_url` varchar(255) default NULL,
   `waiting` char(1) default NULL,
   PRIMARY KEY (`userId`),
-  UNIQUE KEY `login` (login),
+  UNIQUE KEY `login` (login (191)),
   KEY `registrationDate` (`registrationDate`),
-  KEY `openid_url` (openid_url)
+  KEY `openid_url` (openid_url(191))
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 -- Administrator account
@@ -2948,7 +2947,7 @@
   `type` varchar(50) NOT NULL,
   `objId` varchar(255) NOT NULL,
   `lang` varchar(16) default NULL,
-  PRIMARY KEY (`type`, `objId`),
+  PRIMARY KEY (`type`, `objId`(191)),
   KEY `traId` ( `traId` )
 ) ENGINE=MyISAM AUTO_INCREMENT=1;
 
@@ -2957,7 +2956,7 @@
   event varchar(255) NOT NULL default '',
   data text,
   reversalEvent varchar(255),
-  PRIMARY KEY (`event`)
+  PRIMARY KEY (`event`(191))
 ) ENGINE=MyISAM;
 
 INSERT INTO `tiki_score` VALUES
@@ -3050,7 +3049,7 @@
   `type` varchar(20) NOT NULL default '',
   `day` int(14) NOT NULL default '0',
   `hits` int(14) NOT NULL default '0',
-  PRIMARY KEY (`object`(200),`type`,`day`)
+  PRIMARY KEY (`object`(191),`type`,`day`)
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_registration_fields`;
@@ -3151,9 +3150,9 @@
   `objectId` int(11) NOT NULL default 0,
   `user` varchar(200) default '',
   `created` int(14) NOT NULL default '0',
-  PRIMARY KEY (`tagId`,`user`,`objectId`),
+  PRIMARY KEY (`tagId`,`user`(191),`objectId`),
   KEY (`tagId`),
-  KEY (user),
+  KEY (user(191)),
   KEY (`objectId`)
 ) ENGINE=MyISAM;
 
@@ -3190,7 +3189,7 @@
   `fieldId` int(10) unsigned NOT NULL auto_increment,
   `flagsPublic` CHAR( 1 ) NOT NULL DEFAULT 'n',
   PRIMARY KEY ( `fieldId` ),
-  INDEX ( `user` )
+  INDEX ( `user` (191))
 ) ENGINE = MyISAM ;
 
 DROP TABLE IF EXISTS `tiki_pages_translation_bits`;
@@ -3307,7 +3306,7 @@
   `objectType` varchar( 20 ) NOT NULL default '',
   `objectId` varchar(10) NOT NULL default '',
   `displayEachuser` char( 1 ) default NULL ,
-  PRIMARY KEY (`groupName`, `objectType`, `objectId` )
+  PRIMARY KEY (`groupName`(191), `objectType`, `objectId` )
 ) ENGINE=MyISAM ;
 
 DROP TABLE IF EXISTS `tiki_sent_newsletters_files`;
@@ -3428,7 +3427,7 @@
 
 DROP TABLE IF EXISTS `tiki_plugin_security`;
 CREATE TABLE `tiki_plugin_security` (
-  `fingerprint` VARCHAR(200) NOT NULL PRIMARY KEY,
+  `fingerprint` VARCHAR(200) NOT NULL,
   `status` VARCHAR(10) NOT NULL,
   `added_by` VARCHAR(200) NULL,
   `approval_by` VARCHAR(200) NULL,
@@ -3435,7 +3434,8 @@
   `last_update` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
   `last_objectType` VARCHAR(20) NOT NULL,
   `last_objectId` VARCHAR(200) NOT NULL,
-  KEY `last_object` (last_objectType, last_objectId)
+  PRIMARY KEY (`fingerprint`(191)),
+  KEY `last_object` (last_objectType, last_objectId(191))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_user_reports`;
@@ -3485,7 +3485,7 @@
     `to` varchar(255) NOT NULL,
     `guards` text,
     PRIMARY KEY(`transitionId`),
-    KEY `transition_lookup` (`type`, `from`)
+    KEY `transition_lookup` (`type`, `from`(191))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_auth_tokens`;
@@ -3552,7 +3552,7 @@
     `max` INT,
     `comment` TEXT,
     PRIMARY KEY(`id`),
-    KEY `code` (`code`)
+    KEY `code` (`code`(191))
 ) ENGINE=MyISAM;
 DROP TABLE IF EXISTS `tiki_translations_in_progress`;
 CREATE TABLE `tiki_translations_in_progress` (
@@ -3576,7 +3576,7 @@
     `content` TEXT,
     `categories` TEXT,
     KEY `tiki_rss_items_rss` (`rssId`),
-    KEY `tiki_rss_items_item` (`rssId`, `guid`(200))
+    KEY `tiki_rss_items_item` (`rssId`, `guid`(191))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_object_attributes`;
@@ -3588,7 +3588,7 @@
     `value` varchar(255),
 	`comment` varchar(255),
     UNIQUE `item_attribute_uq` ( `type`, `itemId`, `attribute` ),
-    KEY `attribute_lookup_ix` (`attribute`, `value`)
+    KEY `attribute_lookup_ix` (`attribute`, `value`(191))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_rating_configs`;
@@ -3633,7 +3633,7 @@
     `from` VARCHAR(255) default NULL,
     `to` VARCHAR(255) default NULL,
     PRIMARY KEY (`todoId`),
-    KEY `what` (`objectType`, `objectId`),
+    KEY `what` (`objectType`, `objectId`(191)),
     KEY `after` (`after`)
 ) ENGINE=MyISAM;
 DROP TABLE IF EXISTS `tiki_todo_notif`;
@@ -3642,7 +3642,7 @@
     `objectType` VARCHAR(50),
     `objectId` VARCHAR(255) default NULL,
     KEY `todoId` (`todoId`),
-    KEY `objectId` (`objectId`)
+    KEY `objectId` (`objectId`(191))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_url_shortener`;
@@ -3682,7 +3682,7 @@
   `used_on_user` varchar(200) default NULL,
   PRIMARY KEY  (`id`),
   KEY `id_invite` (`id_invite`),
-  KEY `used_on_user` (`used_on_user`)
+  KEY `used_on_user` (`used_on_user`(191))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_credits`;
@@ -3884,7 +3884,7 @@
     `path` VARCHAR(200) NOT NULL,
     `method` VARCHAR(20) NOT NULL,
     `arguments` TEXT NOT NULL,
-    KEY `tiki_source_auth_ix` (`scheme`, `domain`)
+    KEY `tiki_source_auth_ix` (`scheme`, `domain`(191))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_connect`;
@@ -3929,8 +3929,8 @@
   KEY `PageId` (`page_id`)
 ) ENGINE=MyISAM;
 ALTER TABLE tiki_page_references ADD UNIQUE INDEX uk1_tiki_page_ref_biblio_code (page_id, biblio_code);
-ALTER TABLE tiki_page_references ADD INDEX idx_tiki_page_ref_title (title);
-ALTER TABLE tiki_page_references ADD INDEX idx_tiki_page_ref_author (author);
+ALTER TABLE tiki_page_references ADD INDEX idx_tiki_page_ref_title (title(191));
+ALTER TABLE tiki_page_references ADD INDEX idx_tiki_page_ref_author (author(191));
 
 DROP TABLE IF EXISTS `tiki_db_status`;
 CREATE TABLE `tiki_db_status` (

------------------------------------------------------------------------
r67393 | jonnybradley | 2018-09-09 12:27:36 -0400 (dom, 09 set 2018) | 1 line

[UX] Make the menu 42 module title "System Menu" (and fix a comment syntax)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 67392)
+++ tiki.sql	(revision 67393)
@@ -4,7 +4,7 @@
 -- --------------------------------------------------------
 
 ALTER DATABASE DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci;
-SET FOREIGN_KEY_CHECKS = 0;   # tiki doesn't officially use foreign keys but sometimes they "appear", leading to table dropping errors
+SET FOREIGN_KEY_CHECKS = 0;  /* tiki doesn't officially use foreign keys but sometimes they "appear", leading to table dropping errors */
 
 DROP TABLE IF EXISTS `messu_messages`;
 CREATE TABLE `messu_messages` (
@@ -1730,7 +1730,7 @@
 ) ENGINE=MyISAM;
 
 INSERT INTO `tiki_modules` (name,position,ord,cache_time,params,groups) VALUES
-    ('menu','left',1,7200,'id=42&flip=y','a:1:{i:0;s:10:"Registered";}'),
+    ('menu','left',1,7200,'id=42&title=System+Menu','a:1:{i:0;s:10:"Registered";}'),
     ('logo','top',1,7200,'nobox=y','a:0:{}'),
     ('login_box','top',2,0,'mode=popup&nobox=y','a:0:{}'),
     ('rsslist','bottom',1,7200,'nobox=y','a:0:{}'),

------------------------------------------------------------------------
r67387 | jonnybradley | 2018-09-08 21:14:32 -0400 (sÃ¡b, 08 set 2018) | 1 line

[UX] Remove Quick Admin module on default installs as it is confusing for new users

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 67386)
+++ tiki.sql	(revision 67387)
@@ -1,4 +1,5 @@
 -- --------------------------------------------------------
+-- --------------------------------------------------------
 -- Database : Tiki
 -- --------------------------------------------------------
 
@@ -1732,7 +1733,6 @@
     ('menu','left',1,7200,'id=42&flip=y','a:1:{i:0;s:10:"Registered";}'),
     ('logo','top',1,7200,'nobox=y','a:0:{}'),
     ('login_box','top',2,0,'mode=popup&nobox=y','a:0:{}'),
-    ('quickadmin','top',3,7200,'nobox=y','a:1:{i:0;s:6:"Admins";}'),
     ('rsslist','bottom',1,7200,'nobox=y','a:0:{}'),
     ('poweredby','bottom',2,7200,'nobox=y&icons=n&version=n','a:0:{}');
 

------------------------------------------------------------------------
r67124 | kroky6 | 2018-08-06 11:07:52 -0400 (seg, 06 ago 2018) | 1 line

[FIX] missing tiki.sql update

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 67123)
+++ tiki.sql	(revision 67124)
@@ -2117,6 +2117,7 @@
   `objectType` varchar(20) default 'wiki page',
   `user` varchar(200) NOT NULL default '',
   `timestamp` int(14) default NULL,
+  `value` VARCHAR(255) NULL,
   PRIMARY KEY (`semName`)
 ) ENGINE=MyISAM;
 

------------------------------------------------------------------------
r66934 | xorti | 2018-07-09 20:21:17 -0400 (seg, 09 jul 2018) | 4 lines

[REM] Remove feature reports and wikiplugin_report

- https://tiki.org/forumthread67333


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 66933)
+++ tiki.sql	(revision 66934)
@@ -1663,7 +1663,6 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'r', 'Invoice', 'tiki-list_invoices.php', 790, 'feature_invoice', 'tiki_p_admin', '', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'o', 'New Invoice', 'tiki-edit_invoice.php', 791, 'feature_invoice', 'tiki_p_admin', '', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'o', 'TimeSheet', 'tiki-timesheet.php', 39, 'feature_time_sheet', '', '', 0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o',  'Reports','tiki-edit_report.php',38,'feature_reports','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Scheduler','tiki-admin_schedulers.php',1270,'','tiki_p_admin','', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Webservices','tiki-admin_webservices.php',1280,'feature_webservices','tiki_p_admin_webservices','', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','References','tiki-references.php',255,'feature_wiki,feature_references','tiki_p_edit_references','', 0);

------------------------------------------------------------------------
r66920 | rjsmelo | 2018-07-08 19:14:30 -0400 (dom, 08 jul 2018) | 2 lines

[ENH] Improve Rollback capabilities for profile apply


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 66919)
+++ tiki.sql	(revision 66920)
@@ -88,7 +88,7 @@
   `comment` text default NULL,
   `categId` int(12) NOT NULL default '0',
   `client` VARCHAR( 200 ) NULL DEFAULT NULL,
-  `log` TEXT NULL DEFAULT NULL,
+  `log` LONGTEXT NULL DEFAULT NULL,
   PRIMARY KEY (`actionId`),
   KEY `lastModif` (`lastModif`),
   KEY `object` (`object`(100), `objectType`, `action`(100))

------------------------------------------------------------------------
r66808 | jonnybradley | 2018-06-25 11:54:32 -0400 (seg, 25 jun 2018) | 2 lines

[FIX] reports: Fix invalid dates in reports for last_report datetime for recent mysql 5.7+ and mariadb or where NO_ZERO_IN_DATE NO_ZERO_DATE are enabled (was breaking tests for me)
Lightly tested with real data, seems ok...

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 66807)
+++ tiki.sql	(revision 66808)
@@ -3446,7 +3446,7 @@
   `view` varchar(8) NOT NULL,
   `type` varchar(5) NOT NULL,
   `always_email` tinyint(1) NOT NULL,
-  `last_report` datetime NOT NULL,
+  `last_report` datetime DEFAULT NULL,
   PRIMARY KEY (`id`)
 ) ENGINE=MyISAM;
 
@@ -3456,7 +3456,7 @@
   `user` varchar(200) NOT NULL,
   `event` varchar(200) NOT NULL,
   `data` text NOT NULL,
-  `time` datetime NOT NULL,
+  `time` datetime DEFAULT NULL,
   PRIMARY KEY (`id`)
 ) ENGINE=MyISAM;
 

------------------------------------------------------------------------
r66257 | jyhem | 2018-05-03 18:17:23 -0400 (qui, 03 mai 2018) | 1 line

[FIX] When newsletters are throttled, ensure all batches look the same as the first batch.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 66256)
+++ tiki.sql	(revision 66257)
@@ -2131,6 +2131,7 @@
   `data` longblob,
   `datatxt` longblob,
   `wysiwyg` char(1) default NULL,
+  `is_html` varchar(2) default NULL,
   PRIMARY KEY (`editionId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 

------------------------------------------------------------------------
r66144 | xorti | 2018-04-22 18:48:53 -0400 (dom, 22 abr 2018) | 9 lines

[NEW] Add schedulers heal feature

- Cron now is able to heal scheduler if is running for long time and is stalled.
- Allow admins to set the running timeout, before heal.
- Allow admins to receive notifications when a scheduler is healed.
- Allow admins to reset/heal scheduler if stalled, from the scheduler administration.
- Allow admins to set how many logs to keep for each scheduler.
- Logs are now paginated.


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 66143)
+++ tiki.sql	(revision 66144)
@@ -4068,7 +4068,8 @@
   `end_time` INT(14),
   `status` VARCHAR(10),
   `output` TEXT,
-  `stalled` TINYINT DEFAULT 0
+  `stalled` TINYINT DEFAULT 0,
+  `healed` TINYINT DEFAULT 0
 ) ENGINE=MyISAM;
 
 SET FOREIGN_KEY_CHECKS = 1;

------------------------------------------------------------------------
r66143 | xorti | 2018-04-22 11:24:32 -0400 (dom, 22 abr 2018) | 7 lines

[NEW] Add schedulers stalled alerts

- Cron now sets a scheduler as stalled if running for a long period.
- Allow admins to set the running timeout, setting it as stalled.
- Allow admins to receive notifications when a scheduler is marked as stalled.
- Allow admins to reset scheduler if stalled, from the scheduler administration.


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 66142)
+++ tiki.sql	(revision 66143)
@@ -4067,7 +4067,8 @@
   `start_time` INT(14),
   `end_time` INT(14),
   `status` VARCHAR(10),
-  `output` TEXT
+  `output` TEXT,
+  `stalled` TINYINT DEFAULT 0
 ) ENGINE=MyISAM;
 
 SET FOREIGN_KEY_CHECKS = 1;

------------------------------------------------------------------------
r66009 | xorti | 2018-04-14 14:24:52 -0400 (sÃ¡b, 14 abr 2018) | 11 lines

[ENH] Custom Routes - Short URL improvements

- Fix route.php to load necessary sef_url preferences to redirect to page in SEF url if enabled.
- Improve UI on the list custom routes, add column to show if is shorturl.
- Move shorturl prefererences to sefurl prefs page.
- Include the option to get a short url for forum threads.
- Add title in modal when remove a custom route.
- Rename Custom Route option 'Delete' to 'Remove'.
- Add missing menu entry to include 'Custom Route' in the side menu.
- Add script to fix Custom Route menu entries that was missing.
- Add script to update renamed preferences.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 66008)
+++ tiki.sql	(revision 66009)
@@ -1667,6 +1667,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Scheduler','tiki-admin_schedulers.php',1270,'','tiki_p_admin','', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Webservices','tiki-admin_webservices.php',1280,'feature_webservices','tiki_p_admin_webservices','', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','References','tiki-references.php',255,'feature_wiki,feature_references','tiki_p_edit_references','', 0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'o', 'Custom Routes', 'tiki-admin_routes.php', 1290, 'feature_sefurl_routes', 'tiki_p_admin', '', 0);
 
 DROP TABLE IF EXISTS `tiki_menus`;
 CREATE TABLE `tiki_menus` (

------------------------------------------------------------------------
r65987 | rjsmelo | 2018-04-11 17:05:59 -0400 (qua, 11 abr 2018) | 2 lines

[FIX] Scheduler field is small for complex scheduler definitions


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 65986)
+++ tiki.sql	(revision 65987)
@@ -4053,7 +4053,7 @@
   `name` VARCHAR(255),
   `description` VARCHAR(255),
   `task`VARCHAR(255),
-  `params` VARCHAR(255),
+  `params` TEXT,
   `run_time` VARCHAR(255),
   `status` VARCHAR(10),
   `re_run` TINYINT

------------------------------------------------------------------------
r65935 | rjsmelo | 2018-04-05 20:59:17 -0400 (qui, 05 abr 2018) | 2 lines

[FIX] Fix issue when custum routes have / in the route, remove unused field in custom routes.


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 65934)
+++ tiki.sql	(revision 65935)
@@ -635,7 +635,6 @@
   `from` varchar(255) NOT NULL,
   `redirect` text NOT NULL,
   `active` tinyint(1) NOT NULL DEFAULT '1',
-  `user_id` int(11) NOT NULL,
   `short_url` tinyint(1) DEFAULT '0'
 ) ENGINE=MyISAM;
 

------------------------------------------------------------------------
r65849 | xorti | 2018-03-31 09:16:52 -0400 (sÃ¡b, 31 mar 2018) | 1 line

[FIX] Add short_url column to tiki_custom_route table schema

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 65848)
+++ tiki.sql	(revision 65849)
@@ -635,7 +635,8 @@
   `from` varchar(255) NOT NULL,
   `redirect` text NOT NULL,
   `active` tinyint(1) NOT NULL DEFAULT '1',
-  `user_id` int(11) NOT NULL
+  `user_id` int(11) NOT NULL,
+  `short_url` tinyint(1) DEFAULT '0'
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_directory_categories`;

------------------------------------------------------------------------
r65651 | Luis Fagundes | 2018-03-05 10:56:44 -0400 (seg, 05 mar 2018) | 1 line

[ENH] Better flagged revision workflow: rejection interface with commeent, consistent history page

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 65650)
+++ tiki.sql	(revision 65651)
@@ -3584,6 +3584,7 @@
     `itemId` varchar(160) NOT NULL,
     `attribute` varchar(70) NOT NULL,
     `value` varchar(255),
+	`comment` varchar(255),
     UNIQUE `item_attribute_uq` ( `type`, `itemId`, `attribute` ),
     KEY `attribute_lookup_ix` (`attribute`, `value`)
 ) ENGINE=MyISAM;

------------------------------------------------------------------------
r65549 | jonnybradley | 2018-02-20 12:02:36 -0400 (ter, 20 fev 2018) | 6 lines

[MRG] Automatic merge, branches/18.x 65531 to 65548
Conflicts fixed
	lib/wiki/editlib.php (manually)
	lang/fr/language.php (mc)

Excluding lib/core/WikiPlugin/Reference.php and templates/plugin/quick_add_references.tpl for now due to errors

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 65548)
+++ tiki.sql	(revision 65549)
@@ -1666,6 +1666,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o',  'Reports','tiki-edit_report.php',38,'feature_reports','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Scheduler','tiki-admin_schedulers.php',1270,'','tiki_p_admin','', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Webservices','tiki-admin_webservices.php',1280,'feature_webservices','tiki_p_admin_webservices','', 0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','References','tiki-references.php',255,'feature_wiki,feature_references','tiki_p_edit_references','', 0);
 
 DROP TABLE IF EXISTS `tiki_menus`;
 CREATE TABLE `tiki_menus` (

------------------------------------------------------------------------
r65467 | jonnybradley | 2018-02-07 07:17:31 -0400 (qua, 07 fev 2018) | 1 line

[MRG] Automatic merge, branches/18.x 65464 to 65466

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 65466)
+++ tiki.sql	(revision 65467)
@@ -3,6 +3,7 @@
 -- --------------------------------------------------------
 
 ALTER DATABASE DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci;
+SET FOREIGN_KEY_CHECKS = 0;   # tiki doesn't officially use foreign keys but sometimes they "appear", leading to table dropping errors
 
 DROP TABLE IF EXISTS `messu_messages`;
 CREATE TABLE `messu_messages` (
@@ -4065,3 +4066,5 @@
   `status` VARCHAR(10),
   `output` TEXT
 ) ENGINE=MyISAM;
+
+SET FOREIGN_KEY_CHECKS = 1;

------------------------------------------------------------------------
r64867 | jonnybradley | 2017-12-11 11:46:38 -0400 (seg, 11 dez 2017) | 1 line

[MRG] Automatic merge, branches/18.x 64845 to 64866

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 64866)
+++ tiki.sql	(revision 64867)
@@ -2105,7 +2105,7 @@
   `filename` varchar(250) NOT NULL,
   `tiki_version` varchar(60) NOT NULL,
   `severity` int(4) NOT NULL default '0',
-  PRIMARY KEY (`md5_value`,`filename`(100),`tiki_version`),
+  PRIMARY KEY (`filename`,`tiki_version`),
   KEY `sdb_fn` (filename)
 ) ENGINE=MyISAM;
 

------------------------------------------------------------------------
r64824 | jonnybradley | 2017-12-06 10:56:44 -0400 (qua, 06 dez 2017) | 1 line

[MRG] Automatic merge, branches/18.x 64817 to 64823

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 64823)
+++ tiki.sql	(revision 64824)
@@ -156,7 +156,6 @@
   `created` int(14) default NULL,
   `heading` text,
   `body` text,
-  `hash` varchar(32) default NULL,
   `author` varchar(200) default NULL,
   `nbreads` int(14) default NULL,
   `votes` int(8) default NULL,
@@ -627,6 +626,17 @@
   PRIMARY KEY (`copyrightId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
+DROP TABLE IF EXISTS `tiki_custom_route`;
+CREATE TABLE `tiki_custom_route` (
+  `id` int(11) NOT NULL PRIMARY KEY AUTO_INCREMENT,
+  `description` varchar(255) NULL,
+  `type` varchar(255) NOT NULL,
+  `from` varchar(255) NOT NULL,
+  `redirect` text NOT NULL,
+  `active` tinyint(1) NOT NULL DEFAULT '1',
+  `user_id` int(11) NOT NULL
+) ENGINE=MyISAM;
+
 DROP TABLE IF EXISTS `tiki_directory_categories`;
 CREATE TABLE `tiki_directory_categories` (
   `categId` int(10) NOT NULL auto_increment,
@@ -1105,6 +1115,7 @@
 	KEY runnable (runnable)
 )	ENGINE = MyISAM;
 
+DROP TABLE IF EXISTS `tiki_h5p_libraries_hub_cache`;
 CREATE TABLE tiki_h5p_libraries_hub_cache (
   id                INT UNSIGNED NOT NULL AUTO_INCREMENT,
   machine_name      VARCHAR(127) NOT NULL,
@@ -2251,7 +2262,6 @@
   `resume` text,
   `heading` text,
   `body` text,
-  `hash` varchar(32) default NULL,
   `author` varchar(200) default NULL,
   `nbreads` int(14) default NULL,
   `votes` int(8) default NULL,
@@ -3531,7 +3541,7 @@
     KEY `payment_request_ix` (`paymentRequestId`)
 ) ENGINE=MyISAM;
 DROP TABLE IF EXISTS `tiki_discount`;
-CREATE TABLE `tiki_discount`(
+CREATE TABLE `tiki_discount` (
     `id` INT NOT NULL AUTO_INCREMENT,
     `code` VARCHAR(255),
     `value` VARCHAR(255),
@@ -3771,6 +3781,7 @@
 
 DROP TABLE IF EXISTS `tiki_acct_item`;
 CREATE TABLE `tiki_acct_item` (
+  `itemId` int(11) NOT NULL AUTO_INCREMENT,
   `itemBookId` int(10) unsigned NOT NULL,
   `itemJournalId` int(10) unsigned NOT NULL DEFAULT '0',
   `itemAccountId` int(10) unsigned NOT NULL DEFAULT '0',
@@ -3778,7 +3789,7 @@
   `itemAmount` double NOT NULL DEFAULT '0',
   `itemText` varchar(255) NOT NULL DEFAULT '',
   `itemTs` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
-  PRIMARY KEY (`itemBookId`,`itemJournalId`,`itemAccountId`,`itemType`)
+  PRIMARY KEY (`itemId`)
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_acct_journal`;
@@ -3846,7 +3857,7 @@
     `entryId` INT PRIMARY KEY AUTO_INCREMENT,
     `queue` VARCHAR(25) NOT NULL,
     `timestamp` INT NOT NULL,
-    `handler` VARCHAR(20) NULL,
+    `handler` VARCHAR(64) NULL,
     `message` TEXT NOT NULL,
     KEY `queue_name_ix` (`queue`),
     KEY `queue_handler_ix` (`handler`)
@@ -4029,6 +4040,7 @@
 	`name` VARCHAR(30) NOT NULL,
 	`format_descriptor` TEXT,
 	`filter_descriptor` TEXT,
+	`config` TEXT,
 	KEY `tabular_tracker_ix` (`trackerId`)
 ) ENGINE=MyISAM;
 

------------------------------------------------------------------------
r64816 | jonnybradley | 2017-12-05 13:39:39 -0400 (ter, 05 dez 2017) | 1 line

[MRG] Automatic merge, branches/18.x 64812 to 64815

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 64815)
+++ tiki.sql	(revision 64816)
@@ -86,7 +86,8 @@
   `ip` varchar(39) default NULL,
   `comment` text default NULL,
   `categId` int(12) NOT NULL default '0',
-    `client` VARCHAR( 200 ) NULL DEFAULT NULL,
+  `client` VARCHAR( 200 ) NULL DEFAULT NULL,
+  `log` TEXT NULL DEFAULT NULL,
   PRIMARY KEY (`actionId`),
   KEY `lastModif` (`lastModif`),
   KEY `object` (`object`(100), `objectType`, `action`(100))

------------------------------------------------------------------------
r64679 | jonnybradley | 2017-11-22 16:18:42 -0400 (qua, 22 nov 2017) | 2 lines

[FIX] h5p: Fix more issues with updated H5P libraries - new tiki_h5p_libraries_hub_cache table, new pref h5p_hub_is_enabled etc.
Editor seems to work more completely now, still more to come...

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 64678)
+++ tiki.sql	(revision 64679)
@@ -1104,6 +1104,33 @@
 	KEY runnable (runnable)
 )	ENGINE = MyISAM;
 
+CREATE TABLE tiki_h5p_libraries_hub_cache (
+  id                INT UNSIGNED NOT NULL AUTO_INCREMENT,
+  machine_name      VARCHAR(127) NOT NULL,
+  major_version     INT UNSIGNED NOT NULL,
+  minor_version     INT UNSIGNED NOT NULL,
+  patch_version     INT UNSIGNED NOT NULL,
+  h5p_major_version INT UNSIGNED,
+  h5p_minor_version INT UNSIGNED,
+  title             VARCHAR(255) NOT NULL,
+  summary           TEXT         NOT NULL,
+  description       TEXT         NOT NULL,
+  icon              VARCHAR(511) NOT NULL,
+  created_at        INT UNSIGNED NOT NULL,
+  updated_at        INT UNSIGNED NOT NULL,
+  is_recommended    INT UNSIGNED NOT NULL,
+  popularity        INT UNSIGNED NOT NULL,
+  screenshots       TEXT,
+  license           TEXT,
+  example           VARCHAR(511) NOT NULL,
+  tutorial          VARCHAR(511),
+  keywords          TEXT,
+  categories        TEXT,
+  owner             VARCHAR(511),
+  PRIMARY KEY (id),
+  KEY name_version (machine_name, major_version, minor_version, patch_version)
+) ENGINE = MyISAM;
+
 # Keep track of h5p library dependencies
 DROP TABLE IF EXISTS `tiki_h5p_libraries_libraries`;
 CREATE TABLE tiki_h5p_libraries_libraries (

------------------------------------------------------------------------
r64028 | chealer | 2017-09-28 12:35:34 -0400 (qui, 28 set 2017) | 3 lines

Support distinguishing database translations which are specific to the Tiki instance from general translations which can be contributed to the Tiki community
This removes the LanguageTranslations::updateTrans() bypass for unchanged strings, which causes tiki_language.changed to be set to 1, but there seems to be no way tiki_language.changed could take a value other than 1 anyway.
[REF] Replace _getDbTranslationsEscaped() with PHPEscape(), to be used with _getDbTranslations()

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 64027)
+++ tiki.sql	(revision 64028)
@@ -1244,6 +1244,7 @@
   `lang` char(16) NOT NULL default '',
   `tran` text,
   `changed` bool,
+  `general` bool DEFAULT NULL COMMENT 'true if this translation is general and can be contributed to the Tiki community, false if it is specific to this instance',
   `userId` int(8),
   `lastModif` int(14) NULL,
   PRIMARY KEY (`id`)

------------------------------------------------------------------------
r63993 | yonixxx | 2017-09-24 03:24:48 -0400 (dom, 24 set 2017) | 1 line

[FIX] SEFURL route stats changed to statistics to avoid conflict with some hosting setup

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 63992)
+++ tiki.sql	(revision 63993)
@@ -3339,7 +3339,7 @@
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-my_tiki.php', 'my', '', '', 200);
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-newsletters.php', 'newsletters', 'newsletter', 'feature_newsletters', 200);
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-list_quizzes.php', 'quizzes', '', 'feature_quizzes', 200);
-INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-stats.php', 'stats', '', 'feature_stats', 200);
+INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-stats.php', 'statistics', '', 'feature_stats', 200);
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-list_surveys.php', 'surveys', '', 'feature_surveys', 200);
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-list_trackers.php', 'trackers', 'tracker', 'feature_trackers', 200);
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-sheets.php', 'sheets', '', 'feature_sheet', 200);

------------------------------------------------------------------------
r63892 | jonnybradley | 2017-09-20 13:41:13 -0400 (qua, 20 set 2017) | 1 line

[MRG] Automatic merge, branches/17.x 63886 to 63891

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 63891)
+++ tiki.sql	(revision 63892)
@@ -1562,6 +1562,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Settings','tiki-admin.php',1050,'','tiki_p_edit_menu','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Settings','tiki-admin.php',1050,'','tiki_p_clean_cache','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Settings','tiki-admin.php',1050,'','tiki_p_admin_modules','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Settings','tiki-admin.php',1050,'','tiki_p_admin_webservices','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o',' Control Panels','tiki-admin.php',1051,'','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Live Support','tiki-live_support_admin.php',1055,'feature_live_support','tiki_p_live_support_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Live Support','tiki-live_support_admin.php',1055,'feature_live_support','user_is_operator','',0);
@@ -1623,7 +1624,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'o', 'TimeSheet', 'tiki-timesheet.php', 39, 'feature_time_sheet', '', '', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o',  'Reports','tiki-edit_report.php',38,'feature_reports','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Scheduler','tiki-admin_schedulers.php',1270,'','tiki_p_admin','', 0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Webservices','tiki-admin_webservices.php',1280,'feature_webservices','tiki_p_admin','', 0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Webservices','tiki-admin_webservices.php',1280,'feature_webservices','tiki_p_admin_webservices','', 0);
 
 DROP TABLE IF EXISTS `tiki_menus`;
 CREATE TABLE `tiki_menus` (

------------------------------------------------------------------------
r62364 | luciash | 2017-04-27 12:55:48 -0400 (qui, 27 abr 2017) | 1 line

[MRG] Automatic merge, branches/17.x 62359 to 62363

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 62363)
+++ tiki.sql	(revision 62364)
@@ -3069,10 +3069,10 @@
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Viewed', 'article', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('%', 'system', 'y');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('feature', 'system', 'y');
-INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Updated', 'trackeritem', 'n');
-INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Created', 'trackeritem', 'n');
-INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Viewed', 'trackeritem', 'n');
-INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Removed', 'trackeritem', 'n');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Updated', 'trackeritem', 'y');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Created', 'trackeritem', 'y');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Viewed', 'trackeritem', 'y');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Removed', 'trackeritem', 'y');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Created', 'wiki page attachment', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Removed', 'wiki page attachment', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Categorized', 'wiki page', 'n');

------------------------------------------------------------------------
r62115 | kroky6 | 2017-04-06 09:17:31 -0400 (qui, 06 abr 2017) | 1 line

[MRG] Automatic merge, branches/17.x 62108 to 62112

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 62114)
+++ tiki.sql	(revision 62115)
@@ -2785,6 +2785,7 @@
   `userChoice` char(1) default NULL,
   `groupDefCat` int(12) default 0,
   `groupTheme` varchar(255) default '',
+  `groupColor` VARCHAR(20) NOT NULL DEFAULT '',
   `isExternal` char(1) default 'n',
   `expireAfter` int(14) default 0,
   `emailPattern`  varchar(255) default '',

------------------------------------------------------------------------
r62046 | drsassafras | 2017-04-03 00:56:55 -0400 (seg, 03 abr 2017) | 1 line

[REF] sql - removed redundant sql

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 62045)
+++ tiki.sql	(revision 62046)
@@ -3510,7 +3510,7 @@
     KEY `code` (`code`)
 ) ENGINE=MyISAM;
 DROP TABLE IF EXISTS `tiki_translations_in_progress`;
-CREATE TABLE IF NOT EXISTS `tiki_translations_in_progress` (
+CREATE TABLE `tiki_translations_in_progress` (
    `page_id` int(14) NOT NULL,
    `language` char(2) NOT NULL,
    KEY `page_id` (`page_id`),
@@ -3715,7 +3715,7 @@
   `amountType` int(10) unsigned NOT NULL,
   `fieldNameAmountSign` varchar(63) NOT NULL,
   `SignPositive` varchar(7) NOT NULL,
-  `SignNegative` varchar(7) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL,
+  `SignNegative` varchar(7) NOT NULL,
   PRIMARY KEY (`bankBookId`,`bankAccountId`)
 ) ENGINE=MyISAM;
 

------------------------------------------------------------------------
r62027 | jonnybradley | 2017-04-02 10:09:37 -0400 (dom, 02 abr 2017) | 2 lines

[FIX] sql: Change duplicate trackeritem tiki_actionlog_conf line from Viewed to Removed as that one seems to be missing.
Thanks bfitz on https://dev.tiki.org/item6298#threadId=5325 for this and the previous sql fix

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 62026)
+++ tiki.sql	(revision 62027)
@@ -3071,7 +3071,7 @@
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Updated', 'trackeritem', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Created', 'trackeritem', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Viewed', 'trackeritem', 'n');
-INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Viewed', 'trackeritem', 'n');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Removed', 'trackeritem', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Created', 'wiki page attachment', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Removed', 'wiki page attachment', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Categorized', 'wiki page', 'n');

------------------------------------------------------------------------
r62026 | jonnybradley | 2017-04-02 10:05:42 -0400 (dom, 02 abr 2017) | 1 line

[FIX] h5p: Missed DROP TABLE commands on newly added table definitions

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 62025)
+++ tiki.sql	(revision 62026)
@@ -1044,6 +1044,7 @@
 ) ENGINE=MyISAM;
 
 # Keep track of h5p content entities > Pending in Tiki: Add FileId
+DROP TABLE IF EXISTS `tiki_h5p_contents`;
 CREATE TABLE tiki_h5p_contents (
 	id           INT UNSIGNED NOT NULL AUTO_INCREMENT,
 	file_id			 INT UNSIGNED NOT NULL,	# reference to the file gallery object in tiki_files table
@@ -1068,6 +1069,7 @@
 )	ENGINE = MyISAM;
 
 # Keep track of content dependencies
+DROP TABLE IF EXISTS `tiki_h5p_contents_libraries`;
 CREATE TABLE tiki_h5p_contents_libraries (
 	content_id      INT UNSIGNED      NOT NULL,
 	library_id      INT UNSIGNED      NOT NULL,
@@ -1078,6 +1080,7 @@
 )	ENGINE = MyISAM;
 
 # Keep track of h5p libraries
+DROP TABLE IF EXISTS `tiki_h5p_libraries`;
 CREATE TABLE tiki_h5p_libraries (
 	id               INT UNSIGNED  NOT NULL AUTO_INCREMENT,
 	created_at       TIMESTAMP     NULL,
@@ -1102,6 +1105,7 @@
 )	ENGINE = MyISAM;
 
 # Keep track of h5p library dependencies
+DROP TABLE IF EXISTS `tiki_h5p_libraries_libraries`;
 CREATE TABLE tiki_h5p_libraries_libraries (
 	library_id          INT UNSIGNED NOT NULL,
 	required_library_id INT UNSIGNED NOT NULL,
@@ -1110,6 +1114,7 @@
 )	ENGINE = MyISAM;
 
 # Keep track of h5p library translations
+DROP TABLE IF EXISTS `tiki_h5p_libraries_languages`;
 CREATE TABLE tiki_h5p_libraries_languages (
 	library_id    INT UNSIGNED NOT NULL,
 	language_code VARCHAR(31)  NOT NULL,
@@ -1118,6 +1123,7 @@
 )	ENGINE = MyISAM;
 
 # Keep track of temporary files uploaded in editor before saving content
+DROP TABLE IF EXISTS `tiki_h5p_tmpfiles`;
 CREATE TABLE tiki_h5p_tmpfiles (
 	id         INT UNSIGNED NOT NULL AUTO_INCREMENT,
 	path       VARCHAR(255) NOT NULL,
@@ -1128,6 +1134,7 @@
 ) ENGINE = MyISAM;
 
 # Keep track of results (contents >-< users)
+DROP TABLE IF EXISTS `tiki_h5p_results`;
 CREATE TABLE tiki_h5p_results (
 	id         INT UNSIGNED NOT NULL AUTO_INCREMENT,
 	content_id INT UNSIGNED NOT NULL,
@@ -1142,6 +1149,7 @@
 )	ENGINE = MyISAM;
 
 # Cache table for h5p libraries so we can reuse the existing h5p code for caching
+DROP TABLE IF EXISTS `tiki_h5p_libraries_cachedassets`;
 CREATE TABLE tiki_h5p_libraries_cachedassets (
 	library_id INT UNSIGNED NOT NULL,
 	hash       VARCHAR(64)  NOT NULL,
@@ -3249,7 +3257,6 @@
 ) ENGINE=MyISAM ;
 
 DROP TABLE IF EXISTS `tiki_groupalert`;
-
 CREATE TABLE `tiki_groupalert` (
   `groupName` varchar(255) NOT NULL default '',
   `objectType` varchar( 20 ) NOT NULL default '',

------------------------------------------------------------------------
r61937 | jonnybradley | 2017-03-29 11:55:20 -0400 (qua, 29 mar 2017) | 4 lines

[NEW] h5p: Merge everything from branches/experimental/h5p
Including: New section for H5P prefs on admin/fgals/enhancements, new plugin {h5p}, new AJAX services etc
See https://dev.tiki.org/H5P and https://doc.tiki.org/H5P for more
(thanks marclaporte and all involved in bringing this to Tiki)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 61936)
+++ tiki.sql	(revision 61937)
@@ -1043,6 +1043,111 @@
   INDEX `event-object-group` ( `event` , `object` ( 100 ) , `group` ( 50 ) )
 ) ENGINE=MyISAM;
 
+# Keep track of h5p content entities > Pending in Tiki: Add FileId
+CREATE TABLE tiki_h5p_contents (
+	id           INT UNSIGNED NOT NULL AUTO_INCREMENT,
+	file_id			 INT UNSIGNED NOT NULL,	# reference to the file gallery object in tiki_files table
+	created_at   TIMESTAMP    NULL,
+	updated_at   TIMESTAMP    NULL,
+	user_id      INT UNSIGNED NOT NULL,
+	title        VARCHAR(255) NOT NULL,
+	library_id   INT UNSIGNED NOT NULL,
+	parameters   LONGTEXT     NOT NULL,
+	filtered     LONGTEXT     NOT NULL,
+	slug         VARCHAR(127) NOT NULL,
+	embed_type   VARCHAR(127) NOT NULL,
+	disable      INT UNSIGNED NOT NULL DEFAULT 0,
+	content_type VARCHAR(127) NULL,
+	author       VARCHAR(127) NULL,
+	license      VARCHAR(7)   NULL,
+	keywords     TEXT         NULL,
+	description  TEXT         NULL,
+	PRIMARY KEY (id),
+	UNIQUE KEY `fileId` (`file_id`)
+
+)	ENGINE = MyISAM;
+
+# Keep track of content dependencies
+CREATE TABLE tiki_h5p_contents_libraries (
+	content_id      INT UNSIGNED      NOT NULL,
+	library_id      INT UNSIGNED      NOT NULL,
+	dependency_type VARCHAR(31)       NOT NULL,
+	weight          SMALLINT UNSIGNED NOT NULL DEFAULT 0,
+	drop_css        TINYINT UNSIGNED  NOT NULL,
+	PRIMARY KEY (content_id, library_id, dependency_type)
+)	ENGINE = MyISAM;
+
+# Keep track of h5p libraries
+CREATE TABLE tiki_h5p_libraries (
+	id               INT UNSIGNED  NOT NULL AUTO_INCREMENT,
+	created_at       TIMESTAMP     NULL,
+	updated_at       TIMESTAMP     NULL,
+	name             VARCHAR(127)  NOT NULL,
+	title            VARCHAR(255)  NOT NULL,
+	major_version    INT UNSIGNED  NOT NULL,
+	minor_version    INT UNSIGNED  NOT NULL,
+	patch_version    INT UNSIGNED  NOT NULL,
+	runnable         INT UNSIGNED  NOT NULL,
+	restricted       INT UNSIGNED  NOT NULL DEFAULT 0,
+	fullscreen       INT UNSIGNED  NOT NULL,
+	embed_types      VARCHAR(255)  NOT NULL,
+	preloaded_js     TEXT          NULL,
+	preloaded_css    TEXT          NULL,
+	drop_library_css TEXT          NULL,
+	semantics        TEXT          NOT NULL,
+	tutorial_url     VARCHAR(1023) NOT NULL,
+	PRIMARY KEY (id),
+	KEY name_version (name, major_version, minor_version, patch_version),
+	KEY runnable (runnable)
+)	ENGINE = MyISAM;
+
+# Keep track of h5p library dependencies
+CREATE TABLE tiki_h5p_libraries_libraries (
+	library_id          INT UNSIGNED NOT NULL,
+	required_library_id INT UNSIGNED NOT NULL,
+	dependency_type     VARCHAR(31)  NOT NULL,
+	PRIMARY KEY (library_id, required_library_id)
+)	ENGINE = MyISAM;
+
+# Keep track of h5p library translations
+CREATE TABLE tiki_h5p_libraries_languages (
+	library_id    INT UNSIGNED NOT NULL,
+	language_code VARCHAR(31)  NOT NULL,
+	translation   TEXT         NOT NULL,
+	PRIMARY KEY (library_id, language_code)
+)	ENGINE = MyISAM;
+
+# Keep track of temporary files uploaded in editor before saving content
+CREATE TABLE tiki_h5p_tmpfiles (
+	id         INT UNSIGNED NOT NULL AUTO_INCREMENT,
+	path       VARCHAR(255) NOT NULL,
+	created_at INT UNSIGNED NOT NULL,
+	PRIMARY KEY (id),
+	KEY created_at (created_at),
+	KEY path (path)
+) ENGINE = MyISAM;
+
+# Keep track of results (contents >-< users)
+CREATE TABLE tiki_h5p_results (
+	id         INT UNSIGNED NOT NULL AUTO_INCREMENT,
+	content_id INT UNSIGNED NOT NULL,
+	user_id    INT UNSIGNED NOT NULL,
+	score      INT UNSIGNED NOT NULL,
+	max_score  INT UNSIGNED NOT NULL,
+	opened     INT UNSIGNED NOT NULL,
+	finished   INT UNSIGNED NOT NULL,
+	time       INT UNSIGNED NOT NULL,
+	PRIMARY KEY (id),
+	KEY content_user (content_id, user_id)
+)	ENGINE = MyISAM;
+
+# Cache table for h5p libraries so we can reuse the existing h5p code for caching
+CREATE TABLE tiki_h5p_libraries_cachedassets (
+	library_id INT UNSIGNED NOT NULL,
+	hash       VARCHAR(64)  NOT NULL,
+	PRIMARY KEY (library_id, hash)
+) ENGINE = MyISAM;
+
 DROP TABLE IF EXISTS `tiki_history`;
 CREATE TABLE `tiki_history` (
   `historyId` int(12) NOT NULL auto_increment,

------------------------------------------------------------------------
r61931 | chealer | 2017-03-29 11:23:33 -0400 (qua, 29 mar 2017) | 1 line

Increase maximum category description length from 250 characters to 500

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 61930)
+++ tiki.sql	(revision 61931)
@@ -462,7 +462,7 @@
 CREATE TABLE `tiki_categories` (
   `categId` int(12) NOT NULL auto_increment,
   `name` varchar(200) default NULL,
-  `description` varchar(250) default NULL,
+  `description` varchar(500) default NULL,
   `parentId` int(12) default NULL,
   `rootId` int NOT NULL DEFAULT 0,
   `hits` int(8) default NULL,

------------------------------------------------------------------------
r61917 | jonnybradley | 2017-03-28 13:31:43 -0400 (ter, 28 mar 2017) | 1 line

[FIX] mysql 5.7 can have trouble with indexes which allow null values, so change the default (hopefully fixes wish6298 without breaking anything else - unused table afaik, thanks bfitz)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 61916)
+++ tiki.sql	(revision 61917)
@@ -2358,8 +2358,8 @@
 CREATE TABLE `tiki_user_assigned_modules` (
   `moduleId` int(8) NOT NULL,
   `name` varchar(200) NOT NULL default '',
-  `position` varchar(20) default NULL,
-  `ord` int(4) default NULL,
+  `position` varchar(20) NOT NULL default '',
+  `ord` int(4) NOT NULL default 0,
   `type` char(1) default NULL,
   `user` varchar(200) NOT NULL default '',
   PRIMARY KEY (`name`(30),`user`,`position`, `ord`),

------------------------------------------------------------------------
r61502 | jonnybradley | 2017-03-05 11:19:01 -0400 (dom, 05 mar 2017) | 1 line

[ENH] webservices: Add admin menu item

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 61501)
+++ tiki.sql	(revision 61502)
@@ -1510,6 +1510,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'o', 'TimeSheet', 'tiki-timesheet.php', 39, 'feature_time_sheet', '', '', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o',  'Reports','tiki-edit_report.php',38,'feature_reports','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Scheduler','tiki-admin_schedulers.php',1270,'','tiki_p_admin','', 0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Webservices','tiki-admin_webservices.php',1280,'feature_webservices','tiki_p_admin','', 0);
 
 DROP TABLE IF EXISTS `tiki_menus`;
 CREATE TABLE `tiki_menus` (

------------------------------------------------------------------------
r61501 | jonnybradley | 2017-03-05 11:02:39 -0400 (dom, 05 mar 2017) | 1 line

[FIX] Menu 42 item missed from r61431

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 61500)
+++ tiki.sql	(revision 61501)
@@ -1509,6 +1509,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'o', 'New Invoice', 'tiki-edit_invoice.php', 791, 'feature_invoice', 'tiki_p_admin', '', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'o', 'TimeSheet', 'tiki-timesheet.php', 39, 'feature_time_sheet', '', '', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o',  'Reports','tiki-edit_report.php',38,'feature_reports','tiki_p_admin','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Scheduler','tiki-admin_schedulers.php',1270,'','tiki_p_admin','', 0);
 
 DROP TABLE IF EXISTS `tiki_menus`;
 CREATE TABLE `tiki_menus` (

------------------------------------------------------------------------
r61431 | rjsmelo | 2017-02-28 20:35:38 -0400 (ter, 28 fev 2017) | 5 lines

[NEW] Add support for schedule tasks (cron) to tiki
- New command avalable in the console to trigger the schedule: scheduler:run
- One task provided (ConsoleCommandTask) that allow to run other console commands
- Managed using tiki-admin_schedulers.php


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 61430)
+++ tiki.sql	(revision 61431)
@@ -3886,3 +3886,25 @@
 	`filter_descriptor` TEXT,
 	KEY `tabular_tracker_ix` (`trackerId`)
 ) ENGINE=MyISAM;
+
+DROP TABLE IF EXISTS `tiki_scheduler`;
+CREATE TABLE `tiki_scheduler` (
+  `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
+  `name` VARCHAR(255),
+  `description` VARCHAR(255),
+  `task`VARCHAR(255),
+  `params` VARCHAR(255),
+  `run_time` VARCHAR(255),
+  `status` VARCHAR(10),
+  `re_run` TINYINT
+) ENGINE=MyISAM;
+
+DROP TABLE IF EXISTS `tiki_scheduler_run`;
+CREATE TABLE `tiki_scheduler_run` (
+  `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
+  `scheduler_id` INT NOT NULL,
+  `start_time` INT(14),
+  `end_time` INT(14),
+  `status` VARCHAR(10),
+  `output` TEXT
+) ENGINE=MyISAM;

------------------------------------------------------------------------
r61130 | drsassafras | 2017-01-30 01:58:20 -0400 (seg, 30 jan 2017) | 1 line

[ENH][FIX] Moved wiki dumps to Tools page; separated file dumps and database dumps for clarity; added option to delete file dumps; fixed inability to create multiple database dumps; moved wiki dumps to storage directory (part 1)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 61129)
+++ tiki.sql	(revision 61130)
@@ -1349,7 +1349,6 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','Wiki','tiki-index.php',200,'feature_wiki','tiki_p_view','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Wiki Home','tiki-index.php',202,'feature_wiki','tiki_p_view','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Last Changes','tiki-lastchanges.php',205,'feature_wiki,feature_lastChanges','tiki_p_view','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Dump','dump/new.tar',210,'feature_wiki,feature_dump','tiki_p_view','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Rankings','tiki-wiki_rankings.php',215,'feature_wiki,feature_wiki_rankings','tiki_p_view','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Pages','tiki-listpages.php?cookietab=1#tab1',220,'feature_wiki,feature_listPages','tiki_p_view','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Create a Wiki Page','tiki-listpages.php?cookietab=2#tab2',222,'feature_wiki,feature_listPages','tiki_p_view,tiki_p_edit','',0);

------------------------------------------------------------------------
r60539 | montefuscolo | 2016-12-06 10:17:32 -0400 (ter, 06 dez 2016) | 1 line

[DB] increase lenght for comment field to 255

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 60538)
+++ tiki.sql	(revision 60539)
@@ -1053,7 +1053,7 @@
   `description` varchar(200) default NULL,
   `user` varchar(200) not null default '',
   `ip` varchar(39) default NULL,
-  `comment` varchar(200) default NULL,
+  `comment` varchar(255) default NULL,
   `data` longblob,
   `type` varchar(50) default NULL,
   `is_html` TINYINT(1) NOT NULL DEFAULT 0,
@@ -1657,7 +1657,7 @@
   `data` mediumtext,
   `description` varchar(200) default NULL,
   `lastModif` int(14) default NULL,
-  `comment` varchar(200) default NULL,
+  `comment` varchar(255) default NULL,
   `version` int(8) NOT NULL default '0',
   `version_minor` int(8) NOT NULL default '0',
   `user` varchar(200) default '',

------------------------------------------------------------------------
r60231 | jonnybradley | 2016-11-10 10:18:06 -0400 (qui, 10 nov 2016) | 1 line

[MRG] Automatic merge, branches/16.x 60200 to 60224

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 60230)
+++ tiki.sql	(revision 60231)
@@ -2715,7 +2715,6 @@
   `userId` int(8) NOT NULL auto_increment,
   `email` varchar(200) default NULL,
   `login` varchar(200) NOT NULL default '',
-  `password` varchar(30) default '',
   `provpass` varchar(30) default NULL,
   `default_group` varchar(255),
   `lastLogin` int(14) default NULL,

------------------------------------------------------------------------
r60175 | drsassafras | 2016-11-06 12:36:54 -0400 (dom, 06 nov 2016) | 1 line

[ENH] Update installer to new login code.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 60174)
+++ tiki.sql	(revision 60175)
@@ -2742,7 +2742,7 @@
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 -- Administrator account
-INSERT INTO users_users(email,login,password,hash,created,registrationDate) VALUES ('','admin','admin',md5('adminadmin'),UNIX_TIMESTAMP(),UNIX_TIMESTAMP());
+INSERT INTO users_users(email,login,hash,created,registrationDate) VALUES ('','admin','$2y$10$nzMJ64PLyjKqgKvqSvO/S.n8jtgAiRzmNMYPLq/TQVLfYIFa0xqkG',UNIX_TIMESTAMP(),UNIX_TIMESTAMP());
 INSERT INTO tiki_user_preferences (user,`prefName`,value) VALUES ('admin','realName','System Administrator');
 INSERT INTO users_usergroups (`userId`, `groupName`) VALUES(1,'Admins');
 INSERT INTO users_grouppermissions (`groupName`, `permName`) VALUES ('Admins','tiki_p_admin');

------------------------------------------------------------------------
r59707 | jonnybradley | 2016-09-15 06:57:02 -0400 (qui, 15 set 2016) | 1 line

[FIX] search: Increase the federated search maximum index name length to 255, the maximum supported by elasticsearch

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 59706)
+++ tiki.sql	(revision 59707)
@@ -687,7 +687,7 @@
   `extwikiId` int(12) NOT NULL auto_increment,
   `name` varchar(200) NOT NULL default '',
   `extwiki` varchar(255) default NULL,
-  `indexname` varchar(20) default NULL,
+  `indexname` varchar(255) default NULL,
   `groups` varchar(1024) default NULL,
   PRIMARY KEY (`extwikiId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;

------------------------------------------------------------------------
r59664 | jonnybradley | 2016-09-10 12:25:02 -0400 (sÃ¡b, 10 set 2016) | 2 lines

[FIX] tiki.sql: Add missing columns in tiki_extwiki in new installs but included in upgrades in 20140807_federated_search_tiki.sql
(detected by \EditLib_ParseToWiki_LinkTest::testExternalWiki, woo!)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 59663)
+++ tiki.sql	(revision 59664)
@@ -687,6 +687,8 @@
   `extwikiId` int(12) NOT NULL auto_increment,
   `name` varchar(200) NOT NULL default '',
   `extwiki` varchar(255) default NULL,
+  `indexname` varchar(20) default NULL,
+  `groups` varchar(1024) default NULL,
   PRIMARY KEY (`extwikiId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 

------------------------------------------------------------------------
r59141 | yonixxx | 2016-07-09 15:48:34 -0400 (sÃ¡b, 09 jul 2016) | 1 line

[FIX] Reverted change from commit 58902 that was breaking the install process - Admin user wasn't created.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 59140)
+++ tiki.sql	(revision 59141)
@@ -2713,6 +2713,7 @@
   `userId` int(8) NOT NULL auto_increment,
   `email` varchar(200) default NULL,
   `login` varchar(200) NOT NULL default '',
+  `password` varchar(30) default '',
   `provpass` varchar(30) default NULL,
   `default_group` varchar(255),
   `lastLogin` int(14) default NULL,

------------------------------------------------------------------------
r58902 | drsassafras | 2016-06-14 05:38:38 -0400 (ter, 14 jun 2016) | 1 line

[SEC][DB][REM][ENH] Removal of code related to two already disabled features, open passwords & password challenge.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 58901)
+++ tiki.sql	(revision 58902)
@@ -2713,13 +2713,11 @@
   `userId` int(8) NOT NULL auto_increment,
   `email` varchar(200) default NULL,
   `login` varchar(200) NOT NULL default '',
-  `password` varchar(30) default '',
   `provpass` varchar(30) default NULL,
   `default_group` varchar(255),
   `lastLogin` int(14) default NULL,
   `currentLogin` int(14) default NULL,
   `registrationDate` int(14) default NULL,
-  `challenge` varchar(32) default NULL,
   `pass_confirm` int(14) default NULL,
   `email_confirm` int(14) default NULL,
   `hash` varchar(60) default NULL,

------------------------------------------------------------------------
r58836 | jonnybradley | 2016-06-08 11:27:23 -0400 (qua, 08 jun 2016) | 5 lines

[MRG] Automatic merge, branches/15.x 58823 to 58835
Conflicts occurred in:
	lib/jquery_tiki/tiki-jquery.js          fixed
	lib/wiki-plugins/wikiplugin_quote.php   totally different, not merged, sorry


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 58835)
+++ tiki.sql	(revision 58836)
@@ -1467,6 +1467,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Mail Notifications','tiki-admin_notifications.php',1120,'','tiki_p_admin_notifications','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Search Stats','tiki-search_stats.php',1125,'feature_search_stats','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Theme Control','tiki-theme_control.php',1130,'feature_theme_control','tiki_p_admin','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Tokens','tiki-admin_tokens.php',1132,'auth_token_access','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Toolbars','tiki-admin_toolbars.php',1135,'','tiki_p_admin_toolbars','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Transitions','tiki-admin_transitions.php',1140,'','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Categories','tiki-admin_categories.php',1145,'feature_categories','tiki_p_admin_categories','',0);

------------------------------------------------------------------------
r58761 | jonnybradley | 2016-06-01 14:48:35 -0400 (qua, 01 jun 2016) | 1 line

[MRG] Automatic merge, branches/15.x 58756 to 58760

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 58760)
+++ tiki.sql	(revision 58761)
@@ -256,8 +256,8 @@
   `ip3` char(3) default NULL,
   `ip4` char(3) default NULL,
   `user` varchar(200) default '',
-  `date_from` timestamp NOT NULL,
-  `date_to` timestamp NOT NULL,
+  `date_from` timestamp NULL,
+  `date_to` timestamp NULL,
   `use_dates` char(1) default NULL,
   `created` int(14) default NULL,
   `message` text,
@@ -2387,7 +2387,7 @@
 CREATE TABLE `tiki_user_login_cookies` (
     `userId` INT NOT NULL,
     `secret` CHAR(64) NOT NULL,
-    `expiration` TIMESTAMP NOT NULL,
+    `expiration` TIMESTAMP NULL,
     PRIMARY KEY (`userId`, `secret`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
@@ -3362,8 +3362,8 @@
     `amount_paid` DECIMAL(7,2) NOT NULL DEFAULT 0.0,
     `currency` CHAR(3) NOT NULL,
     `request_date` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    `due_date` TIMESTAMP NOT NULL,
-	`authorized_until` TIMESTAMP NULL,
+    `due_date` TIMESTAMP NULL,
+    `authorized_until` TIMESTAMP NULL,
     `cancel_date` TIMESTAMP NULL,
     `description` VARCHAR(100) NOT NULL,
     `actions` TEXT,
@@ -3610,8 +3610,8 @@
   `bookId` int(10) unsigned NOT NULL AUTO_INCREMENT,
   `bookName` varchar(255) NOT NULL,
   `bookClosed` enum('y','n') NOT NULL DEFAULT 'n',
-  `bookStartDate` date NOT NULL,
-  `bookEndDate` date NOT NULL,
+  `bookStartDate` date NULL,
+  `bookEndDate` date NULL,
   `bookCurrency` varchar(3) NOT NULL DEFAULT 'EUR',
   `bookCurrencyPos` int(11) NOT NULL,
   `bookDecimals` int(11) NOT NULL DEFAULT '2',
@@ -3640,7 +3640,7 @@
 CREATE TABLE `tiki_acct_journal` (
   `journalBookId` int(10) unsigned NOT NULL,
   `journalId` int(10) unsigned NOT NULL AUTO_INCREMENT,
-  `journalDate` date NOT NULL DEFAULT '0000-00-00',
+  `journalDate` date NULL,
   `journalDescription` varchar(255) NOT NULL,
   `journalCancelled` int(1) NOT NULL DEFAULT '0',
   `journalTs` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
@@ -3651,7 +3651,7 @@
 CREATE TABLE `tiki_acct_stack` (
   `stackBookId` int(10) unsigned NOT NULL,
   `stackId` int(10) unsigned NOT NULL AUTO_INCREMENT,
-  `stackDate` date NOT NULL DEFAULT '0000-00-00',
+  `stackDate` date NULL,
   `stackDescription` varchar(255) NOT NULL,
   `stackTs` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
   PRIMARY KEY (`stackId`)
@@ -3673,8 +3673,8 @@
   `statementBookId` int(10) unsigned NOT NULL,
   `statementAccountId` int(10) unsigned NOT NULL DEFAULT '0',
   `statementId` int(10) unsigned NOT NULL AUTO_INCREMENT,
-  `statementBookingDate` date NOT NULL,
-  `statementValueDate` date NOT NULL,
+  `statementBookingDate` date NULL,
+  `statementValueDate` date NULL,
   `statementBookingText` varchar(255) NOT NULL,
   `statementReason` varchar(255) NOT NULL,
   `statementCounterpart` varchar(63) NOT NULL,

------------------------------------------------------------------------
r58740 | jonnybradley | 2016-05-30 07:39:15 -0400 (seg, 30 mai 2016) | 1 line

[MRG] Automatic merge, branches/15.x 58712 to 58739

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 58739)
+++ tiki.sql	(revision 58740)
@@ -1322,6 +1322,8 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Tags','tiki-browse_freetags.php',27,'feature_freetags','tiki_p_view_freetags','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Calendar','tiki-calendar.php',35,'feature_calendar','tiki_p_view_calendar','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Tiki Calendar','tiki-action_calendar.php',37,'feature_action_calendar','tiki_p_view_tiki_calendar','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Payments','tiki-payment.php',39,'payment_feature','tiki_p_payment_view','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Payments','tiki-payment.php',39,'payment_feature','tiki_p_payment_request','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','(debug)','javascript:toggle(\'debugconsole\')',40,'feature_debug_console','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','User Wizard','tiki-wizard_user.php',45,'feature_wizard_user','','Registered',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','My Account','tiki-my_tiki.php',50,'feature_mytiki','','Registered',0);

------------------------------------------------------------------------
r58641 | jonnybradley | 2016-05-19 12:20:17 -0400 (qui, 19 mai 2016) | 1 line

[MRG] Automatic merge, branches/15.x 58626 to 58640

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 58640)
+++ tiki.sql	(revision 58641)
@@ -2970,6 +2970,9 @@
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Created', 'category', 'y');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Updated', 'category', 'y');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Removed', 'category', 'y');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Created', 'calendar event', 'n');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Updated', 'calendar event', 'n');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Removed', 'calendar event', 'n');
 
 DROP TABLE IF EXISTS `tiki_freetags`;
 CREATE TABLE `tiki_freetags` (

------------------------------------------------------------------------
r58078 | jonnybradley | 2016-03-26 10:16:24 -0400 (sÃ¡b, 26 mar 2016) | 1 line

[MRG] Automatic merge, branches/15.x 58067 to 58077

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 58077)
+++ tiki.sql	(revision 58078)
@@ -1347,7 +1347,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Last Changes','tiki-lastchanges.php',205,'feature_wiki,feature_lastChanges','tiki_p_view','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Dump','dump/new.tar',210,'feature_wiki,feature_dump','tiki_p_view','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Rankings','tiki-wiki_rankings.php',215,'feature_wiki,feature_wiki_rankings','tiki_p_view','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Pages','tiki-listpages.php',220,'feature_wiki,feature_listPages','tiki_p_view','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Pages','tiki-listpages.php?cookietab=1#tab1',220,'feature_wiki,feature_listPages','tiki_p_view','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Create a Wiki Page','tiki-listpages.php?cookietab=2#tab2',222,'feature_wiki,feature_listPages','tiki_p_view,tiki_p_edit','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Orphan Pages','tiki-orphan_pages.php',225,'feature_wiki,feature_listorphanPages','tiki_p_view','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Sandbox','tiki-editpage.php?page=sandbox',230,'feature_wiki,feature_sandbox','tiki_p_view','',0);

------------------------------------------------------------------------
r57666 | jonnybradley | 2016-02-29 07:23:37 -0400 (seg, 29 fev 2016) | 4 lines

[MRG] Automatic merge, branches/15.x 57626 to 57665
Conflict fixed in
    lib/setup/twversion.class.php


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 57665)
+++ tiki.sql	(revision 57666)
@@ -3880,4 +3880,4 @@
 	`format_descriptor` TEXT,
 	`filter_descriptor` TEXT,
 	KEY `tabular_tracker_ix` (`trackerId`)
-);
+) ENGINE=MyISAM;

------------------------------------------------------------------------
r57379 | jonnybradley | 2016-02-01 12:45:28 -0400 (seg, 01 fev 2016) | 1 line

[KIL] map server: Remove ancient map server feature (feature_maps) and associated libraries etc

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 57378)
+++ tiki.sql	(revision 57379)
@@ -1402,9 +1402,6 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','FAQs','tiki-list_faqs.php',650,'feature_faqs','tiki_p_view_faqs','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List FAQs','tiki-list_faqs.php',665,'feature_faqs','tiki_p_view_faqs','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Admin FAQs','tiki-list_faqs.php',660,'feature_faqs','tiki_p_admin_faqs','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','Maps','tiki-map.php',700,'feature_maps','tiki_p_map_view','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Mapfiles','tiki-map_edit.php',705,'feature_maps','tiki_p_map_view','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Layer Management','tiki-map_upload.php',710,'feature_maps','tiki_p_map_edit','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','Quizzes','tiki-list_quizzes.php',750,'feature_quizzes','tiki_p_take_quiz','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Quizzes','tiki-list_quizzes.php',755,'feature_quizzes','tiki_p_take_quiz','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Quiz Stats','tiki-quiz_stats.php',760,'feature_quizzes','tiki_p_view_quiz_stats','',0);

------------------------------------------------------------------------
r57270 | jonnybradley | 2016-01-20 12:38:22 -0400 (qua, 20 jan 2016) | 1 line

[FIX] gmaps: Move left over menu tem

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 57269)
+++ tiki.sql	(revision 57270)
@@ -1321,7 +1321,6 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Categories','tiki-browse_categories.php',25,'feature_categories','tiki_p_view_category','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Tags','tiki-browse_freetags.php',27,'feature_freetags','tiki_p_view_freetags','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Calendar','tiki-calendar.php',35,'feature_calendar','tiki_p_view_calendar','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Users Map','tiki-gmap_usermap.php',36,'feature_gmap','','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Tiki Calendar','tiki-action_calendar.php',37,'feature_action_calendar','tiki_p_view_tiki_calendar','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','(debug)','javascript:toggle(\'debugconsole\')',40,'feature_debug_console','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','User Wizard','tiki-wizard_user.php',45,'feature_wizard_user','','Registered',0);

------------------------------------------------------------------------
r56898 | patrick-proulx | 2015-12-04 14:49:34 -0400 (sex, 04 dez 2015) | 2 lines

[FIX] Minor change to the install script for the recently updated scoring system


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 56897)
+++ tiki.sql	(revision 56898)
@@ -2807,8 +2807,8 @@
 	{"ruleId":"User logs in","recipientType":"user","recipient":"user","score":"1","validObjectIds":[""],"expiration":""}
 ]',''),
 ('tiki.user.view','[
-	{"ruleId":"See other user\'s profile","recipientType":"user","recipient":"user","score":"2","validObjectIds":[""],"expiration":"60"},
-	{"ruleId":"Have your profile seen","recipientType":"user","recipient":"object","score":"1","validObjectIds":[""],"expiration":"60"}
+	{"ruleId":"See other user\'s profile","recipientType":"user","recipient":"user","score":"2","validObjectIds":[""],"expiration":""},
+	{"ruleId":"Have your profile seen","recipientType":"user","recipient":"object","score":"1","validObjectIds":[""],"expiration":""}
 ]',''),
 ('tiki.user.friend','[
 	{"ruleId":"Make friends","recipientType":"user","recipient":"user","score":"10","validObjectIds":[""],"expiration":""}
@@ -2841,8 +2841,8 @@
 	{"ruleId":"Upload new image to gallery","recipientType":"user","recipient":"user","score":"6","validObjectIds":[""],"expiration":""}
 ]',''),
 ('tiki.image.view','[
-	{"ruleId":"See other user\'s image","recipientType":"user","recipient":"user","score":"3","validObjectIds":[""],"expiration":"60"},
-	{"ruleId":"Have your image seen","recipientType":"user","recipient":"owner","score":"1","validObjectIds":[""],"expiration":"60"}
+	{"ruleId":"See other user\'s image","recipientType":"user","recipient":"user","score":"3","validObjectIds":[""],"expiration":""},
+	{"ruleId":"Have your image seen","recipientType":"user","recipient":"owner","score":"1","validObjectIds":[""],"expiration":""}
 ]',''),
 ('tiki.blog.create','[
 	{"ruleId":"Create new blog","recipientType":"user","recipient":"user","score":"20","validObjectIds":[""],"expiration":""}

------------------------------------------------------------------------
r56896 | patrick-proulx | 2015-12-04 14:31:54 -0400 (sex, 04 dez 2015) | 2 lines

[FIX] Included the db install script updates for new scoring system (ref: r56883)


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 56895)
+++ tiki.sql	(revision 56896)
@@ -2731,13 +2731,11 @@
   `avatarData` longblob,
   `avatarLibName` varchar(200) default NULL,
   `avatarType` char(1) default NULL,
-  `score` int(11) NOT NULL default 0,
   `valid` varchar(32) default NULL,
   `unsuccessful_logins` int(14) default 0,
   `openid_url` varchar(255) default NULL,
   `waiting` char(1) default NULL,
   PRIMARY KEY (`userId`),
-  KEY `score` (score),
   UNIQUE KEY `login` (login),
   KEY `registrationDate` (`registrationDate`),
   KEY `openid_url` (openid_url)
@@ -2798,52 +2796,88 @@
 
 DROP TABLE IF EXISTS `tiki_score`;
 CREATE TABLE `tiki_score` (
-  event varchar(40) NOT NULL default '',
-  score int(11) NOT NULL default '0',
-  expiration int(11) NOT NULL default '0',
-  validObjectIds text,
+  event varchar(255) NOT NULL default '',
+  data text,
+  reversalEvent varchar(255),
   PRIMARY KEY (`event`)
 ) ENGINE=MyISAM;
 
-INSERT INTO tiki_score (event, score, expiration) VALUES ('login',1,0);
-INSERT INTO tiki_score (event, score, expiration) VALUES ('login_remain',2,60);
-INSERT INTO tiki_score (event, score, expiration) VALUES ('profile_fill',10,0);
-INSERT INTO tiki_score (event, score, expiration) VALUES ('profile_see',2,0);
-INSERT INTO tiki_score (event, score, expiration) VALUES ('profile_is_seen',1,0);
-INSERT INTO tiki_score (event, score, expiration) VALUES ('friend_new',10,0);
-INSERT INTO tiki_score (event, score, expiration) VALUES ('message_receive',1,0);
-INSERT INTO tiki_score (event, score, expiration) VALUES ('message_send',2,0);
-INSERT INTO tiki_score (event, score, expiration) VALUES ('article_read',2,0);
-INSERT INTO tiki_score (event, score, expiration) VALUES ('article_comment',5,0);
-INSERT INTO tiki_score (event, score, expiration) VALUES ('article_new',20,0);
-INSERT INTO tiki_score (event, score, expiration) VALUES ('article_is_read',1,0);
-INSERT INTO tiki_score (event, score, expiration) VALUES ('article_is_commented',2,0);
-INSERT INTO tiki_score (event, score, expiration) VALUES ('fgallery_new',10,0);
-INSERT INTO tiki_score (event, score, expiration) VALUES ('fgallery_new_file',10,0);
-INSERT INTO tiki_score (event, score, expiration) VALUES ('fgallery_download',5,0);
-INSERT INTO tiki_score (event, score, expiration) VALUES ('fgallery_is_downloaded',5,0);
-INSERT INTO tiki_score (event, score, expiration) VALUES ('igallery_new',10,0);
-INSERT INTO tiki_score (event, score, expiration) VALUES ('igallery_new_img',6,0);
-INSERT INTO tiki_score (event, score, expiration) VALUES ('igallery_see_img',3,0);
-INSERT INTO tiki_score (event, score, expiration) VALUES ('igallery_img_seen',1,0);
-INSERT INTO tiki_score (event, score, expiration) VALUES ('blog_new',20,0);
-INSERT INTO tiki_score (event, score, expiration) VALUES ('blog_post',5,0);
-INSERT INTO tiki_score (event, score, expiration) VALUES ('blog_read',2,0);
-INSERT INTO tiki_score (event, score, expiration) VALUES ('blog_comment',2,0);
-INSERT INTO tiki_score (event, score, expiration) VALUES ('blog_is_read',3,0);
-INSERT INTO tiki_score (event, score, expiration) VALUES ('blog_is_commented',3,0);
-INSERT INTO tiki_score (event, score, expiration) VALUES ('wiki_new',10,0);
-INSERT INTO tiki_score (event, score, expiration) VALUES ('wiki_edit',5,0);
-INSERT INTO tiki_score (event, score, expiration) VALUES ('wiki_attach_file',3,0);
+INSERT INTO `tiki_score` VALUES
+('tiki.user.login','[
+	{"ruleId":"User logs in","recipientType":"user","recipient":"user","score":"1","validObjectIds":[""],"expiration":""}
+]',''),
+('tiki.user.view','[
+	{"ruleId":"See other user\'s profile","recipientType":"user","recipient":"user","score":"2","validObjectIds":[""],"expiration":"60"},
+	{"ruleId":"Have your profile seen","recipientType":"user","recipient":"object","score":"1","validObjectIds":[""],"expiration":"60"}
+]',''),
+('tiki.user.friend','[
+	{"ruleId":"Make friends","recipientType":"user","recipient":"user","score":"10","validObjectIds":[""],"expiration":""}
+]',''),
+('tiki.user.message','[
+	{"ruleId":"Send message","recipientType":"user","recipient":"user","score":"2","validObjectIds":[""],"expiration":""},
+	{"ruleId":"Receive message","recipientType":"user","recipient":"object","score":"1","validObjectIds":[""],"expiration":""}
+]',''),
+('tiki.article.create','[
+	{"ruleId":"Publish new article","recipientType":"user","recipient":"user","score":"20","validObjectIds":[""],"expiration":""}
+]',''),
+('tiki.article.view','[
+	{"ruleId":"Read an article","recipientType":"user","recipient":"user","score":"2","validObjectIds":[""],"expiration":""},
+	{"ruleId":"Have your article read","recipientType":"user","recipient":"author","score":"1","validObjectIds":[""],"expiration":""}
+]',''),
+('tiki.filegallery.create','[
+	{"ruleId":"Create new file gallery","recipientType":"user","recipient":"user","score":"10","validObjectIds":[""],"expiration":""}
+]',''),
+('tiki.file.create','[
+	{"ruleId":"Upload new file to gallery","recipientType":"user","recipient":"user","score":"10","validObjectIds":[""],"expiration":""}
+]',''),
+('tiki.file.download','[
+	{"ruleId":"Download other user\'s file","recipientType":"user","recipient":"user","score":"5","validObjectIds":[""],"expiration":""},
+	{"ruleId":"Have your file downloaded","recipientType":"user","recipient":"owner","score":"5","validObjectIds":[""],"expiration":""}
+]',''),
+('tiki.imagegallery.create','[
+	{"ruleId":"Create new image gallery","recipientType":"user","recipient":"user","score":"10","validObjectIds":[""],"expiration":""}
+]',''),
+('tiki.image.create','[
+	{"ruleId":"Upload new image to gallery","recipientType":"user","recipient":"user","score":"6","validObjectIds":[""],"expiration":""}
+]',''),
+('tiki.image.view','[
+	{"ruleId":"See other user\'s image","recipientType":"user","recipient":"user","score":"3","validObjectIds":[""],"expiration":"60"},
+	{"ruleId":"Have your image seen","recipientType":"user","recipient":"owner","score":"1","validObjectIds":[""],"expiration":"60"}
+]',''),
+('tiki.blog.create','[
+	{"ruleId":"Create new blog","recipientType":"user","recipient":"user","score":"20","validObjectIds":[""],"expiration":""}
+]',''),
+('tiki.blogpost.create','[
+	{"ruleId":"Post in a blog","recipientType":"user","recipient":"user","score":"5","validObjectIds":[""],"expiration":""}
+]',''),
+('tiki.blog.view','[
+	{"ruleId":"Read other user\'s blog","recipientType":"user","recipient":"user","score":"2","validObjectIds":[""],"expiration":""},
+	{"ruleId":"Have your blog read","recipientType":"user","recipient":"author","score":"3","validObjectIds":[""],"expiration":""}
+]',''),
+('tiki.wiki.create','[
+	{"ruleId":"Create a wiki page","recipientType":"user","recipient":"user","score":"10","validObjectIds":[""],"expiration":""}
+]',''),
+('tiki.wiki.update','[
+	{"ruleId":"Edit an existing wiki page","recipientType":"user","recipient":"user","score":"5","validObjectIds":[""],"expiration":""}
+]',''),
+('tiki.wiki.attachfile','[
+	{"ruleId":"Attach file to wiki page","recipientType":"user","recipient":"user","score":"3","validObjectIds":[""],"expiration":""}
+]','');
 
-DROP TABLE IF EXISTS `tiki_users_score`;
-CREATE TABLE `tiki_users_score` (
-  `user` char(200) NOT NULL default '',
-  `event_id` char(200) NOT NULL default '',
-  `expire` int(14) NOT NULL default '0',
-  `tstamp` timestamp NOT NULL,
-  PRIMARY KEY (`user`(110),`event_id`(110)),
-  KEY `user` (user(110),event_id(110),expire)
+DROP TABLE IF EXISTS `tiki_object_scores`;
+CREATE TABLE `tiki_object_scores` (
+  `id` INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY,
+  `triggerObjectType` VARCHAR(255) NOT NULL,
+  `triggerObjectId` VARCHAR(255) NOT NULL,
+  `triggerUser` VARCHAR(255) NOT NULL,
+  `triggerEvent` VARCHAR(255) NOT NULL,
+  `ruleId` VARCHAR(255) NOT NULL,
+  `recipientObjectType` VARCHAR(255) NOT NULL,
+  `recipientObjectId` VARCHAR(255) NOT NULL,
+  `pointsAssigned` INT NOT NULL,
+  `pointsBalance` INT NOT NULL,
+  `date` INT NOT NULL,
+  `reversalOf` INT UNSIGNED
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_file_handlers`;

------------------------------------------------------------------------
r56888 | nkoth | 2015-12-03 20:40:34 -0400 (qui, 03 dez 2015) | 2 lines

[NEW] Allow users to login to Tiki using temporary user account via a token with the perms of specified groups (without needing permanent user account)


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 56887)
+++ tiki.sql	(revision 56888)
@@ -3306,6 +3306,8 @@
     `email` varchar(255) NOT NULL,
     `parameters` VARCHAR(255),
     `groups` TEXT,
+    `createUser` CHAR(1) DEFAULT 'n',
+    `userPrefix` VARCHAR(200) DEFAULT '_token',
     PRIMARY KEY( `tokenId` ),
     KEY `tiki_auth_tokens_token` (`token`)
 ) ENGINE=MyISAM;

------------------------------------------------------------------------
r56361 | jonnybradley | 2015-09-29 09:51:06 -0400 (ter, 29 set 2015) | 1 line

[MRG] Automatic merge, branches/14.x 56357 to 56360

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 56360)
+++ tiki.sql	(revision 56361)
@@ -1062,7 +1062,7 @@
 
 DROP TABLE IF EXISTS `tiki_hotwords`;
 CREATE TABLE `tiki_hotwords` (
-  `word` varchar(40) NOT NULL default '',
+  `word` varchar(255) NOT NULL default '',
   `url` varchar(255) NOT NULL default '',
   PRIMARY KEY (`word`)
 ) ENGINE=MyISAM;

------------------------------------------------------------------------
r56127 | patrick-proulx | 2015-09-02 08:46:23 -0400 (qua, 02 set 2015) | 2 lines

[FIX] Added the character length for preference names to the tiki.sql as well (update script was added in r56121)


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 56126)
+++ tiki.sql	(revision 56127)
@@ -1725,7 +1725,7 @@
 
 DROP TABLE IF EXISTS `tiki_preferences`;
 CREATE TABLE `tiki_preferences` (
-  `name` varchar(40) NOT NULL default '',
+  `name` varchar(255) NOT NULL default '',
   `value` text,
   PRIMARY KEY (`name`)
 ) ENGINE=MyISAM;

------------------------------------------------------------------------
r55962 | jonnybradley | 2015-07-31 06:11:49 -0400 (sex, 31 jul 2015) | 1 line

[MRG] Automatic merge, branches/14.x 55926 to 55961

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 55961)
+++ tiki.sql	(revision 55962)
@@ -1414,6 +1414,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Sheets','tiki-sheets.php',782,'feature_sheet','tiki_p_view_sheet','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','Trackers','tiki-list_trackers.php',800,'feature_trackers','tiki_p_list_trackers','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Trackers','tiki-list_trackers.php',805,'feature_trackers','tiki_p_list_trackers','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Manage Tabular Formats','tiki-tabular-manage',810,'tracker_tabular_enabled','tiki_p_tabular_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s', 'Accounting', 'tiki-accounting_books.php', 830, 'feature_accounting', 'tiki_p_acct_view', '', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o', 'Accounting books', 'tiki-accounting_books.php', 835, 'feature_accounting', 'tiki_p_acct_view', '', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','Surveys','tiki-list_surveys.php',850,'feature_surveys','tiki_p_take_survey','',0);

------------------------------------------------------------------------
r55235 | lindonb | 2015-04-27 00:29:24 -0400 (seg, 27 abr 2015) | 1 line

[MRG] Automatic merge, branches/14.x 55218 to 55234

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 55234)
+++ tiki.sql	(revision 55235)
@@ -1462,6 +1462,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Hotwords','tiki-admin_hotwords.php',1095,'feature_hotwords','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Edit languages','tiki-edit_languages.php',1098,'lang_use_db','tiki_p_edit_languages','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','External Feeds','tiki-admin_rssmodules.php',1100,'','tiki_p_admin_rssmodules','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','External Wikis','tiki-admin_external_wikis.php',1102,'','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Menus','tiki-admin_menus.php',1105,'','tiki_p_edit_menu','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Polls','tiki-admin_polls.php',1110,'feature_polls','tiki_p_admin_polls','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Mail Notifications','tiki-admin_notifications.php',1120,'','tiki_p_admin_notifications','',0);

------------------------------------------------------------------------
r55081 | nkoth | 2015-04-14 19:45:18 -0400 (ter, 14 abr 2015) | 1 line

[MRG] Automatic merge, branches/14.x 55063 to 55078

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 55080)
+++ tiki.sql	(revision 55081)
@@ -3038,7 +3038,7 @@
   `profile` VARCHAR(100) NOT NULL,
   `object` VARCHAR(150) NOT NULL,
   `type` VARCHAR(20) NOT NULL,
-  `value` VARCHAR(50) NOT NULL,
+  `value` VARCHAR(160) NOT NULL,
   `named` ENUM('y','n') NOT NULL,
   `creation_date` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
   PRIMARY KEY ( `domain`, `profile`, `object` ),

------------------------------------------------------------------------
r54331 | jonnybradley | 2015-03-11 09:01:24 -0400 (qua, 11 mar 2015) | 1 line

[MRG] Automatic merge, branches/14.x 54316 to 54330

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 54330)
+++ tiki.sql	(revision 54331)
@@ -1325,8 +1325,8 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Tiki Calendar','tiki-action_calendar.php',37,'feature_action_calendar','tiki_p_view_tiki_calendar','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','(debug)','javascript:toggle(\'debugconsole\')',40,'feature_debug_console','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','User Wizard','tiki-wizard_user.php',45,'feature_wizard_user','','Registered',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','MyTiki','tiki-my_tiki.php',50,'feature_mytiki','','Registered',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','MyTiki Home','tiki-my_tiki.php',51,'feature_mytiki','','Registered',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','My Account','tiki-my_tiki.php',50,'feature_mytiki','','Registered',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','My Account Home','tiki-my_tiki.php',51,'feature_mytiki','','Registered',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Preferences','tiki-user_preferences.php',55,'feature_mytiki,feature_userPreferences','','Registered',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Messages','messu-mailbox.php',60,'feature_mytiki,feature_messages','tiki_p_messages','Registered',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Tasks','tiki-user_tasks.php',65,'feature_mytiki,feature_tasks','tiki_p_tasks','Registered',0);
@@ -3210,7 +3210,7 @@
 UPDATE tiki_menu_options SET icon = 'messages48x48' WHERE name = 'Newsletters';
 UPDATE tiki_menu_options SET icon = 'vcard48x48' WHERE name = 'Tags';
 UPDATE tiki_menu_options SET icon = 'date48x48' WHERE name = 'Calendar' AND url = 'tiki-calendar.php';
-UPDATE tiki_menu_options SET icon = 'userfiles48x48' WHERE name = 'MyTiki';
+UPDATE tiki_menu_options SET icon = 'userfiles48x48' WHERE name = 'My Account';
 UPDATE tiki_menu_options SET icon = 'home48x48' WHERE name = 'Home';
 UPDATE tiki_menu_options SET icon = 'categories48x48' WHERE name = 'Categories';
 UPDATE tiki_menu_options SET icon = 'accounting48x48' WHERE name = 'Accounting';

------------------------------------------------------------------------
r54317 | jonnybradley | 2015-03-10 13:45:58 -0400 (ter, 10 mar 2015) | 1 line

[MRG] Automatic merge, branches/14.x 54308 to 54316

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 54316)
+++ tiki.sql	(revision 54317)
@@ -1319,7 +1319,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Contact Us','tiki-contact.php',20,'feature_contact,feature_messages','','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Stats','tiki-stats.php',23,'feature_stats','tiki_p_view_stats','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Categories','tiki-browse_categories.php',25,'feature_categories','tiki_p_view_category','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Freetags','tiki-browse_freetags.php',27,'feature_freetags','tiki_p_view_freetags','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Tags','tiki-browse_freetags.php',27,'feature_freetags','tiki_p_view_freetags','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Calendar','tiki-calendar.php',35,'feature_calendar','tiki_p_view_calendar','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Users Map','tiki-gmap_usermap.php',36,'feature_gmap','','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Tiki Calendar','tiki-action_calendar.php',37,'feature_action_calendar','tiki_p_view_tiki_calendar','',0);
@@ -3208,7 +3208,7 @@
 UPDATE tiki_menu_options SET icon = 'stock_dialog_question48x48' WHERE name = 'FAQs';
 UPDATE tiki_menu_options SET icon = 'maps48x48' WHERE name = 'Maps';
 UPDATE tiki_menu_options SET icon = 'messages48x48' WHERE name = 'Newsletters';
-UPDATE tiki_menu_options SET icon = 'vcard48x48' WHERE name = 'Freetags';
+UPDATE tiki_menu_options SET icon = 'vcard48x48' WHERE name = 'Tags';
 UPDATE tiki_menu_options SET icon = 'date48x48' WHERE name = 'Calendar' AND url = 'tiki-calendar.php';
 UPDATE tiki_menu_options SET icon = 'userfiles48x48' WHERE name = 'MyTiki';
 UPDATE tiki_menu_options SET icon = 'home48x48' WHERE name = 'Home';

------------------------------------------------------------------------
r53750 | patrick-proulx | 2015-02-03 15:16:09 -0400 (ter, 03 fev 2015) | 3 lines

[ENH] Add the ability to assign a class to a Tiki menu option



Index: tiki.sql
===================================================================
--- tiki.sql	(revision 53749)
+++ tiki.sql	(revision 53750)
@@ -1307,6 +1307,7 @@
   `groupname` text default NULL,
   `userlevel` int(4) default 0,
   `icon` varchar(200),
+  `class` text default NULL,
   PRIMARY KEY (`optionId`),
   UNIQUE KEY `uniq_menu` (`menuId`,`name`(30),`url`(50),`position`,`section`(60),`perm`(50),`groupname`(50))
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;

------------------------------------------------------------------------
r53446 | lphuberdeau | 2015-01-09 14:21:23 -0400 (sex, 09 jan 2015) | 1 line

[MOD] Adding UI components to select available filters on tabular

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 53445)
+++ tiki.sql	(revision 53446)
@@ -3843,5 +3843,6 @@
 	`trackerId` INT NOT NULL,
 	`name` VARCHAR(30) NOT NULL,
 	`format_descriptor` TEXT,
+	`filter_descriptor` TEXT,
 	KEY `tabular_tracker_ix` (`trackerId`)
 );

------------------------------------------------------------------------
r53190 | xavidp | 2014-11-25 04:23:12 -0400 (ter, 25 nov 2014) | 1 line

[MOD]Renaming menu option 'Configuration' into 'Settings', and 'Configuration Panels' (or just 'Panels') into 'Control Panels', as discussed in the devel list and decided on the last webinar. Re: http://dev.tiki.org/Tiki14#Renaming_of_Admin_X 

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 53189)
+++ tiki.sql	(revision 53190)
@@ -1425,30 +1425,30 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','Newsletters','tiki-newsletters.php',900,'feature_newsletters','tiki_p_list_newsletters','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Send Newsletters','tiki-send_newsletters.php',905,'feature_newsletters','tiki_p_send_newsletters','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Admin Newsletters','tiki-admin_newsletters.php',910,'feature_newsletters','tiki_p_admin_newsletters','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_admin','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_admin_categories','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_admin_banners','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_edit_templates','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_edit_cookies','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_admin_dynamic','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_admin_mailin','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_edit_content_templates','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_edit_html_pages','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_view_referer_stats','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_admin_shoutbox','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_live_support_admin','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','user_is_operator','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'feature_integrator','tiki_p_admin_integrator','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'feature_edit_templates','tiki_p_edit_templates','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'feature_view_tpl','tiki_p_edit_templates','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'feature_editcss','tiki_p_create_css','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_admin_contribution','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_admin_users','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_admin_toolbars','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_edit_menu','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_clean_cache','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_admin_modules','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o',' Panels','tiki-admin.php',1051,'','tiki_p_admin','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Settings','tiki-admin.php',1050,'','tiki_p_admin','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Settings','tiki-admin.php',1050,'','tiki_p_admin_categories','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Settings','tiki-admin.php',1050,'','tiki_p_admin_banners','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Settings','tiki-admin.php',1050,'','tiki_p_edit_templates','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Settings','tiki-admin.php',1050,'','tiki_p_edit_cookies','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Settings','tiki-admin.php',1050,'','tiki_p_admin_dynamic','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Settings','tiki-admin.php',1050,'','tiki_p_admin_mailin','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Settings','tiki-admin.php',1050,'','tiki_p_edit_content_templates','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Settings','tiki-admin.php',1050,'','tiki_p_edit_html_pages','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Settings','tiki-admin.php',1050,'','tiki_p_view_referer_stats','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Settings','tiki-admin.php',1050,'','tiki_p_admin_shoutbox','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Settings','tiki-admin.php',1050,'','tiki_p_live_support_admin','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Settings','tiki-admin.php',1050,'','user_is_operator','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Settings','tiki-admin.php',1050,'feature_integrator','tiki_p_admin_integrator','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Settings','tiki-admin.php',1050,'feature_edit_templates','tiki_p_edit_templates','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Settings','tiki-admin.php',1050,'feature_view_tpl','tiki_p_edit_templates','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Settings','tiki-admin.php',1050,'feature_editcss','tiki_p_create_css','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Settings','tiki-admin.php',1050,'','tiki_p_admin_contribution','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Settings','tiki-admin.php',1050,'','tiki_p_admin_users','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Settings','tiki-admin.php',1050,'','tiki_p_admin_toolbars','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Settings','tiki-admin.php',1050,'','tiki_p_edit_menu','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Settings','tiki-admin.php',1050,'','tiki_p_clean_cache','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Settings','tiki-admin.php',1050,'','tiki_p_admin_modules','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o',' Control Panels','tiki-admin.php',1051,'','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Live Support','tiki-live_support_admin.php',1055,'feature_live_support','tiki_p_live_support_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Live Support','tiki-live_support_admin.php',1055,'feature_live_support','user_is_operator','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Banning','tiki-admin_banning.php',1060,'feature_banning','tiki_p_admin_banning','',0);
@@ -3194,7 +3194,7 @@
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-list_file_gallery.php\\?galleryId=(\\d+)', 'file$1', 'file gallery', 'feature_file_galleries', 200);
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-user_information.php\\?userId=(\\d+)','user$1', '', '', 200);
 
-UPDATE tiki_menu_options SET icon = 'icon-configuration48x48' WHERE name = 'Configuration';
+UPDATE tiki_menu_options SET icon = 'icon-configuration48x48' WHERE name = 'Settings';
 UPDATE tiki_menu_options SET icon = 'xfce4-appfinder48x48' WHERE name = 'Search';
 UPDATE tiki_menu_options SET icon = 'wikipages48x48' WHERE name = 'Wiki';
 UPDATE tiki_menu_options SET icon = 'blogs48x48' WHERE name = 'Blogs';

------------------------------------------------------------------------
r53165 | lphuberdeau | 2014-11-20 13:31:13 -0400 (qui, 20 nov 2014) | 1 line

[NEW] Adding a primitive UI to use the tracker tabular feature, improvements to come

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 53164)
+++ tiki.sql	(revision 53165)
@@ -3837,3 +3837,11 @@
   PRIMARY KEY (`addon`,`version`,`profile`)
 ) ENGINE=MyISAM;
 
+DROP TABLE IF EXISTS `tiki_tabular_formats`;
+CREATE TABLE `tiki_tabular_formats` (
+	`tabularId` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
+	`trackerId` INT NOT NULL,
+	`name` VARCHAR(30) NOT NULL,
+	`format_descriptor` TEXT,
+	KEY `tabular_tracker_ix` (`trackerId`)
+);

------------------------------------------------------------------------
r53044 | xavidp | 2014-11-10 09:53:19 -0400 (seg, 10 nov 2014) | 1 line

[FIX]Missing parts to have consistent naming in installs and upgrades, and with the most agreeed wording. Option Panels is set with a space in purpose, in order to have it shown in the first position under "Configuration" section of the menu.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 53043)
+++ tiki.sql	(revision 53044)
@@ -1448,7 +1448,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_edit_menu','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_clean_cache','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_admin_modules','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Configuration Panels','tiki-admin.php',1051,'','tiki_p_admin','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o',' Panels','tiki-admin.php',1051,'','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Live Support','tiki-live_support_admin.php',1055,'feature_live_support','tiki_p_live_support_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Live Support','tiki-live_support_admin.php',1055,'feature_live_support','user_is_operator','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Banning','tiki-admin_banning.php',1060,'feature_banning','tiki_p_admin_banning','',0);

------------------------------------------------------------------------
r53014 | xavidp | 2014-11-06 17:03:01 -0400 (qui, 06 nov 2014) | 1 line

[MOD]Renaming of 'Admin Home' (and equivalent) with 'Configuration Panels' (and equivalent), as dicussed in the devel list months ago and indicated with more people for the change (or indiferent) than against it as shown here: http://dev.tiki.org/Tiki14 . Thanks to those who voted and proposed alternative naming in time.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 53013)
+++ tiki.sql	(revision 53014)
@@ -1425,30 +1425,30 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','Newsletters','tiki-newsletters.php',900,'feature_newsletters','tiki_p_list_newsletters','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Send Newsletters','tiki-send_newsletters.php',905,'feature_newsletters','tiki_p_send_newsletters','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Admin Newsletters','tiki-admin_newsletters.php',910,'feature_newsletters','tiki_p_admin_newsletters','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'','tiki_p_admin','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'','tiki_p_admin_categories','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'','tiki_p_admin_banners','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'','tiki_p_edit_templates','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'','tiki_p_edit_cookies','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'','tiki_p_admin_dynamic','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'','tiki_p_admin_mailin','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'','tiki_p_edit_content_templates','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'','tiki_p_edit_html_pages','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'','tiki_p_view_referer_stats','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'','tiki_p_admin_shoutbox','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'','tiki_p_live_support_admin','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'','user_is_operator','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'feature_integrator','tiki_p_admin_integrator','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'feature_edit_templates','tiki_p_edit_templates','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'feature_view_tpl','tiki_p_edit_templates','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'feature_editcss','tiki_p_create_css','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'','tiki_p_admin_contribution','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'','tiki_p_admin_users','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'','tiki_p_admin_toolbars','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'','tiki_p_edit_menu','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'','tiki_p_clean_cache','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'','tiki_p_admin_modules','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Admin Home','tiki-admin.php',1051,'','tiki_p_admin','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_admin','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_admin_categories','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_admin_banners','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_edit_templates','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_edit_cookies','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_admin_dynamic','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_admin_mailin','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_edit_content_templates','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_edit_html_pages','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_view_referer_stats','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_admin_shoutbox','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_live_support_admin','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','user_is_operator','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'feature_integrator','tiki_p_admin_integrator','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'feature_edit_templates','tiki_p_edit_templates','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'feature_view_tpl','tiki_p_edit_templates','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'feature_editcss','tiki_p_create_css','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_admin_contribution','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_admin_users','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_admin_toolbars','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_edit_menu','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_clean_cache','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Configuration','tiki-admin.php',1050,'','tiki_p_admin_modules','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Configuration Panels','tiki-admin.php',1051,'','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Live Support','tiki-live_support_admin.php',1055,'feature_live_support','tiki_p_live_support_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Live Support','tiki-live_support_admin.php',1055,'feature_live_support','user_is_operator','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Banning','tiki-admin_banning.php',1060,'feature_banning','tiki_p_admin_banning','',0);
@@ -3194,7 +3194,7 @@
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-list_file_gallery.php\\?galleryId=(\\d+)', 'file$1', 'file gallery', 'feature_file_galleries', 200);
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-user_information.php\\?userId=(\\d+)','user$1', '', '', 200);
 
-UPDATE tiki_menu_options SET icon = 'icon-configuration48x48' WHERE name = 'Admin';
+UPDATE tiki_menu_options SET icon = 'icon-configuration48x48' WHERE name = 'Configuration';
 UPDATE tiki_menu_options SET icon = 'xfce4-appfinder48x48' WHERE name = 'Search';
 UPDATE tiki_menu_options SET icon = 'wikipages48x48' WHERE name = 'Wiki';
 UPDATE tiki_menu_options SET icon = 'blogs48x48' WHERE name = 'Blogs';

------------------------------------------------------------------------
r52519 | nkoth | 2014-09-15 01:02:29 -0400 (seg, 15 set 2014) | 2 lines

[NEW] The rest of the Tiki Addons feature (for now).


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 52518)
+++ tiki.sql	(revision 52519)
@@ -3827,3 +3827,13 @@
 	`user` VARCHAR(200) NOT NULL,
 	`groups` BLOB NOT NULL
 ) ENGINE=MyISAM;
+
+DROP TABLE IF EXISTS `tiki_addon_profiles`;
+CREATE TABLE `tiki_addon_profiles` (
+  `addon` VARCHAR(100),
+  `version` VARCHAR(100),
+  `profile` VARCHAR(100),
+  `install_date` TIMESTAMP,
+  PRIMARY KEY (`addon`,`version`,`profile`)
+) ENGINE=MyISAM;
+

------------------------------------------------------------------------
r51860 | lphuberdeau | 2014-07-05 13:00:36 -0400 (sÃ¡b, 05 jul 2014) | 1 line

[NEW] Allow to change the URL scheme for wiki pages, currently to replace spaces with underscores

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 51859)
+++ tiki.sql	(revision 51860)
@@ -1648,6 +1648,7 @@
 CREATE TABLE `tiki_pages` (
   `page_id` int(14) NOT NULL auto_increment,
   `pageName` varchar(160) NOT NULL default '',
+  `pageSlug` varchar(160) NULL,
   `hits` int(8) default NULL,
   `data` mediumtext,
   `description` varchar(200) default NULL,
@@ -1676,6 +1677,7 @@
   `keywords` TEXT,
   PRIMARY KEY (`page_id`),
   UNIQUE KEY `pageName` (`pageName`),
+  UNIQUE KEY `pageSlug` (`pageSlug`),
   KEY `data` (`data`(255)),
   KEY `pageRank` (`pageRank`),
   KEY `lastModif`(`lastModif`)

------------------------------------------------------------------------
r51737 | lphuberdeau | 2014-06-25 12:07:31 -0400 (qua, 25 jun 2014) | 1 line

[MRG] Automatic merge, branches/13.x 51732 to 51736

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 51736)
+++ tiki.sql	(revision 51737)
@@ -2140,8 +2140,8 @@
   `options` text,
   `type` char(1) default NULL,
   `position` int(5) default NULL,
-  `votes` int(10) default NULL,
-  `value` int(10) default NULL,
+  `votes` int(10) default 0,
+  `value` int(10) default 0,
   `average` decimal(4,2) default NULL,
   `mandatory` char(1) NOT NULL default 'n',
   `max_answers` int(5) NOT NULL default 0,

------------------------------------------------------------------------
r51204 | nkoth | 2014-05-09 18:59:53 -0400 (sex, 09 mai 2014) | 2 lines

[FIX] Missing db column needed in recent new feature


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 51203)
+++ tiki.sql	(revision 51204)
@@ -3373,6 +3373,7 @@
     `author` VARCHAR(255),
     `description` TEXT,
     `content` TEXT,
+    `categories` TEXT,
     KEY `tiki_rss_items_rss` (`rssId`),
     KEY `tiki_rss_items_item` (`rssId`, `guid`(200))
 ) ENGINE=MyISAM;

------------------------------------------------------------------------
r50991 | lphuberdeau | 2014-04-25 08:50:30 -0400 (sex, 25 abr 2014) | 1 line

[FIX] These were missing from the tiki.sql file?

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 50990)
+++ tiki.sql	(revision 50991)
@@ -3798,3 +3798,29 @@
   `version` int(8) NOT NULL default '0',
   `outputId` INT NOT NULL PRIMARY KEY AUTO_INCREMENT
 ) ENGINE=MyISAM AUTO_INCREMENT=1;
+
+DROP TABLE IF EXISTS `tiki_goals`;
+CREATE TABLE `tiki_goals` (
+	`goalId` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
+	`name` VARCHAR(50) NOT NULL,
+	`type` VARCHAR(10) NOT NULL DEFAULT 'user',
+	`description` TEXT,
+	`enabled` INT NOT NULL DEFAULT 0,
+	`daySpan` INT NOT NULL DEFAULT 14,
+	`from` DATETIME,
+	`to` DATETIME,
+	`eligible` BLOB,
+	`conditions` BLOB,
+	`rewards` BLOB
+) ENGINE=MyISAM;
+
+DROP TABLE IF EXISTS `tiki_goal_events`;
+CREATE TABLE `tiki_goal_events` (
+	`eventId` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
+	`eventDate` INT NOT NULL,
+	`eventType` VARCHAR(50) NOT NULL,
+	`targetType` VARCHAR(50),
+	`targetObject` VARCHAR(255),
+	`user` VARCHAR(200) NOT NULL,
+	`groups` BLOB NOT NULL
+) ENGINE=MyISAM;

------------------------------------------------------------------------
r50981 | nkoth | 2014-04-24 15:35:49 -0400 (qui, 24 abr 2014) | 1 line

[KIL] Metrics Dashboard which was never used/too complicated experimental feature

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 50980)
+++ tiki.sql	(revision 50981)
@@ -3305,39 +3305,6 @@
     KEY `tiki_auth_tokens_token` (`token`)
 ) ENGINE=MyISAM;
 
-DROP TABLE IF EXISTS `metrics_assigned`;
-CREATE TABLE `metrics_assigned` (
-    `assigned_id` int(11) NOT NULL AUTO_INCREMENT,
-    `metric_id` int(11) NOT NULL,
-    `tab_id` int(11) NOT NULL,
-    PRIMARY KEY (`assigned_id`),
-    KEY `metric_id` (`metric_id`),
-    KEY `tab_id` (`tab_id`)
-) ENGINE=MyISAM;
-
-DROP TABLE IF EXISTS `metrics_metric`;
-CREATE TABLE `metrics_metric` (
-    `metric_id` int(11) NOT NULL AUTO_INCREMENT,
-    `metric_name` varchar(255) NOT NULL,
-    `metric_range` varchar(1) NOT NULL DEFAULT '+' COMMENT 'values: + (daily), @ (monthly&weekly), - (weekly)',
-    `metric_datatype` varchar(1) NOT NULL DEFAULT 'i' COMMENT 'values: i(nteger), %(percentage), f(loat), L(ist)',
-    `metric_lastupdate` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    `metric_query` text,
-    `metric_dsn` VARCHAR(200) NOT NULL DEFAULT 'local',
-    PRIMARY KEY (`metric_id`),
-    UNIQUE KEY `metric_name` (`metric_name`)
-) ENGINE=MyISAM;
-
-DROP TABLE IF EXISTS `metrics_tab`;
-CREATE TABLE `metrics_tab` (
-    `tab_id` int(11) NOT NULL AUTO_INCREMENT,
-    `tab_name` varchar(255) NOT NULL,
-    `tab_order` int(11) NOT NULL DEFAULT '0',
-    `tab_content` longtext NOT NULL,
-    PRIMARY KEY (`tab_id`),
-    UNIQUE KEY `tab_name` (`tab_name`)
-) ENGINE=MyISAM;
-
 DROP TABLE IF EXISTS `tiki_file_backlinks`;
 CREATE TABLE `tiki_file_backlinks` (
        `fileId` int(14) NOT NULL,

------------------------------------------------------------------------
r50738 | lphuberdeau | 2014-04-10 12:46:11 -0400 (qui, 10 abr 2014) | 1 line

[FIX] Field added by 20140301_add_column_rating_choice_topic_on_forums_tiki.sql, but not included in tiki.sql

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 50737)
+++ tiki.sql	(revision 50738)
@@ -916,6 +916,7 @@
   `inbound_pop_password` varchar(80) default NULL,
   `topic_smileys` char(1) default NULL,
   `ui_avatar` char(1) default NULL,
+  `ui_rating_choice_topic` char(1) DEFAULT NULL,
   `ui_flag` char(1) default NULL,
   `ui_posts` char(1) default NULL,
   `ui_email` char(1) default NULL,
@@ -3829,4 +3830,4 @@
   `outputType` varchar(32) NOT NULL default '',
   `version` int(8) NOT NULL default '0',
   `outputId` INT NOT NULL PRIMARY KEY AUTO_INCREMENT
-) ENGINE=MyISAM AUTO_INCREMENT=1;
\ No newline at end of file
+) ENGINE=MyISAM AUTO_INCREMENT=1;

------------------------------------------------------------------------
r50653 | robertplummer | 2014-04-03 12:53:32 -0400 (qui, 03 abr 2014) | 1 line

[MRG] Merge wikiLingo experimental branch with trunk... the fun begins

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 50652)
+++ tiki.sql	(revision 50653)
@@ -3822,28 +3822,11 @@
 	UNIQUE `event_target_uq` (`event`, `target`, `userId`)
 ) ENGINE=MyISAM;
 
-DROP TABLE IF EXISTS `tiki_goals`;
-CREATE TABLE `tiki_goals` (
-	`goalId` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
-	`name` VARCHAR(50) NOT NULL,
-	`type` VARCHAR(10) NOT NULL DEFAULT 'user',
-	`description` TEXT,
-	`enabled` INT NOT NULL DEFAULT 0,
-	`daySpan` INT NOT NULL DEFAULT 14,
-	`from` DATETIME,
-	`to` DATETIME,
-	`eligible` BLOB,
-	`conditions` BLOB,
-	`rewards` BLOB
-) ENGINE=MyISAM;
-
-DROP TABLE IF EXISTS `tiki_goal_events`;
-CREATE TABLE `tiki_goal_events` (
-	`eventId` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
-	`eventDate` INT NOT NULL,
-	`eventType` VARCHAR(50) NOT NULL,
-	`targetType` VARCHAR(50),
-	`targetObject` VARCHAR(255),
-	`user` VARCHAR(200) NOT NULL,
-	`groups` BLOB NOT NULL
-) ENGINE=MyISAM;
+DROP TABLE IF EXISTS `tiki_output`;
+CREATE TABLE `tiki_output` (
+  `entityId` varchar(160) NOT NULL default '',
+  `objectType` varchar(32) NOT NULL default '',
+  `outputType` varchar(32) NOT NULL default '',
+  `version` int(8) NOT NULL default '0',
+  `outputId` INT NOT NULL PRIMARY KEY AUTO_INCREMENT
+) ENGINE=MyISAM AUTO_INCREMENT=1;
\ No newline at end of file

------------------------------------------------------------------------
r50637 | lphuberdeau | 2014-04-02 17:07:49 -0400 (qua, 02 abr 2014) | 1 line

[MOD] Adding support for IMAP accounts

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 50636)
+++ tiki.sql	(revision 50637)
@@ -1263,7 +1263,8 @@
   `accountId` int(12) NOT NULL auto_increment,
   `user` varchar(200) NOT NULL default '',
   `account` varchar(50) NOT NULL default '',
-  `pop` varchar(255) default NULL,
+  `protocol` varchar(10) NOT NULL DEFAULT 'pop',
+  `host` varchar(255) default NULL,
   `port` int(4) default NULL,
   `username` varchar(100) default NULL,
   `pass` varchar(100) default NULL,

------------------------------------------------------------------------
r50627 | lphuberdeau | 2014-04-02 15:03:20 -0400 (qua, 02 abr 2014) | 1 line

[MOD] Add pre-auth/capture support for israelpost payment gateway

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 50626)
+++ tiki.sql	(revision 50627)
@@ -3352,6 +3352,7 @@
     `currency` CHAR(3) NOT NULL,
     `request_date` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
     `due_date` TIMESTAMP NOT NULL,
+	`authorized_until` TIMESTAMP NULL,
     `cancel_date` TIMESTAMP NULL,
     `description` VARCHAR(100) NOT NULL,
     `actions` TEXT,
@@ -3367,6 +3368,7 @@
     `payment_date` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
     `amount` DECIMAL(7,2),
     `type` VARCHAR(15),
+	`status` VARCHAR(15) NOT NULL DEFAULT 'paid',
     `details` TEXT,
     `userId` int(8),
     PRIMARY KEY(`paymentReceivedId`),

------------------------------------------------------------------------
r50616 | lphuberdeau | 2014-04-02 08:58:25 -0400 (qua, 02 abr 2014) | 1 line

[MOD] Remove SMTP parameters on mail-in as they were not being used after all

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 50615)
+++ tiki.sql	(revision 50616)
@@ -1269,9 +1269,6 @@
   `pass` varchar(100) default NULL,
   `active` char(1) default NULL,
   `type` varchar(40) default NULL,
-  `smtp` varchar(255) default NULL,
-  `useAuth` char(1) default NULL,
-  `smtpPort` int(4) default NULL,
   `anonymous` char(1) NOT NULL default 'y',
   `admin` char(1) NOT NULL default 'y',
   `attachments` char(1) NOT NULL default 'n',

------------------------------------------------------------------------
r50401 | lphuberdeau | 2014-03-20 11:55:51 -0400 (qui, 20 mar 2014) | 1 line

[FIX] Syntax errors in SQL

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 50400)
+++ tiki.sql	(revision 50401)
@@ -3832,8 +3832,8 @@
 	`daySpan` INT NOT NULL DEFAULT 14,
 	`from` DATETIME,
 	`to` DATETIME,
-	`eligible`,
-	`conditions`,
+	`eligible` BLOB,
+	`conditions` BLOB,
 	`rewards` BLOB
 ) ENGINE=MyISAM;
 

------------------------------------------------------------------------
r50374 | jonnybradley | 2014-03-18 13:40:24 -0400 (ter, 18 mar 2014) | 1 line

[MRG] Automatic merge, branches/12.x 50369 to 50373

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 50373)
+++ tiki.sql	(revision 50374)
@@ -1324,7 +1324,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Users Map','tiki-gmap_usermap.php',36,'feature_gmap','','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Tiki Calendar','tiki-action_calendar.php',37,'feature_action_calendar','tiki_p_view_tiki_calendar','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','(debug)','javascript:toggle(\'debugconsole\')',40,'feature_debug_console','tiki_p_admin','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','User Wizard','tiki-wizard_user.php',45,'feature_wizard_user','','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','User Wizard','tiki-wizard_user.php',45,'feature_wizard_user','','Registered',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','MyTiki','tiki-my_tiki.php',50,'feature_mytiki','','Registered',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','MyTiki Home','tiki-my_tiki.php',51,'feature_mytiki','','Registered',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Preferences','tiki-user_preferences.php',55,'feature_mytiki,feature_userPreferences','','Registered',0);

------------------------------------------------------------------------
r49968 | lphuberdeau | 2014-02-19 14:03:25 -0400 (qua, 19 fev 2014) | 1 line

[MOD] Keep track of goals reached

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 49967)
+++ tiki.sql	(revision 49968)
@@ -3842,6 +3842,8 @@
 	`eventId` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
 	`eventDate` INT NOT NULL,
 	`eventType` VARCHAR(50) NOT NULL,
+	`targetType` VARCHAR(50),
+	`targetObject` VARCHAR(255),
 	`user` VARCHAR(200) NOT NULL,
 	`groups` BLOB NOT NULL
 ) ENGINE=MyISAM;

------------------------------------------------------------------------
r49965 | lphuberdeau | 2014-02-19 11:12:33 -0400 (qua, 19 fev 2014) | 1 line

[MOD] Goal events stored separately to simplify usage and reduce database size, also avoids double-entries if activities are stored multiple time through various paths

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 49964)
+++ tiki.sql	(revision 49965)
@@ -3837,3 +3837,11 @@
 	`rewards` BLOB
 ) ENGINE=MyISAM;
 
+DROP TABLE IF EXISTS `tiki_goal_events`;
+CREATE TABLE `tiki_goal_events` (
+	`eventId` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
+	`eventDate` INT NOT NULL,
+	`eventType` VARCHAR(50) NOT NULL,
+	`user` VARCHAR(200) NOT NULL,
+	`groups` BLOB NOT NULL
+) ENGINE=MyISAM;

------------------------------------------------------------------------
r49892 | lphuberdeau | 2014-02-14 17:59:05 -0400 (sex, 14 fev 2014) | 1 line

[MOD] Basic management interfaces for goals (work in progress)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 49891)
+++ tiki.sql	(revision 49892)
@@ -3822,3 +3822,18 @@
 	UNIQUE `event_target_uq` (`event`, `target`, `userId`)
 ) ENGINE=MyISAM;
 
+DROP TABLE IF EXISTS `tiki_goals`;
+CREATE TABLE `tiki_goals` (
+	`goalId` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
+	`name` VARCHAR(50) NOT NULL,
+	`type` VARCHAR(10) NOT NULL DEFAULT 'user',
+	`description` TEXT,
+	`enabled` INT NOT NULL DEFAULT 0,
+	`daySpan` INT NOT NULL DEFAULT 14,
+	`from` DATETIME,
+	`to` DATETIME,
+	`eligible`,
+	`conditions`,
+	`rewards` BLOB
+) ENGINE=MyISAM;
+

------------------------------------------------------------------------
r49810 | jonnybradley | 2014-02-10 15:55:37 -0400 (seg, 10 fev 2014) | 5 lines

[MRG] Automatic merge, branches/12.x 49795 to 49808
Conflicts fixed manually
	lib/prefs/feature.php (fixed itself, huh?)
	templates/modules/mod-cart.tpl (restored some curiously deleted <td>s too?)


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 49809)
+++ tiki.sql	(revision 49810)
@@ -1324,7 +1324,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Users Map','tiki-gmap_usermap.php',36,'feature_gmap','','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Tiki Calendar','tiki-action_calendar.php',37,'feature_action_calendar','tiki_p_view_tiki_calendar','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','(debug)','javascript:toggle(\'debugconsole\')',40,'feature_debug_console','tiki_p_admin','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','User Wizard','tiki-wizard_user.php',45,'','','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','User Wizard','tiki-wizard_user.php',45,'feature_wizard_user','','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','MyTiki','tiki-my_tiki.php',50,'feature_mytiki','','Registered',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','MyTiki Home','tiki-my_tiki.php',51,'feature_mytiki','','Registered',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Preferences','tiki-user_preferences.php',55,'feature_mytiki,feature_userPreferences','','Registered',0);

------------------------------------------------------------------------
r49689 | xavidp | 2014-02-04 05:04:34 -0400 (ter, 04 fev 2014) | 11 lines

[MRG] Automatic merge, branches/12.x 49678 to 49687
Conflicts in the following files were resolved manually:
'./templates/wiki-plugins/wikiplugin_addtocart.tpl'
'./templates/wizard/wizard_bar_user.tpl'
'./templates/wizard/user_preferences_notifications.tpl'
'./templates/wizard/user_preferences_info.tpl'
'./templates/wizard/user_wizard.tpl'
'./templates/wizard/user_preferences_params.tpl'
'./templates/wizard/user_preferences_reports.tpl'



Index: tiki.sql
===================================================================
--- tiki.sql	(revision 49688)
+++ tiki.sql	(revision 49689)
@@ -1324,6 +1324,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Users Map','tiki-gmap_usermap.php',36,'feature_gmap','','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Tiki Calendar','tiki-action_calendar.php',37,'feature_action_calendar','tiki_p_view_tiki_calendar','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','(debug)','javascript:toggle(\'debugconsole\')',40,'feature_debug_console','tiki_p_admin','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','User Wizard','tiki-wizard_user.php',45,'','','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','MyTiki','tiki-my_tiki.php',50,'feature_mytiki','','Registered',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','MyTiki Home','tiki-my_tiki.php',51,'feature_mytiki','','Registered',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Preferences','tiki-user_preferences.php',55,'feature_mytiki,feature_userPreferences','','Registered',0);
@@ -3224,6 +3225,7 @@
 UPDATE tiki_menu_options SET icon = 'debug48x48' WHERE name = '(debug)';
 UPDATE tiki_menu_options SET icon = 'kaltura48x48' WHERE name = 'Kaltura Video';
 UPDATE tiki_menu_options SET icon = 'tikicalendar48x48' WHERE name = 'Tiki Calendar';
+UPDATE tiki_menu_options SET icon = 'wizard_user48x48' WHERE name = 'User Wizard';
 UPDATE tiki_menus SET use_items_icons='y' WHERE `menuId`=42;
 
 DROP TABLE IF EXISTS `tiki_plugin_security`;

------------------------------------------------------------------------
r49630 | lphuberdeau | 2014-01-29 18:06:18 -0400 (qua, 29 jan 2014) | 1 line

[MOD]Â Add support for translation-related notifications

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 49629)
+++ tiki.sql	(revision 49630)
@@ -3815,7 +3815,7 @@
 	`userId` INT NOT NULL,
 	`event` VARCHAR(50) NOT NULL,
 	`priority` VARCHAR(10) NOT NULL,
-	`target` VARCHAR(15) NOT NULL,
+	`target` VARCHAR(25) NOT NULL,
 	INDEX `userid_target_ix` (`userId`, `target`),
 	UNIQUE `event_target_uq` (`event`, `target`, `userId`)
 ) ENGINE=MyISAM;

------------------------------------------------------------------------
r49493 | arildb | 2014-01-22 14:42:28 -0400 (qua, 22 jan 2014) | 1 line

[FIX] database error. longblob cannot have a default value

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 49492)
+++ tiki.sql	(revision 49493)
@@ -2000,7 +2000,7 @@
   `className` varchar(64) default NULL,
   `parseValues` char( 1 ) NOT NULL default 'n',
   `clonedSheetId` int(8) NULL,
-  `metadata` longblob default '',
+  `metadata` longblob,
   UNIQUE KEY `sheetId` (`sheetId`, `begin`)
 ) ENGINE=MyISAM;
 

------------------------------------------------------------------------
r49447 | lphuberdeau | 2014-01-17 17:30:51 -0400 (sex, 17 jan 2014) | 1 line

[NEW] New table for notification revamp and management interface

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 49446)
+++ tiki.sql	(revision 49447)
@@ -3796,6 +3796,7 @@
    PRIMARY KEY (`mailin_struct_id`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1;
 
+DROP TABLE IF EXISTS `tiki_search_queries`;
 CREATE TABLE `tiki_search_queries` (
 	`queryId` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
 	`userId` INT NOT NULL,
@@ -3807,3 +3808,15 @@
 	INDEX `query_userId` (`userId`),
 	UNIQUE KEY `tiki_user_query_uq` (`userId`, `label`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1;
+
+DROP TABLE IF EXISTS `tiki_user_monitors`;
+CREATE TABLE `tiki_user_monitors` (
+	`monitorId` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
+	`userId` INT NOT NULL,
+	`event` VARCHAR(50) NOT NULL,
+	`priority` VARCHAR(10) NOT NULL,
+	`target` VARCHAR(15) NOT NULL,
+	INDEX `userid_target_ix` (`userId`, `target`),
+	UNIQUE `event_target_uq` (`event`, `target`, `userId`)
+) ENGINE=MyISAM;
+

------------------------------------------------------------------------
r49351 | lphuberdeau | 2014-01-09 12:05:42 -0400 (qui, 09 jan 2014) | 1 line

[MOD] Adding unique key constraint on stored query labels, adding description field

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 49350)
+++ tiki.sql	(revision 49351)
@@ -3803,5 +3803,7 @@
 	`label` VARCHAR(100) NOT NULL,
 	`priority` VARCHAR(15) NOT NULL,
 	`query` BLOB,
-	INDEX `query_userId` (`userId`)
+	`description` TEXT,
+	INDEX `query_userId` (`userId`),
+	UNIQUE KEY `tiki_user_query_uq` (`userId`, `label`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1;

------------------------------------------------------------------------
r49290 | robertplummer | 2013-12-31 17:06:33 -0400 (ter, 31 dez 2013) | 1 line

[FIX] Sheet now working with 3.1 rc5

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 49289)
+++ tiki.sql	(revision 49290)
@@ -2000,6 +2000,7 @@
   `className` varchar(64) default NULL,
   `parseValues` char( 1 ) NOT NULL default 'n',
   `clonedSheetId` int(8) NULL,
+  `metadata` longblob default '',
   UNIQUE KEY `sheetId` (`sheetId`, `begin`)
 ) ENGINE=MyISAM;
 

------------------------------------------------------------------------
r49174 | lphuberdeau | 2013-12-19 14:34:03 -0400 (qui, 19 dez 2013) | 1 line

[NEW] Storing search queries in the database

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 49173)
+++ tiki.sql	(revision 49174)
@@ -3794,3 +3794,13 @@
 	`is_active` char(1) NULL DEFAULT 'n',
    PRIMARY KEY (`mailin_struct_id`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1;
+
+CREATE TABLE `tiki_search_queries` (
+	`queryId` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
+	`userId` INT NOT NULL,
+	`lastModif` INT,
+	`label` VARCHAR(100) NOT NULL,
+	`priority` VARCHAR(15) NOT NULL,
+	`query` BLOB,
+	INDEX `query_userId` (`userId`)
+) ENGINE=MyISAM AUTO_INCREMENT=1;

------------------------------------------------------------------------
r48387 | jonnybradley | 2013-11-11 06:58:59 -0400 (seg, 11 nov 2013) | 1 line

[MRG] Automatic merge, branches/12.x 48369 to 48386

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 48386)
+++ tiki.sql	(revision 48387)
@@ -2795,6 +2795,7 @@
   event varchar(40) NOT NULL default '',
   score int(11) NOT NULL default '0',
   expiration int(11) NOT NULL default '0',
+  validObjectIds text,
   PRIMARY KEY (`event`)
 ) ENGINE=MyISAM;
 

------------------------------------------------------------------------
r48376 | lindonb | 2013-11-09 15:09:42 -0400 (sÃ¡b, 09 nov 2013) | 1 line

[MRG] Automatic merge, branches/12.x 48325 to 48369

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 48375)
+++ tiki.sql	(revision 48376)
@@ -1333,6 +1333,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Modules','tiki-user_assigned_modules.php',75,'feature_mytiki,user_assigned_modules','tiki_p_configure_modules','Registered',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Webmail','tiki-webmail.php',85,'feature_mytiki,feature_webmail','tiki_p_use_webmail','Registered',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Contacts','tiki-contacts.php',87,'feature_mytiki,feature_contacts','','Registered',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Mail-in','tiki-user_mailin.php',88,'feature_mytiki,feature_mailin','','Registered',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Notepad','tiki-notepad_list.php',90,'feature_mytiki,feature_notepad','tiki_p_notepad','Registered',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','My Files','tiki-userfiles.php',95,'feature_mytiki,feature_userfiles','tiki_p_userfiles','Registered',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','User Menu','tiki-usermenu.php',100,'feature_mytiki,feature_usermenu','tiki_p_usermenu','Registered',0);

------------------------------------------------------------------------
r47940 | xavidp | 2013-10-09 14:18:47 -0400 (qua, 09 out 2013) | 1 line

[FIX]Add a few more missing icons. Also lgpl'd from http://commons.wikimedia.org/wiki/Crystal_Clear , except kaltura, which was there in the tiki file tree already. Thanks jonnyb.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 47939)
+++ tiki.sql	(revision 47940)
@@ -3216,6 +3216,11 @@
 UPDATE tiki_menu_options SET icon = 'surveys48x48' WHERE name = 'Surveys';
 UPDATE tiki_menu_options SET icon = 'spreadsheet48x48' WHERE name = 'Spreadsheets';
 UPDATE tiki_menu_options SET icon = 'timesheet48x48' WHERE name = 'Timesheet';
+UPDATE tiki_menu_options SET icon = 'usersmap48x48' WHERE name = 'Users Map';
+UPDATE tiki_menu_options SET icon = 'contactus48x48' WHERE name = 'Contact Us';
+UPDATE tiki_menu_options SET icon = 'debug48x48' WHERE name = '(debug)';
+UPDATE tiki_menu_options SET icon = 'kaltura48x48' WHERE name = 'Kaltura Video';
+UPDATE tiki_menu_options SET icon = 'tikicalendar48x48' WHERE name = 'Tiki Calendar';
 UPDATE tiki_menus SET use_items_icons='y' WHERE `menuId`=42;
 
 DROP TABLE IF EXISTS `tiki_plugin_security`;

------------------------------------------------------------------------
r47913 | xavidp | 2013-10-07 13:50:15 -0400 (seg, 07 out 2013) | 1 line

[FIX]Add default icons for the menu entries that had an icon missing. Improvable for sure, but better than current case (question mark for those menu items). Lgpl'd from the crystal clear icon set - http://commons.wikimedia.org/wiki/Crystal_Clear

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 47912)
+++ tiki.sql	(revision 47913)
@@ -3205,10 +3205,17 @@
 UPDATE tiki_menu_options SET icon = 'vcard48x48' WHERE name = 'Freetags';
 UPDATE tiki_menu_options SET icon = 'date48x48' WHERE name = 'Calendar' AND url = 'tiki-calendar.php';
 UPDATE tiki_menu_options SET icon = 'userfiles48x48' WHERE name = 'MyTiki';
-UPDATE tiki_menu_options SET icon = '' WHERE name = 'Quizzes';
-UPDATE tiki_menu_options SET icon = '' WHERE name = 'Surveys';
-UPDATE tiki_menu_options SET icon = '' WHERE name = 'TikiSheet';
-UPDATE tiki_menu_options SET icon = '' WHERE name = 'Workflow';
+UPDATE tiki_menu_options SET icon = 'home48x48' WHERE name = 'Home';
+UPDATE tiki_menu_options SET icon = 'categories48x48' WHERE name = 'Categories';
+UPDATE tiki_menu_options SET icon = 'accounting48x48' WHERE name = 'Accounting';
+UPDATE tiki_menu_options SET icon = 'directory48x48' WHERE name = 'Directory';
+UPDATE tiki_menu_options SET icon = 'invoice48x48' WHERE name = 'Invoice';
+UPDATE tiki_menu_options SET icon = 'quizzes48x48' WHERE name = 'Quizzes';
+UPDATE tiki_menu_options SET icon = 'reports48x48' WHERE name = 'Reports';
+UPDATE tiki_menu_options SET icon = 'stats48x48' WHERE name = 'Stats';
+UPDATE tiki_menu_options SET icon = 'surveys48x48' WHERE name = 'Surveys';
+UPDATE tiki_menu_options SET icon = 'spreadsheet48x48' WHERE name = 'Spreadsheets';
+UPDATE tiki_menu_options SET icon = 'timesheet48x48' WHERE name = 'Timesheet';
 UPDATE tiki_menus SET use_items_icons='y' WHERE `menuId`=42;
 
 DROP TABLE IF EXISTS `tiki_plugin_security`;

------------------------------------------------------------------------
r46910 | lphuberdeau | 2013-07-30 09:15:22 -0400 (ter, 30 jul 2013) | 1 line

[KIL] Removing most of the old friendship feature (with intention of adding back once bases are established), converting dedicated tables to relations - using the 'follow' model as it seems to be what was in place

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 46909)
+++ tiki.sql	(revision 46910)
@@ -2789,21 +2789,6 @@
   KEY `traId` ( `traId` )
 ) ENGINE=MyISAM AUTO_INCREMENT=1;
 
-DROP TABLE IF EXISTS `tiki_friends`;
-CREATE TABLE `tiki_friends` (
-  `user` varchar(200) NOT NULL default '',
-  `friend` varchar(200) NOT NULL default '',
-  PRIMARY KEY (`user`(120),friend(120))
-) ENGINE=MyISAM;
-
-DROP TABLE IF EXISTS `tiki_friendship_requests`;
-CREATE TABLE `tiki_friendship_requests` (
-  `userFrom` varchar(200) NOT NULL default '',
-  `userTo` varchar(200) NOT NULL default '',
-  `tstamp` timestamp NOT NULL,
-  PRIMARY KEY (`userFrom`(120),`userTo`(120))
-) ENGINE=MyISAM;
-
 DROP TABLE IF EXISTS `tiki_score`;
 CREATE TABLE `tiki_score` (
   event varchar(40) NOT NULL default '',

------------------------------------------------------------------------
r46703 | lphuberdeau | 2013-07-15 17:08:11 -0400 (seg, 15 jul 2013) | 1 line

[NEW] Adding a basic interface to manage the custom event rules (skeleton)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 46702)
+++ tiki.sql	(revision 46703)
@@ -117,6 +117,16 @@
   PRIMARY KEY(`field_name`)
 ) ENGINE=MyISAM;
 
+DROP TABLE IF EXISTS `tiki_activity_stream_rules`;
+CREATE TABLE `tiki_activity_stream_rules` (
+  `ruleId` int(8) NOT NULL auto_increment,
+  `eventType` varchar(100) NOT NULL,
+  `ruleType` varchar(20) NOT NULL,
+  `rule` TEXT,
+  `notes` TEXT,
+  PRIMARY KEY(`ruleId`)
+) ENGINE=MyISAM;
+
 DROP TABLE IF EXISTS `tiki_articles`;
 CREATE TABLE `tiki_articles` (
   `articleId` int(8) NOT NULL auto_increment,

------------------------------------------------------------------------
r46558 | lphuberdeau | 2013-07-05 13:50:18 -0400 (sex, 05 jul 2013) | 1 line

[NEW] Adding core functionality to support event recording

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 46557)
+++ tiki.sql	(revision 46558)
@@ -101,6 +101,22 @@
   KEY `nameValue` (`name`, `value`(200))
 ) ENGINE=MyISAM;
 
+DROP TABLE IF EXISTS `tiki_activity_stream`;
+CREATE TABLE `tiki_activity_stream` (
+  `activityId` int(8) NOT NULL auto_increment,
+  `eventType` varchar(100) NOT NULL,
+  `eventDate` int NOT NULL,
+  `arguments` BLOB,
+  PRIMARY KEY(`activityId`)
+) ENGINE=MyISAM;
+
+DROP TABLE IF EXISTS `tiki_activity_stream_mapping`;
+CREATE TABLE `tiki_activity_stream_mapping` (
+  `field_name` varchar(50) NOT NULL,
+  `field_type` varchar(15) NOT NULL,
+  PRIMARY KEY(`field_name`)
+) ENGINE=MyISAM;
+
 DROP TABLE IF EXISTS `tiki_articles`;
 CREATE TABLE `tiki_articles` (
   `articleId` int(8) NOT NULL auto_increment,

------------------------------------------------------------------------
r46540 | sylvieg | 2013-07-04 10:05:04 -0400 (qui, 04 jul 2013) | 1 line

[ENH]increase category name size

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 46539)
+++ tiki.sql	(revision 46540)
@@ -435,7 +435,7 @@
 DROP TABLE IF EXISTS `tiki_categories`;
 CREATE TABLE `tiki_categories` (
   `categId` int(12) NOT NULL auto_increment,
-  `name` varchar(100) default NULL,
+  `name` varchar(200) default NULL,
   `description` varchar(250) default NULL,
   `parentId` int(12) default NULL,
   `rootId` int NOT NULL DEFAULT 0,

------------------------------------------------------------------------
r46433 | arildb | 2013-06-23 20:51:18 -0400 (dom, 23 jun 2013) | 1 line

[NEW] Mail-in admin options: "Allow routing" and "Leave email"

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 46432)
+++ tiki.sql	(revision 46433)
@@ -1249,6 +1249,7 @@
   `anonymous` char(1) NOT NULL default 'y',
   `admin` char(1) NOT NULL default 'y',
   `attachments` char(1) NOT NULL default 'n',
+  `routing` char(1) NOT NULL default 'y',
   `article_topicId` int(4) default NULL,
   `article_type` varchar(50) default NULL,
   `discard_after` varchar(255) default NULL,
@@ -1257,6 +1258,7 @@
   `categoryId` int(12) NULL,
   `namespace` varchar(20) default NULL,
   `respond_email` char(1) NOT NULL default 'y',
+  `leave_email` char(1) NOT NULL default 'n',
   PRIMARY KEY (`accountId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 

------------------------------------------------------------------------
r46430 | arildb | 2013-06-23 19:24:47 -0400 (dom, 23 jun 2013) | 5 lines

[NEW] Mail-in routing of incoming email to structures. Configured per user in "My Tiki" / "Mail-in"
...the option for this is still pending.
[ENH] Mail-in admin panel lists actions before the "Add New" account section.
[DOC] Make header like comments for each mail-in type


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 46429)
+++ tiki.sql	(revision 46430)
@@ -3755,3 +3755,15 @@
 	`definition` TEXT,
 	`is_advanced` CHAR(1) NOT NULL DEFAULT 'n'
 ) ENGINE=MyISAM;
+
+DROP TABLE IF EXISTS `tiki_user_mailin_struct`;
+CREATE TABLE `tiki_user_mailin_struct` (
+	`mailin_struct_id` int(12) NOT NULL auto_increment,
+	`username` varchar(200) NOT NULL,
+	`subj_pattern` varchar(255) NULL,
+	`body_pattern` varchar(255) NULL,
+	`structure_id` int(14) NOT NULL,
+	`page_id` int(14) NULL,
+	`is_active` char(1) NULL DEFAULT 'n',
+   PRIMARY KEY (`mailin_struct_id`)
+) ENGINE=MyISAM AUTO_INCREMENT=1;

------------------------------------------------------------------------
r46358 | arildb | 2013-06-16 09:02:23 -0400 (dom, 16 jun 2013) | 2 lines

[NEW] Mail-in admin can specify a namespace, which will be added to all incoming email. Can be used to prevent overwrites.
[ENH] Add some descriptions to the mail-in admin options

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 46357)
+++ tiki.sql	(revision 46358)
@@ -1255,6 +1255,7 @@
   `show_inlineImages` char(1) NULL,
   `save_html` char(1) NULL default 'y',
   `categoryId` int(12) NULL,
+  `namespace` varchar(20) default NULL,
   `respond_email` char(1) NOT NULL default 'y',
   PRIMARY KEY (`accountId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;

------------------------------------------------------------------------
r46315 | arildb | 2013-06-13 23:40:41 -0400 (qui, 13 jun 2013) | 1 line

[NEW] Add mail-in option "Allow admin access". If no, admins are blocked from using mail-in. Prevents use of full privileges through email.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 46314)
+++ tiki.sql	(revision 46315)
@@ -1247,6 +1247,7 @@
   `useAuth` char(1) default NULL,
   `smtpPort` int(4) default NULL,
   `anonymous` char(1) NOT NULL default 'y',
+  `admin` char(1) NOT NULL default 'y',
   `attachments` char(1) NOT NULL default 'n',
   `article_topicId` int(4) default NULL,
   `article_type` varchar(50) default NULL,

------------------------------------------------------------------------
r46312 | arildb | 2013-06-13 22:00:18 -0400 (qui, 13 jun 2013) | 2 lines

[NEW] add mail-in option "Keep HTML format". If yes, then html email is saved as wysiwyg-html regardless of editor availability or selection
[FIX] admin users have full mail-in access

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 46311)
+++ tiki.sql	(revision 46312)
@@ -1252,6 +1252,7 @@
   `article_type` varchar(50) default NULL,
   `discard_after` varchar(255) default NULL,
   `show_inlineImages` char(1) NULL,
+  `save_html` char(1) NULL default 'y',
   `categoryId` int(12) NULL,
   `respond_email` char(1) NOT NULL default 'y',
   PRIMARY KEY (`accountId`)

------------------------------------------------------------------------
r46242 | arildb | 2013-06-08 13:51:07 -0400 (sÃ¡b, 08 jun 2013) | 5 lines

[NEW] permission checking when submitting/approving an article.
[FIX] default respond_email setting should be 'y' 
[FIX] display of respond_email
[FIX] failed email is now deleted properly on the email server


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 46241)
+++ tiki.sql	(revision 46242)
@@ -1253,7 +1253,7 @@
   `discard_after` varchar(255) default NULL,
   `show_inlineImages` char(1) NULL,
   `categoryId` int(12) NULL,
-  `respond_email` char(1) NOT NULL default 'n',
+  `respond_email` char(1) NOT NULL default 'y',
   PRIMARY KEY (`accountId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 

------------------------------------------------------------------------
r46239 | arildb | 2013-06-08 11:34:29 -0400 (sÃ¡b, 08 jun 2013) | 3 lines

[NEW] Added field to specify how to respond to errors. By default an email is sent
[NEW] New permission tiki_p_send_mailin. If anonymous=n and tiki_p_send_mailin is not set, the email is not added to the wiki.


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 46238)
+++ tiki.sql	(revision 46239)
@@ -1253,6 +1253,7 @@
   `discard_after` varchar(255) default NULL,
   `show_inlineImages` char(1) NULL,
   `categoryId` int(12) NULL,
+  `respond_email` char(1) NOT NULL default 'n',
   PRIMARY KEY (`accountId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 

------------------------------------------------------------------------
r46223 | arildb | 2013-06-06 16:09:18 -0400 (qui, 06 jun 2013) | 2 lines

[NEW] mail-in can auto-assign a category to the created wiki page. 
[FIX] show_inlineImages is now filled in for newly created accounts

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 46222)
+++ tiki.sql	(revision 46223)
@@ -1252,6 +1252,7 @@
   `article_type` varchar(50) default NULL,
   `discard_after` varchar(255) default NULL,
   `show_inlineImages` char(1) NULL,
+  `categoryId` int(12) NULL,
   PRIMARY KEY (`accountId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 

------------------------------------------------------------------------
r46189 | arildb | 2013-06-06 08:45:36 -0400 (qui, 06 jun 2013) | 11 lines

[NEW] MailIn resolve inline images in html email. 
Have tried to test several email clients. Most seem to have a slightly different scheme storing the attachment/email info.
Have adjusted the cases I found.
[MOD] MailIn HTML mail now creates wiki pages in HTML format
[FIX] Mailin logs the correct user
[SEC] Mailin checks the user permissions (of the sender). 
Previously the checks would have been for the user currently logged on, triggering the mailin check.
Updated for wiki mailIns, but not for article mailIns.
Note that senders email address can be spoofed. So, there is no real security in mailIn
[FIX] Mailin account "attachments" setting is checked.


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 46188)
+++ tiki.sql	(revision 46189)
@@ -1251,6 +1251,7 @@
   `article_topicId` int(4) default NULL,
   `article_type` varchar(50) default NULL,
   `discard_after` varchar(255) default NULL,
+  `show_inlineImages` char(1) NULL,
   PRIMARY KEY (`accountId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 

------------------------------------------------------------------------
r46102 | lphuberdeau | 2013-05-30 11:45:25 -0400 (qui, 30 mai 2013) | 1 line

[ENH] Include category modifications in the action log, profile export recent changes, and exclude element removals from the recent changes (not something profiles can do)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 46101)
+++ tiki.sql	(revision 46102)
@@ -2910,6 +2910,9 @@
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Created', 'tracker', 'y');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Updated', 'tracker', 'y');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Removed', 'tracker', 'y');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Created', 'category', 'y');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Updated', 'category', 'y');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Removed', 'category', 'y');
 
 DROP TABLE IF EXISTS `tiki_freetags`;
 CREATE TABLE `tiki_freetags` (

------------------------------------------------------------------------
r46097 | lphuberdeau | 2013-05-30 10:52:03 -0400 (qui, 30 mai 2013) | 1 line

[ENH] Improve logging of tracker structural updates (and making sure they apply through all paths, not just the service utilities path)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 46096)
+++ tiki.sql	(revision 46097)
@@ -2907,6 +2907,9 @@
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Refresh', 'url', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Joined Room', 'bigbluebutton', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Left Room', 'bigbluebutton', 'n');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Created', 'tracker', 'y');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Updated', 'tracker', 'y');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Removed', 'tracker', 'y');
 
 DROP TABLE IF EXISTS `tiki_freetags`;
 CREATE TABLE `tiki_freetags` (

------------------------------------------------------------------------
r45799 | changi67 | 2013-04-29 15:05:12 -0400 (seg, 29 abr 2013) | 1 line

[FIX] Missing INSERT in tiki_actionlog_conf

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 45798)
+++ tiki.sql	(revision 45799)
@@ -1,5 +1,5 @@
 -- --------------------------------------------------------
--- Database : Tiki 
+-- Database : Tiki
 -- --------------------------------------------------------
 
 ALTER DATABASE DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci;
@@ -594,7 +594,7 @@
   `title` varchar(200) default NULL,
   `year` int(11) default NULL,
   `authors` varchar(200) default NULL,
-  `holder` varchar(200) default NULL,  
+  `holder` varchar(200) default NULL,
   `copyright_order` int(11) default NULL,
   `userName` varchar(200) default '',
   PRIMARY KEY (`copyrightId`)
@@ -780,7 +780,7 @@
   `user` varchar(200) default '',
   `author` varchar(40) default NULL,
   `hits` int(14) default NULL,
-  `maxhits` INT( 14 ) default NULL, 
+  `maxhits` INT( 14 ) default NULL,
   `lastDownload` int(14) default NULL,
   `votes` int(8) default NULL,
   `points` decimal(8,2) default NULL,
@@ -977,7 +977,7 @@
   `showfilesize` char(1) NOT NULL default 'n',
   `showfilename` char(1) NOT NULL default 'n',
   `defaultscale` varchar(10) NOT NULL DEFAULT 'o',
-  `showcategories` char(1) NOT NULL default 'n', 
+  `showcategories` char(1) NOT NULL default 'n',
   PRIMARY KEY (`galleryId`),
   KEY `name` (name),
   KEY `description` (description(255)),
@@ -1011,7 +1011,7 @@
   `type` varchar(200) default NULL,
   `url` varchar(250) default NULL,
   PRIMARY KEY (`watchId`),
-  INDEX `event-object-group` ( `event` , `object` ( 100 ) , `group` ( 50 ) ) 
+  INDEX `event-object-group` ( `event` , `object` ( 100 ) , `group` ( 50 ) )
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_history`;
@@ -2393,7 +2393,7 @@
   `title` varchar(40) default NULL,
   `data` longblob,
   `parse` char(1) default NULL,
-  `status` VARCHAR(60) default '',  
+  `status` VARCHAR(60) default '',
   PRIMARY KEY (`name`)
 ) ENGINE=MyISAM;
 
@@ -2905,6 +2905,8 @@
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Flagged', 'wiki page', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Fetch', 'url', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Refresh', 'url', 'n');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Joined Room', 'bigbluebutton', 'n');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Left Room', 'bigbluebutton', 'n');
 
 DROP TABLE IF EXISTS `tiki_freetags`;
 CREATE TABLE `tiki_freetags` (
@@ -3161,7 +3163,7 @@
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-view_tracker_item.php\\?itemId=(\\d+)', 'item$1', 'trackeritem', 'feature_trackers', 200);
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-list_file_gallery.php\\?galleryId=(\\d+)', 'file$1', 'file gallery', 'feature_file_galleries', 200);
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-user_information.php\\?userId=(\\d+)','user$1', '', '', 200);
- 
+
 UPDATE tiki_menu_options SET icon = 'icon-configuration48x48' WHERE name = 'Admin';
 UPDATE tiki_menu_options SET icon = 'xfce4-appfinder48x48' WHERE name = 'Search';
 UPDATE tiki_menu_options SET icon = 'wikipages48x48' WHERE name = 'Wiki';
@@ -3252,7 +3254,7 @@
     `creation` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
     `timeout` INT NOT NULL DEFAULT 0,
     `hits` INT NOT NULL DEFAULT 1,
-    `maxhits` INT NOT NULL DEFAULT 1, 
+    `maxhits` INT NOT NULL DEFAULT 1,
     `token` CHAR(32),
     `entry` VARCHAR(50),
     `email` varchar(255) NOT NULL,
@@ -3332,7 +3334,7 @@
     KEY `payment_request_ix` (`paymentRequestId`)
 ) ENGINE=MyISAM;
 DROP TABLE IF EXISTS `tiki_discount`;
-CREATE TABLE `tiki_discount`( 
+CREATE TABLE `tiki_discount`(
     `id` INT NOT NULL AUTO_INCREMENT,
     `code` VARCHAR(255),
     `value` VARCHAR(255),
@@ -3502,7 +3504,7 @@
     `unit_text` VARCHAR( 25 ) DEFAULT NULL,
     `is_static_level` CHAR( 1 ) DEFAULT 'n',
     `scaling_divisor` FLOAT NOT NULL DEFAULT 1,
-    PRIMARY KEY ( `credit_type` ) 
+    PRIMARY KEY ( `credit_type` )
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_acct_account`;
@@ -3519,7 +3521,7 @@
   KEY `accountTax` (`accountTax`)
 ) ENGINE=MyISAM;
 
-DROP TABLE IF EXISTS `tiki_acct_bankaccount`; 
+DROP TABLE IF EXISTS `tiki_acct_bankaccount`;
 CREATE TABLE `tiki_acct_bankaccount` (
   `bankBookId` int(10) unsigned NOT NULL,
   `bankAccountId` int(10) unsigned NOT NULL,
@@ -3569,7 +3571,7 @@
   PRIMARY KEY (`bookId`)
 ) ENGINE=MyISAM;
 
-DROP TABLE IF EXISTS `tiki_acct_item`; 
+DROP TABLE IF EXISTS `tiki_acct_item`;
 CREATE TABLE `tiki_acct_item` (
   `itemBookId` int(10) unsigned NOT NULL,
   `itemJournalId` int(10) unsigned NOT NULL DEFAULT '0',
@@ -3581,7 +3583,7 @@
   PRIMARY KEY (`itemBookId`,`itemJournalId`,`itemAccountId`,`itemType`)
 ) ENGINE=MyISAM;
 
-DROP TABLE IF EXISTS `tiki_acct_journal`; 
+DROP TABLE IF EXISTS `tiki_acct_journal`;
 CREATE TABLE `tiki_acct_journal` (
   `journalBookId` int(10) unsigned NOT NULL,
   `journalId` int(10) unsigned NOT NULL AUTO_INCREMENT,
@@ -3592,7 +3594,7 @@
   PRIMARY KEY (`journalId`)
 ) ENGINE=MyISAM;
 
-DROP TABLE IF EXISTS `tiki_acct_stack`; 
+DROP TABLE IF EXISTS `tiki_acct_stack`;
 CREATE TABLE `tiki_acct_stack` (
   `stackBookId` int(10) unsigned NOT NULL,
   `stackId` int(10) unsigned NOT NULL AUTO_INCREMENT,
@@ -3602,7 +3604,7 @@
   PRIMARY KEY (`stackId`)
 ) ENGINE=MyISAM;
 
-DROP TABLE IF EXISTS `tiki_acct_stackitem`; 
+DROP TABLE IF EXISTS `tiki_acct_stackitem`;
 CREATE TABLE `tiki_acct_stackitem` (
   `stackBookId` int(10) unsigned NOT NULL,
   `stackItemStackId` int(10) unsigned NOT NULL DEFAULT '0',
@@ -3631,7 +3633,7 @@
   PRIMARY KEY (`statementId`)
 ) ENGINE=MyISAM;
 
-DROP TABLE IF EXISTS `tiki_acct_tax`; 
+DROP TABLE IF EXISTS `tiki_acct_tax`;
 CREATE TABLE `tiki_acct_tax` (
   `taxBookId` int(10) unsigned NOT NULL,
   `taxId` int(10) unsigned NOT NULL AUTO_INCREMENT,
@@ -3708,7 +3710,7 @@
   `location` VARCHAR(255)  DEFAULT NULL,
   `style` VARCHAR(30) DEFAULT NULL,
   `template` varchar(255) DEFAULT NULL,
-  `last_modified` timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,  
+  `last_modified` timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
   PRIMARY KEY (`ref_id`),
   KEY `PageId` (`page_id`)
 ) ENGINE=MyISAM;
@@ -3731,7 +3733,7 @@
   `messageId` INT NOT NULL AUTO_INCREMENT ,
   `message`   TEXT NULL ,
   `attempts`  INT NOT NULL DEFAULT 0 ,
-  PRIMARY KEY (`messageId`) 
+  PRIMARY KEY (`messageId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1;
 
 DROP TABLE IF EXISTS `tiki_workspace_templates`;

------------------------------------------------------------------------
r45621 | nkoth | 2013-04-20 13:35:29 -0400 (sÃ¡b, 20 abr 2013) | 1 line

[ENH] Provide option to not send newsletter if article clipping results in no items tks Nelson

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 45620)
+++ tiki.sql	(revision 45621)
@@ -1597,6 +1597,7 @@
   `autoArticleClip` char(1) default 'n',
   `articleClipTypes` text,
   `articleClipRange` int(14) default NULL,
+  `emptyClipBlocksSend` char(1) default 'n',
   PRIMARY KEY (`nlId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 

------------------------------------------------------------------------
r45292 | jonnybradley | 2013-03-22 12:58:47 -0400 (sex, 22 mar 2013) | 1 line

[MOD] menus: Move a couple of feature menu options (Reports and Timesheets) from underneath the admin menu to the top section (still not in alphabetical order, but more logical i think)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 45291)
+++ tiki.sql	(revision 45292)
@@ -1469,8 +1469,8 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Social networks','tiki-socialnetworks.php',115,'feature_mytiki,feature_socialnetworks','tiki_p_socialnetworks|tiki_p_admin_socialnetworks','Registered',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'r', 'Invoice', 'tiki-list_invoices.php', 790, 'feature_invoice', 'tiki_p_admin', '', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'o', 'New Invoice', 'tiki-edit_invoice.php', 791, 'feature_invoice', 'tiki_p_admin', '', 0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'r', 'TimeSheet', 'tiki-timesheet.php', 1270, 'feature_time_sheet', '', '', 0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r',  'Reports','tiki-edit_report.php',1275,'feature_reports','tiki_p_admin','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'o', 'TimeSheet', 'tiki-timesheet.php', 39, 'feature_time_sheet', '', '', 0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o',  'Reports','tiki-edit_report.php',38,'feature_reports','tiki_p_admin','',0);
 
 DROP TABLE IF EXISTS `tiki_menus`;
 CREATE TABLE `tiki_menus` (

------------------------------------------------------------------------
r45025 | jonnybradley | 2013-03-01 16:54:01 -0400 (sex, 01 mar 2013) | 1 line

[FIX] tiki.sql: Missing schema updates from r44998 and r45024 (token groups and sefurl trackers)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 45024)
+++ tiki.sql	(revision 45025)
@@ -3154,7 +3154,7 @@
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-list_quizzes.php', 'quizzes', '', 'feature_quizzes', 200);
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-stats.php', 'stats', '', 'feature_stats', 200);
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-list_surveys.php', 'surveys', '', 'feature_surveys', 200);
-INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-list_trackers.php', 'trackers', '', 'feature_trackers', 200);
+INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-list_trackers.php', 'trackers', 'tracker', 'feature_trackers', 200);
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-sheets.php', 'sheets', '', 'feature_sheet', 200);
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-view_tracker_item.php\\?trackerId=(\\d+)\\&itemId=(\\d+)', 'item$2', 'trackeritem', 'feature_trackers', 200);
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-view_tracker_item.php\\?itemId=(\\d+)', 'item$1', 'trackeritem', 'feature_trackers', 200);
@@ -3256,7 +3256,7 @@
     `entry` VARCHAR(50),
     `email` varchar(255) NOT NULL,
     `parameters` VARCHAR(255),
-    `groups` VARCHAR(255),
+    `groups` TEXT,
     PRIMARY KEY( `tokenId` ),
     KEY `tiki_auth_tokens_token` (`token`)
 ) ENGINE=MyISAM;

------------------------------------------------------------------------
r44933 | sylvieg | 2013-02-20 08:34:04 -0400 (qua, 20 fev 2013) | 1 line

[FIX]anonymous can attach files

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 44932)
+++ tiki.sql	(revision 44933)
@@ -2570,7 +2570,7 @@
   `filename` varchar(255) default NULL,
   `filetype` varchar(80) default NULL,
   `filesize` int(14) default NULL,
-  `user` varchar(200) NOT NULL default '',
+  `user` varchar(200) default NULL,
   `data` longblob,
   `path` varchar(255) default NULL,
   `hits` int(10) default NULL,

------------------------------------------------------------------------
r44269 | lphuberdeau | 2012-12-13 15:11:04 -0400 (qui, 13 dez 2012) | 1 line

[MOD] Allow longer module zone names in table (1 character is limited)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 44268)
+++ tiki.sql	(revision 44269)
@@ -1519,7 +1519,7 @@
 CREATE TABLE `tiki_modules` (
   `moduleId` int(8) NOT NULL auto_increment,
   `name` varchar(200) NOT NULL default '',
-  `position` char(1) NOT NULL DEFAULT '',
+  `position` varchar(20) NOT NULL DEFAULT '',
   `ord` int(4) NOT NULL DEFAULT '0',
   `type` char(1) default NULL,
   `title` varchar(255) default NULL,
@@ -1529,16 +1529,16 @@
   `groups` text,
   PRIMARY KEY (`moduleId`),
   KEY `positionType` (position, type),
-  KEY `namePosOrdParam` (`name`(100), `position`, `ord`, `params`(140))
+  KEY `namePosOrdParam` (`name`(100), `position`, `ord`, `params`(120))
 ) ENGINE=MyISAM;
 
 INSERT INTO `tiki_modules` (name,position,ord,cache_time,params,groups) VALUES
-    ('menu','l',1,7200,'id=42&flip=y','a:1:{i:0;s:10:"Registered";}'),
-    ('logo','t',1,7200,'nobox=y','a:0:{}'),
-    ('login_box','t',2,0,'mode=popup&nobox=y','a:0:{}'),
-    ('quickadmin','t',3,7200,'nobox=y','a:1:{i:0;s:6:"Admins";}'),
-    ('rsslist','b',1,7200,'nobox=y','a:0:{}'),
-    ('poweredby','b',2,7200,'nobox=y&icons=n&version=n','a:0:{}');
+    ('menu','left',1,7200,'id=42&flip=y','a:1:{i:0;s:10:"Registered";}'),
+    ('logo','top',1,7200,'nobox=y','a:0:{}'),
+    ('login_box','top',2,0,'mode=popup&nobox=y','a:0:{}'),
+    ('quickadmin','top',3,7200,'nobox=y','a:1:{i:0;s:6:"Admins";}'),
+    ('rsslist','bottom',1,7200,'nobox=y','a:0:{}'),
+    ('poweredby','bottom',2,7200,'nobox=y&icons=n&version=n','a:0:{}');
 
 DROP TABLE IF EXISTS `tiki_newsletter_subscriptions`;
 CREATE TABLE `tiki_newsletter_subscriptions` (
@@ -2314,7 +2314,7 @@
 CREATE TABLE `tiki_user_assigned_modules` (
   `moduleId` int(8) NOT NULL,
   `name` varchar(200) NOT NULL default '',
-  `position` char(1) default NULL,
+  `position` varchar(20) default NULL,
   `ord` int(4) default NULL,
   `type` char(1) default NULL,
   `user` varchar(200) NOT NULL default '',

------------------------------------------------------------------------
r44234 | changi67 | 2012-12-11 06:25:27 -0400 (ter, 11 dez 2012) | 9 lines

Revision: 44234
          http://tikiwiki.svn.sourceforge.net/tikiwiki/?rev=44234&view=rev
			 Author:   lphuberdeau
			 Date:     2012-12-10 19:02:32 +0000 (Mon, 10 Dec 2012)
			 Log Message:
			 -----------
			 [MRG] Automatic merge, branches/10.x 44225 to 44233



Index: tiki.sql
===================================================================
--- tiki.sql	(revision 44233)
+++ tiki.sql	(revision 44234)
@@ -2318,7 +2318,8 @@
   `ord` int(4) default NULL,
   `type` char(1) default NULL,
   `user` varchar(200) NOT NULL default '',
-  PRIMARY KEY (`name`(30),`user`,`position`, `ord`)
+  PRIMARY KEY (`name`(30),`user`,`position`, `ord`),
+  KEY `id` (moduleId)
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_user_bookmarks_folders`;

------------------------------------------------------------------------
r44192 | arildb | 2012-12-05 06:16:21 -0400 (qua, 05 dez 2012) | 2 lines

[ROLLBACK][r44185] "Allow for longer relations. Especially for 'tiki.link.*'."
The table attribute change: tiki-object_relations.relation can be set back to 70, since pagenames are no loger stored as tiki.link types.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 44191)
+++ tiki.sql	(revision 44192)
@@ -3397,7 +3397,7 @@
 DROP TABLE IF EXISTS `tiki_object_relations`;
 CREATE TABLE `tiki_object_relations` (
     `relationId` INT PRIMARY KEY AUTO_INCREMENT,
-    `relation` varchar(255) NOT NULL,
+    `relation` varchar(70) NOT NULL,
     `source_type` varchar(50) NOT NULL,
     `source_itemId` varchar(160) NOT NULL,
     `target_type` varchar(50) NOT NULL,

------------------------------------------------------------------------
r44185 | arildb | 2012-12-03 18:21:43 -0400 (seg, 03 dez 2012) | 1 line

[DB] Allow for longer relations. Especially for 'tiki.link.*'

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 44184)
+++ tiki.sql	(revision 44185)
@@ -3397,7 +3397,7 @@
 DROP TABLE IF EXISTS `tiki_object_relations`;
 CREATE TABLE `tiki_object_relations` (
     `relationId` INT PRIMARY KEY AUTO_INCREMENT,
-    `relation` varchar(70) NOT NULL,
+    `relation` varchar(255) NOT NULL,
     `source_type` varchar(50) NOT NULL,
     `source_itemId` varchar(160) NOT NULL,
     `target_type` varchar(50) NOT NULL,

------------------------------------------------------------------------
r43473 | arildb | 2012-10-16 14:31:12 -0400 (ter, 16 out 2012) | 1 line

[FIX] Make sure action log comment has enough space

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 43472)
+++ tiki.sql	(revision 43473)
@@ -84,7 +84,7 @@
   `objectType` varchar(32) NOT NULL default '',
   `user` varchar(200) default '',
   `ip` varchar(39) default NULL,
-  `comment` varchar(255) default NULL,
+  `comment` text default NULL,
   `categId` int(12) NOT NULL default '0',
     `client` VARCHAR( 200 ) NULL DEFAULT NULL,
   PRIMARY KEY (`actionId`),

------------------------------------------------------------------------
r43250 | jonnybradley | 2012-10-02 14:17:23 -0400 (ter, 02 out 2012) | 1 line

[ENH] areas: Add "exclusive", "share_common" & "enabled" fields to areas, deploy "enabled" and modernise binderlib db access (exclusive & share_common to come...)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 43249)
+++ tiki.sql	(revision 43250)
@@ -3685,6 +3685,9 @@
 CREATE TABLE `tiki_areas` (
     `categId` int(11) NOT NULL,
     `perspectives` text,
+    `exclusive` char(1) NOT NULL DEFAULT 'n',
+    `share_common` char(1) NOT NULL DEFAULT 'y',
+    `enabled` char(1)  NOT NULL DEFAULT 'y',
     KEY `categId` (`categId`)
 ) ENGINE=MyISAM;
 

------------------------------------------------------------------------
r43168 | jonnybradley | 2012-09-27 09:03:11 -0400 (qui, 27 set 2012) | 1 line

[MRG] Automatic merge, branches/9.x 43163 to 43167

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 43167)
+++ tiki.sql	(revision 43168)
@@ -1480,10 +1480,11 @@
   `type` char(1) default NULL,
   `icon` varchar(200) default NULL,
   `use_items_icons` char(1) NOT NULL DEFAULT 'n',
+  `parse` char(1)  NOT NULL  DEFAULT 'n',
   PRIMARY KEY (`menuId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
-INSERT INTO tiki_menus (`menuId`,name,description,type) VALUES ('42','Application menu','Main extensive navigation menu','d');
+INSERT INTO tiki_menus (`menuId`,`name`,`description`,`type`,`parse`) VALUES ('42','Application menu','Main extensive navigation menu','d','n');
 
 DROP TABLE IF EXISTS `tiki_minical_events`;
 CREATE TABLE `tiki_minical_events` (

------------------------------------------------------------------------
r43011 | lphuberdeau | 2012-09-17 11:37:35 -0400 (seg, 17 set 2012) | 1 line

[FIX]Â Missing tiki.sql update

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 43010)
+++ tiki.sql	(revision 43011)
@@ -438,6 +438,7 @@
   `name` varchar(100) default NULL,
   `description` varchar(250) default NULL,
   `parentId` int(12) default NULL,
+  `rootId` int NOT NULL DEFAULT 0,
   `hits` int(8) default NULL,
   PRIMARY KEY (`categId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;

------------------------------------------------------------------------
r42817 | lindonb | 2012-09-03 20:19:46 -0400 (seg, 03 set 2012) | 1 line

[ENH] Implement partially metadata extraction for file gallery files. Metadata is extracted from file and stored in database upon upload, including for drafts and archives. Data can be viewed when "Properties" is clicked for a file (this also extracts and puts metadata into db if not already there). Extended data extracted for JPEG files, just basic file information for other file types.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 42816)
+++ tiki.sql	(revision 42817)
@@ -788,6 +788,7 @@
   `is_reference` char(1) default NULL,
   `hash` varchar(32) default NULL,
   `search_data` longtext,
+  `metadata` longtext,
   `lastModif` integer(14) DEFAULT NULL,
   `lastModifUser` varchar(200) DEFAULT NULL,
   `lockedby` varchar(200) default '',
@@ -813,6 +814,7 @@
   `user` varchar(200) default '',
   `path` varchar(255) default NULL,
   `hash` varchar(32) default NULL,
+  `metadata` longtext,
   `lastModif` integer(14) DEFAULT NULL,
   `lockedby` varchar(200) default '',
   PRIMARY KEY (`fileId`, `user`)

------------------------------------------------------------------------
r42785 | arildb | 2012-08-28 15:25:42 -0400 (ter, 28 ago 2012) | 1 line

[FIX] Specify Engine=MySAM to make the innodb user selection work

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 42784)
+++ tiki.sql	(revision 42785)
@@ -3731,4 +3731,4 @@
 	`name` VARCHAR(50),
 	`definition` TEXT,
 	`is_advanced` CHAR(1) NOT NULL DEFAULT 'n'
-);
+) ENGINE=MyISAM;

------------------------------------------------------------------------
r42732 | xavidp | 2012-08-25 10:18:49 -0400 (sÃ¡b, 25 ago 2012) | 1 line

[FIX]Add menu entries for accounting feature (for some reason they were missing)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 42731)
+++ tiki.sql	(revision 42732)
@@ -1375,6 +1375,8 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Sheets','tiki-sheets.php',782,'feature_sheet','tiki_p_view_sheet','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','Trackers','tiki-list_trackers.php',800,'feature_trackers','tiki_p_list_trackers','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Trackers','tiki-list_trackers.php',805,'feature_trackers','tiki_p_list_trackers','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s', 'Accounting', 'tiki-accounting_books.php', 830, 'feature_accounting', 'tiki_p_acct_view', '', 0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o', 'Accounting books', 'tiki-accounting_books.php', 835, 'feature_accounting', 'tiki_p_acct_view', '', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','Surveys','tiki-list_surveys.php',850,'feature_surveys','tiki_p_take_survey','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Surveys','tiki-list_surveys.php',855,'feature_surveys','tiki_p_take_survey','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Stats','tiki-survey_stats.php',860,'feature_surveys','tiki_p_view_survey_stats','',0);

------------------------------------------------------------------------
r42710 | lphuberdeau | 2012-08-24 08:50:54 -0400 (sex, 24 ago 2012) | 1 line

[NEW]Â Adding advanced workspace template editing for maximum flexibility until the UI provides the required features

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 42709)
+++ tiki.sql	(revision 42710)
@@ -3727,5 +3727,6 @@
 CREATE TABLE `tiki_workspace_templates` (
 	`templateId` INT PRIMARY KEY AUTO_INCREMENT,
 	`name` VARCHAR(50),
-	`definition` TEXT
+	`definition` TEXT,
+	`is_advanced` CHAR(1) NOT NULL DEFAULT 'n'
 );

------------------------------------------------------------------------
r42685 | lphuberdeau | 2012-08-23 06:46:04 -0400 (qui, 23 ago 2012) | 1 line

[MOD] Introducing workspace templates, which don't have much information yet, but adds non-admin permissions for creating workspaces

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 42684)
+++ tiki.sql	(revision 42685)
@@ -3721,4 +3721,11 @@
   `message`   TEXT NULL ,
   `attempts`  INT NOT NULL DEFAULT 0 ,
   PRIMARY KEY (`messageId`) 
-) ENGINE=MyISAM AUTO_INCREMENT=1;
\ No newline at end of file
+) ENGINE=MyISAM AUTO_INCREMENT=1;
+
+DROP TABLE IF EXISTS `tiki_workspace_templates`;
+CREATE TABLE `tiki_workspace_templates` (
+	`templateId` INT PRIMARY KEY AUTO_INCREMENT,
+	`name` VARCHAR(50),
+	`definition` TEXT
+);

------------------------------------------------------------------------
r42684 | xavidp | 2012-08-23 06:30:40 -0400 (qui, 23 ago 2012) | 1 line

Added an entry at the menu for admin tiki user credits (for some reason, there was no link anywhere). Added also for new installs

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 42683)
+++ tiki.sql	(revision 42684)
@@ -1413,6 +1413,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Live Support','tiki-live_support_admin.php',1055,'feature_live_support','user_is_operator','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Banning','tiki-admin_banning.php',1060,'feature_banning','tiki_p_admin_banning','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Calendar','tiki-admin_calendars.php',1065,'feature_calendar','tiki_p_admin_calendar','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Admin credits','tiki-admin_credits.php',1067,'payment_feature','tiki_p_admin_users','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Users','tiki-adminusers.php',1070,'','tiki_p_admin_users','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Groups','tiki-admingroups.php',1075,'','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','External Pages Cache','tiki-list_cache.php',1080,'cachepages','tiki_p_admin','',0);

------------------------------------------------------------------------
r42179 | jonnybradley | 2012-07-02 09:52:06 -0400 (seg, 02 jul 2012) | 1 line

[MRG] Automatic merge, branches/9.x 42154 to 42177

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 42178)
+++ tiki.sql	(revision 42179)
@@ -2673,7 +2673,7 @@
   `challenge` varchar(32) default NULL,
   `pass_confirm` int(14) default NULL,
   `email_confirm` int(14) default NULL,
-  `hash` varchar(34) default NULL,
+  `hash` varchar(60) default NULL,
   `created` int(14) default NULL,
   `avatarName` varchar(80) default NULL,
   `avatarSize` int(14) default NULL,

------------------------------------------------------------------------
r42155 | jonnybradley | 2012-06-28 12:24:38 -0400 (qui, 28 jun 2012) | 1 line

[MRG] Automatic merge, branches/9.x 42130 to 42154

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 42154)
+++ tiki.sql	(revision 42155)
@@ -2694,8 +2694,7 @@
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 -- Administrator account
-INSERT INTO users_users(email,login,password,hash) VALUES ('','admin','admin',md5('adminadmin'));
-UPDATE users_users set `currentLogin`=`lastLogin`, `registrationDate`=`lastLogin`;
+INSERT INTO users_users(email,login,password,hash,created,registrationDate) VALUES ('','admin','admin',md5('adminadmin'),UNIX_TIMESTAMP(),UNIX_TIMESTAMP());
 INSERT INTO tiki_user_preferences (user,`prefName`,value) VALUES ('admin','realName','System Administrator');
 INSERT INTO users_usergroups (`userId`, `groupName`) VALUES(1,'Admins');
 INSERT INTO users_grouppermissions (`groupName`, `permName`) VALUES ('Admins','tiki_p_admin');

------------------------------------------------------------------------
r41756 | arildb | 2012-06-04 15:41:55 -0400 (seg, 04 jun 2012) | 1 line

[NEW] add field for copyright holder. The copyright holder is not necessarily the author(s).

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 41755)
+++ tiki.sql	(revision 41756)
@@ -593,6 +593,7 @@
   `title` varchar(200) default NULL,
   `year` int(11) default NULL,
   `authors` varchar(200) default NULL,
+  `holder` varchar(200) default NULL,  
   `copyright_order` int(11) default NULL,
   `userName` varchar(200) default '',
   PRIMARY KEY (`copyrightId`)

------------------------------------------------------------------------
r41478 | lrrcenter | 2012-05-16 12:18:21 -0400 (qua, 16 mai 2012) | 1 line

[FIX] Mail queue. "Engine = MyISAM" is required after the create table statement.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 41477)
+++ tiki.sql	(revision 41478)
@@ -3720,4 +3720,4 @@
   `message`   TEXT NULL ,
   `attempts`  INT NOT NULL DEFAULT 0 ,
   PRIMARY KEY (`messageId`) 
-);
\ No newline at end of file
+) ENGINE=MyISAM AUTO_INCREMENT=1;
\ No newline at end of file

------------------------------------------------------------------------
r41477 | lrrcenter | 2012-05-16 11:44:11 -0400 (qua, 16 mai 2012) | 1 line

[FIX] Mail queue. Missing sql instructions for new installs in db/tiki.sql

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 41476)
+++ tiki.sql	(revision 41477)
@@ -3713,3 +3713,11 @@
   `other` varchar(100) DEFAULT NULL,
   PRIMARY KEY (`id`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1;
+
+DROP TABLE IF EXISTS `tiki_mail_queue`;
+CREATE TABLE `tiki_mail_queue` (
+  `messageId` INT NOT NULL AUTO_INCREMENT ,
+  `message`   TEXT NULL ,
+  `attempts`  INT NOT NULL DEFAULT 0 ,
+  PRIMARY KEY (`messageId`) 
+);
\ No newline at end of file

------------------------------------------------------------------------
r41267 | jonnybradley | 2012-05-01 14:35:01 -0400 (ter, 01 mai 2012) | 3 lines

[MRG] Automatic merge, branches/9.x 41183 to 41266
Fixed lang file conflicts using "mine-conflict"


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 41266)
+++ tiki.sql	(revision 41267)
@@ -263,12 +263,12 @@
   `excerpt` text default NULL,
   `created` int(14) default NULL,
   `user` varchar(200) default '',
+  `hits` bigint NULL default '0',
   `trackbacks_to` text,
   `trackbacks_from` text,
   `title` varchar(255) default NULL,
   `priv` varchar(1) default 'n',
   `wysiwyg` varchar(1) default NULL,
-  `hits` bigint NULL default '0',
   PRIMARY KEY (`postId`),
   KEY `data` (`data`(255)),
   KEY `blogId` (`blogId`),
@@ -755,7 +755,7 @@
   `image_max_size_x` int(8) NOT NULL default '0',
   `image_max_size_y` int(8) NOT NULL default '0',
   `show_source` char(1) NOT NULL DEFAULT 'o',
-  `icon_fileId` int(14) NULL DEFAULT NULL,
+  `icon_fileId` int(14) UNSIGNED NULL DEFAULT NULL,
   PRIMARY KEY (`galleryId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
@@ -1024,7 +1024,6 @@
   `data` longblob,
   `type` varchar(50) default NULL,
   `is_html` TINYINT(1) NOT NULL DEFAULT 0,
-  `status` varchar(60) default '',
   PRIMARY KEY (`pageName`,`version`),
   KEY `user` (`user`),
   KEY (`historyId`)
@@ -1631,7 +1630,6 @@
   `wiki_authors_style` varchar(20) default '',
   `comments_enabled` char(1) default NULL,
   `keywords` TEXT,
-  `status` varchar(60) default '',
   PRIMARY KEY (`page_id`),
   UNIQUE KEY `pageName` (`pageName`),
   KEY `data` (`data`(255)),

------------------------------------------------------------------------
r41169 | jonnybradley | 2012-04-29 09:53:16 -0400 (dom, 29 abr 2012) | 3 lines

[MRG] Automatic merge, branches/9.x 41052 to 41165
Conflicts manually fixed on db/tiki_convert_myisam_to_innodb.sql, db/tiki.sql, lib/tikilib.php (Authors please double check merge)


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 41168)
+++ tiki.sql	(revision 41169)
@@ -1459,6 +1459,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o', 'List Media', 'tiki-list_kaltura_entries.php', 952, 'feature_kaltura', 'tiki_p_admin | tiki_p_admin_kaltura | tiki_p_list_videos', '', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o', 'Upload Media', 'tiki-kaltura_upload.php', 954, 'feature_kaltura', 'tiki_p_admin | tiki_p_admin_kaltura | tiki_p_upload_videos', '', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Permissions','tiki-objectpermissions.php',1077,'','tiki_p_admin|tiki_p_admin_objects','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Perspectives','tiki-edit_perspective.php',1081,'feature_perspective','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Social networks','tiki-socialnetworks.php',115,'feature_mytiki,feature_socialnetworks','tiki_p_socialnetworks|tiki_p_admin_socialnetworks','Registered',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'r', 'Invoice', 'tiki-list_invoices.php', 790, 'feature_invoice', 'tiki_p_admin', '', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'o', 'New Invoice', 'tiki-edit_invoice.php', 791, 'feature_invoice', 'tiki_p_admin', '', 0);
@@ -3704,3 +3705,13 @@
 ALTER TABLE tiki_page_references ADD UNIQUE INDEX uk1_tiki_page_ref_biblio_code (page_id, biblio_code);
 ALTER TABLE tiki_page_references ADD INDEX idx_tiki_page_ref_title (title);
 ALTER TABLE tiki_page_references ADD INDEX idx_tiki_page_ref_author (author);
+
+DROP TABLE IF EXISTS `tiki_db_status`;
+CREATE TABLE `tiki_db_status` (
+  `id` int(11) NOT NULL AUTO_INCREMENT,
+  `objectId` varchar(100) NOT NULL,
+  `tableName` varchar(100) NOT NULL,
+  `status` varchar(100) NOT NULL,
+  `other` varchar(100) DEFAULT NULL,
+  PRIMARY KEY (`id`)
+) ENGINE=MyISAM AUTO_INCREMENT=1;

------------------------------------------------------------------------
r41133 | arildb | 2012-04-27 04:16:38 -0400 (sex, 27 abr 2012) | 1 line

[FIX] Fix syntax errors

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 41132)
+++ tiki.sql	(revision 41133)
@@ -2384,7 +2384,7 @@
   `title` varchar(40) default NULL,
   `data` longblob,
   `parse` char(1) default NULL,
-  `status` VARCHAR(60) default ''  
+  `status` VARCHAR(60) default '',  
   PRIMARY KEY (`name`)
 ) ENGINE=MyISAM;
 

------------------------------------------------------------------------
r41056 | arildb | 2012-04-23 13:45:06 -0400 (seg, 23 abr 2012) | 1 line

[NEW] Local reference handling added. See http://doc.tiki.org/References for the doc

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 41055)
+++ tiki.sql	(revision 41056)
@@ -2384,6 +2384,7 @@
   `title` varchar(40) default NULL,
   `data` longblob,
   `parse` char(1) default NULL,
+  `status` VARCHAR(60) default ''  
   PRIMARY KEY (`name`)
 ) ENGINE=MyISAM;
 
@@ -3680,3 +3681,26 @@
     `perspectives` text,
     KEY `categId` (`categId`)
 ) ENGINE=MyISAM;
+
+DROP TABLE IF EXISTS `tiki_page_references`;
+CREATE TABLE `tiki_page_references` (
+  `ref_id` INT(14) NOT NULL AUTO_INCREMENT,
+  `page_id` INT(14) DEFAULT NULL,
+  `biblio_code` VARCHAR(50) DEFAULT NULL,
+  `author` VARCHAR(255) DEFAULT NULL,
+  `title` VARCHAR(255) DEFAULT NULL,
+  `part` VARCHAR(255) DEFAULT NULL,
+  `uri` VARCHAR(255) DEFAULT NULL,
+  `code` VARCHAR(255) DEFAULT NULL,
+  `year` VARCHAR(255) DEFAULT NULL,
+  `publisher` VARCHAR(255) DEFAULT NULL,
+  `location` VARCHAR(255)  DEFAULT NULL,
+  `style` VARCHAR(30) DEFAULT NULL,
+  `template` varchar(255) DEFAULT NULL,
+  `last_modified` timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,  
+  PRIMARY KEY (`ref_id`),
+  KEY `PageId` (`page_id`)
+) ENGINE=MyISAM;
+ALTER TABLE tiki_page_references ADD UNIQUE INDEX uk1_tiki_page_ref_biblio_code (page_id, biblio_code);
+ALTER TABLE tiki_page_references ADD INDEX idx_tiki_page_ref_title (title);
+ALTER TABLE tiki_page_references ADD INDEX idx_tiki_page_ref_author (author);

------------------------------------------------------------------------
r41053 | robertplummer | 2012-04-23 12:30:27 -0400 (seg, 23 abr 2012) | 1 line

[MRG] Automatic merge, branches/9.x 41031 to 41052

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 41052)
+++ tiki.sql	(revision 41053)
@@ -1635,7 +1635,7 @@
   UNIQUE KEY `pageName` (`pageName`),
   KEY `data` (`data`(255)),
   KEY `pageRank` (`pageRank`),
-  KEY `lastModif`(`lastModif`),
+  KEY `lastModif`(`lastModif`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1;
 
 DROP TABLE IF EXISTS `tiki_pageviews`;
@@ -2812,7 +2812,7 @@
 
 DROP TABLE IF EXISTS `tiki_file_handlers`;
 CREATE TABLE `tiki_file_handlers` (
-  `mime_type` varchar(64) default NULL,
+  `mime_type` varchar(128) default NULL,
   `cmd` varchar(238) default NULL
 ) ENGINE=MyISAM;
 

------------------------------------------------------------------------
r41023 | sylvieg | 2012-04-21 20:10:48 -0400 (sÃ¡b, 21 abr 2012) | 1 line

[MRG] Automatic merge, branches/9.x 40948 to 41022

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 41022)
+++ tiki.sql	(revision 41023)
@@ -1024,6 +1024,7 @@
   `data` longblob,
   `type` varchar(50) default NULL,
   `is_html` TINYINT(1) NOT NULL DEFAULT 0,
+  `status` varchar(60) default '',
   PRIMARY KEY (`pageName`,`version`),
   KEY `user` (`user`),
   KEY (`historyId`)
@@ -1628,12 +1629,13 @@
   `wysiwyg` char(1) default NULL,
   `wiki_authors_style` varchar(20) default '',
   `comments_enabled` char(1) default NULL,
-  `keywords` TEXT, 
+  `keywords` TEXT,
+  `status` varchar(60) default '',
   PRIMARY KEY (`page_id`),
   UNIQUE KEY `pageName` (`pageName`),
   KEY `data` (`data`(255)),
   KEY `pageRank` (`pageRank`),
-  KEY `lastModif`(`lastModif`)
+  KEY `lastModif`(`lastModif`),
 ) ENGINE=MyISAM AUTO_INCREMENT=1;
 
 DROP TABLE IF EXISTS `tiki_pageviews`;

------------------------------------------------------------------------
r40627 | marclaporte | 2012-04-01 18:50:37 -0400 (dom, 01 abr 2012) | 1 line

Update menu to nicer label for new installs

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 40626)
+++ tiki.sql	(revision 40627)
@@ -1455,7 +1455,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Comments','tiki-list_comments.php',1260,'feature_faq_comments','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Contribution','tiki-admin_contribution.php',1265,'feature_contribution','tiki_p_admin_contribution','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s', 'Kaltura Video', 'tiki-list_kaltura_entries.php', 950, 'feature_kaltura', 'tiki_p_admin | tiki_p_admin_kaltura | tiki_p_list_videos', '', 0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o', 'List Entries', 'tiki-list_kaltura_entries.php', 952, 'feature_kaltura', 'tiki_p_admin | tiki_p_admin_kaltura | tiki_p_list_videos', '', 0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o', 'List Media', 'tiki-list_kaltura_entries.php', 952, 'feature_kaltura', 'tiki_p_admin | tiki_p_admin_kaltura | tiki_p_list_videos', '', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o', 'Upload Media', 'tiki-kaltura_upload.php', 954, 'feature_kaltura', 'tiki_p_admin | tiki_p_admin_kaltura | tiki_p_upload_videos', '', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Permissions','tiki-objectpermissions.php',1077,'','tiki_p_admin|tiki_p_admin_objects','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Social networks','tiki-socialnetworks.php',115,'feature_mytiki,feature_socialnetworks','tiki_p_socialnetworks|tiki_p_admin_socialnetworks','Registered',0);

------------------------------------------------------------------------
r40355 | jonnybradley | 2012-03-24 13:54:25 -0400 (sÃ¡b, 24 mar 2012) | 1 line

[ENH] filegals: Add ability to make the icon for galleries in browse mode a thumbnail by specifying an image fileId (can be in any other gallery)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 40354)
+++ tiki.sql	(revision 40355)
@@ -754,7 +754,8 @@
   `show_share` char(1) default NULL,
   `image_max_size_x` int(8) NOT NULL default '0',
   `image_max_size_y` int(8) NOT NULL default '0',
-  show_source CHAR(1) NOT NULL DEFAULT 'o',
+  `show_source` char(1) NOT NULL DEFAULT 'o',
+  `icon_fileId` int(14) NULL DEFAULT NULL,
   PRIMARY KEY (`galleryId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 

------------------------------------------------------------------------
r40329 | robertplummer | 2012-03-23 15:59:05 -0400 (sex, 23 mar 2012) | 1 line

[FIX] Ensured basic functionality is working

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 40328)
+++ tiki.sql	(revision 40329)
@@ -1373,7 +1373,6 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Sheets','tiki-sheets.php',782,'feature_sheet','tiki_p_view_sheet','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','Trackers','tiki-list_trackers.php',800,'feature_trackers','tiki_p_list_trackers','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Trackers','tiki-list_trackers.php',805,'feature_trackers','tiki_p_list_trackers','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Tracker Reports','tiki-tracker_reports.php',812,'feature_tracker_reports','tiki_p_admin_trackers','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','Surveys','tiki-list_surveys.php',850,'feature_surveys','tiki_p_take_survey','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Surveys','tiki-list_surveys.php',855,'feature_surveys','tiki_p_take_survey','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Stats','tiki-survey_stats.php',860,'feature_surveys','tiki_p_view_survey_stats','',0);
@@ -1462,6 +1461,8 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'r', 'Invoice', 'tiki-list_invoices.php', 790, 'feature_invoice', 'tiki_p_admin', '', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'o', 'New Invoice', 'tiki-edit_invoice.php', 791, 'feature_invoice', 'tiki_p_admin', '', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'r', 'TimeSheet', 'tiki-timesheet.php', 1270, 'feature_time_sheet', '', '', 0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r',  'Reports','tiki-edit_report.php',1275,'feature_reports','tiki_p_admin','',0);
+
 DROP TABLE IF EXISTS `tiki_menus`;
 CREATE TABLE `tiki_menus` (
   `menuId` int(8) NOT NULL auto_increment,

------------------------------------------------------------------------
r40272 | chealer | 2012-03-20 15:12:21 -0400 (ter, 20 mar 2012) | 4 lines

[ENH] Trackers: Merge tiki-list_trackers and tiki-admin_trackers, using the generalized tiki-admin_trackers. The new interface is tiki-list_trackers.
Reference: http://article.gmane.org/gmane.comp.cms.tiki.devel/25367
In list_trackers, creation and last modification dates do not show the time anymore (could be useful, but too noisy in current presentation)
The new interface is generally called "Trackers", sometimes "List Trackers"

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 40271)
+++ tiki.sql	(revision 40272)
@@ -1373,7 +1373,6 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Sheets','tiki-sheets.php',782,'feature_sheet','tiki_p_view_sheet','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','Trackers','tiki-list_trackers.php',800,'feature_trackers','tiki_p_list_trackers','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Trackers','tiki-list_trackers.php',805,'feature_trackers','tiki_p_list_trackers','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Admin Trackers','tiki-admin_trackers.php',810,'feature_trackers','tiki_p_admin_trackers','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Tracker Reports','tiki-tracker_reports.php',812,'feature_tracker_reports','tiki_p_admin_trackers','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','Surveys','tiki-list_surveys.php',850,'feature_surveys','tiki_p_take_survey','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Surveys','tiki-list_surveys.php',855,'feature_surveys','tiki_p_take_survey','',0);

------------------------------------------------------------------------
r40195 | chealer | 2012-03-15 14:08:53 -0400 (qui, 15 mar 2012) | 3 lines

[ENH] Articles: Also add a maximum vertical size for custom images specific to list mode
[ENH] Add default for dimension limits to custom images specific to list mode (approach of r27943)
Sylvie: big_image from tiki-read_article.tpl will not consider this. If you can explain what big_image means, that should probably be changed...

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 40194)
+++ tiki.sql	(revision 40195)
@@ -122,6 +122,7 @@
   `image_x` int(4) default NULL,
   `image_y` int(4) default NULL,
   `list_image_x` int(4) default NULL,
+  `list_image_y` int(4) default NULL,
   `image_data` longblob,
   `publishDate` int(14) default NULL,
   `expireDate` int(14) default NULL,

------------------------------------------------------------------------
r39718 | sampaioprimo | 2012-02-01 13:32:04 -0400 (qua, 01 fev 2012) | 1 line

remove unused column from tiki_user_reports

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 39717)
+++ tiki.sql	(revision 39718)
@@ -3190,7 +3190,6 @@
   `interval` varchar(20) NOT NULL,
   `view` varchar(8) NOT NULL,
   `type` varchar(5) NOT NULL,
-  `time_to_send` datetime NULL default 0,
   `always_email` tinyint(1) NOT NULL,
   `last_report` datetime NOT NULL,
   PRIMARY KEY (`id`)

------------------------------------------------------------------------
r39514 | chealer | 2012-01-16 16:25:54 -0400 (seg, 16 jan 2012) | 1 line

[REM] Remove show_lang option for article types (Show language). Badly implemented and can now be globally replaced by show_available translations

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 39513)
+++ tiki.sql	(revision 39514)
@@ -168,7 +168,6 @@
   `show_subtitle` varchar(1) default 'n',
   `show_linkto` varchar(1) default 'n',
   `show_image_caption` varchar(1) default 'n',
-  `show_lang` varchar(1) default 'n',
   `creator_edit` varchar(1) default NULL,
   `comment_can_rate_article` char(1) default NULL,
   PRIMARY KEY (`type`),

------------------------------------------------------------------------
r39147 | gregmartin | 2011-12-11 23:15:31 -0400 (dom, 11 dez 2011) | 1 line

[FIX] db type for blog post hits

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 39146)
+++ tiki.sql	(revision 39147)
@@ -268,7 +268,7 @@
   `title` varchar(255) default NULL,
   `priv` varchar(1) default 'n',
   `wysiwyg` varchar(1) default NULL,
-  `hist` bigint NULL default '0',
+  `hits` bigint NULL default '0',
   PRIMARY KEY (`postId`),
   KEY `data` (`data`(255)),
   KEY `blogId` (`blogId`),

------------------------------------------------------------------------
r39145 | gregmartin | 2011-12-11 22:36:16 -0400 (dom, 11 dez 2011) | 1 line

[ADD] rack blog post hits

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 39144)
+++ tiki.sql	(revision 39145)
@@ -268,6 +268,7 @@
   `title` varchar(255) default NULL,
   `priv` varchar(1) default 'n',
   `wysiwyg` varchar(1) default NULL,
+  `hist` bigint NULL default '0',
   PRIMARY KEY (`postId`),
   KEY `data` (`data`(255)),
   KEY `blogId` (`blogId`),

------------------------------------------------------------------------
r38277 | robertplummer | 2011-10-14 11:38:26 -0400 (sex, 14 out 2011) | 2 lines

[FIX] Added feature check for tracers
[NEW] Added menu schema items for timesheet

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 38276)
+++ tiki.sql	(revision 38277)
@@ -1461,7 +1461,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Social networks','tiki-socialnetworks.php',115,'feature_mytiki,feature_socialnetworks','tiki_p_socialnetworks|tiki_p_admin_socialnetworks','Registered',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'r', 'Invoice', 'tiki-list_invoices.php', 790, 'feature_invoice', 'tiki_p_admin', '', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'o', 'New Invoice', 'tiki-edit_invoice.php', 791, 'feature_invoice', 'tiki_p_admin', '', 0);
-
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'r', 'TimeSheet', 'tiki-timesheet.php', 1270, 'feature_time_sheet', '', '', 0);
 DROP TABLE IF EXISTS `tiki_menus`;
 CREATE TABLE `tiki_menus` (
   `menuId` int(8) NOT NULL auto_increment,

------------------------------------------------------------------------
r38276 | sampaioprimo | 2011-10-14 11:20:49 -0400 (sex, 14 out 2011) | 1 line

[MRG] Automatic merge, branches/8.x 38220 to 38272

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 38275)
+++ tiki.sql	(revision 38276)
@@ -2,7 +2,7 @@
 -- Database : Tiki 
 -- --------------------------------------------------------
 
-ALTER DATABASE DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;
+ALTER DATABASE DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci;
 
 DROP TABLE IF EXISTS `messu_messages`;
 CREATE TABLE `messu_messages` (

------------------------------------------------------------------------
r38148 | jonnybradley | 2011-10-11 06:23:49 -0400 (ter, 11 out 2011) | 1 line

[MRG] Automatic merge, branches/8.x 38116 to 38147

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 38147)
+++ tiki.sql	(revision 38148)
@@ -2312,12 +2312,11 @@
 
 DROP TABLE IF EXISTS `tiki_user_bookmarks_folders`;
 CREATE TABLE `tiki_user_bookmarks_folders` (
-  `folderId` int(12) NOT NULL auto_increment,
+  `folderId` int(12) NOT NULL,
   `parentId` int(12) default NULL,
   `user` varchar(200) NOT NULL default '',
   `name` varchar(30) default NULL,
-  PRIMARY KEY (`folderId`),
-  KEY `user` (`user`)
+  PRIMARY KEY (`user`,`folderId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `tiki_user_bookmarks_urls`;
@@ -3674,7 +3673,7 @@
 
 DROP TABLE IF EXISTS `tiki_areas`;
 CREATE TABLE `tiki_areas` (
-	`categId` int(11) NOT NULL,
-	`perspectives` text,
-	KEY `categId` (`categId`)
+    `categId` int(11) NOT NULL,
+    `perspectives` text,
+    KEY `categId` (`categId`)
 ) ENGINE=MyISAM;

------------------------------------------------------------------------
r38038 | changi67 | 2011-10-06 16:38:23 -0400 (qui, 06 out 2011) | 1 line

[MRG] Automatic merge, branches/8.x 38024 to 38033

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 38037)
+++ tiki.sql	(revision 38038)
@@ -1846,7 +1846,7 @@
   `referer` varchar(255) NOT NULL default '',
   `hits` int(10) default NULL,
   `last` int(14) default NULL,
-  `lasturl` varchar(255) default NULL,
+  `lasturl` text default NULL,
   PRIMARY KEY (`referer`)
 ) ENGINE=MyISAM;
 
@@ -2230,7 +2230,6 @@
   `itemId` int(12) NOT NULL default '0',
   `fieldId` int(12) NOT NULL default '0',
   `value` text,
-  `lang` char(16) default NULL,
   INDEX `version` (`version`),
   INDEX `itemId` (`itemId`),
   INDEX `fieldId` (`fieldId`)

------------------------------------------------------------------------
r37854 | oeversetten | 2011-10-01 18:05:38 -0400 (sÃ¡b, 01 out 2011) | 4 lines


[DB] add tiki_areas table creation



Index: tiki.sql
===================================================================
--- tiki.sql	(revision 37853)
+++ tiki.sql	(revision 37854)
@@ -3672,3 +3672,10 @@
     PRIMARY KEY (`id`),
     KEY `server` (`server`)
 ) ENGINE=MyISAM;
+
+DROP TABLE IF EXISTS `tiki_areas`;
+CREATE TABLE `tiki_areas` (
+	`categId` int(11) NOT NULL,
+	`perspectives` text,
+	KEY `categId` (`categId`)
+) ENGINE=MyISAM;

------------------------------------------------------------------------
r37704 | robertplummer | 2011-09-26 15:31:18 -0400 (seg, 26 set 2011) | 2 lines

[FIX] Permissions per tracker item are not checked, had to change to admin only
[FIX] Proper error for incorrect permissions

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 37703)
+++ tiki.sql	(revision 37704)
@@ -1373,7 +1373,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','Trackers','tiki-list_trackers.php',800,'feature_trackers','tiki_p_list_trackers','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Trackers','tiki-list_trackers.php',805,'feature_trackers','tiki_p_list_trackers','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Admin Trackers','tiki-admin_trackers.php',810,'feature_trackers','tiki_p_admin_trackers','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Tracker Reports','tiki-tracker_reports.php',812,'feature_tracker_reports','tiki_p_list_trackers','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Tracker Reports','tiki-tracker_reports.php',812,'feature_tracker_reports','tiki_p_admin_trackers','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','Surveys','tiki-list_surveys.php',850,'feature_surveys','tiki_p_take_survey','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Surveys','tiki-list_surveys.php',855,'feature_surveys','tiki_p_take_survey','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Stats','tiki-survey_stats.php',860,'feature_surveys','tiki_p_view_survey_stats','',0);

------------------------------------------------------------------------
r37681 | robertplummer | 2011-09-26 10:04:56 -0400 (seg, 26 set 2011) | 1 line

[FIX] Tracker reports permissions

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 37680)
+++ tiki.sql	(revision 37681)
@@ -1373,7 +1373,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','Trackers','tiki-list_trackers.php',800,'feature_trackers','tiki_p_list_trackers','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Trackers','tiki-list_trackers.php',805,'feature_trackers','tiki_p_list_trackers','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Admin Trackers','tiki-admin_trackers.php',810,'feature_trackers','tiki_p_admin_trackers','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Tracker Reports','tiki-tracker_reports.php',812,'feature_tracker_reports','tiki_p_admin_trackers','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Tracker Reports','tiki-tracker_reports.php',812,'feature_tracker_reports','tiki_p_list_trackers','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','Surveys','tiki-list_surveys.php',850,'feature_surveys','tiki_p_take_survey','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Surveys','tiki-list_surveys.php',855,'feature_surveys','tiki_p_take_survey','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Stats','tiki-survey_stats.php',860,'feature_surveys','tiki_p_view_survey_stats','',0);

------------------------------------------------------------------------
r37675 | robertplummer | 2011-09-26 08:50:50 -0400 (seg, 26 set 2011) | 1 line

[NEW] Added tracker reports as a feature and menu option, it was already there, might as well make it usable

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 37674)
+++ tiki.sql	(revision 37675)
@@ -1373,6 +1373,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','Trackers','tiki-list_trackers.php',800,'feature_trackers','tiki_p_list_trackers','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Trackers','tiki-list_trackers.php',805,'feature_trackers','tiki_p_list_trackers','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Admin Trackers','tiki-admin_trackers.php',810,'feature_trackers','tiki_p_admin_trackers','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Tracker Reports','tiki-tracker_reports.php',812,'feature_tracker_reports','tiki_p_admin_trackers','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','Surveys','tiki-list_surveys.php',850,'feature_surveys','tiki_p_take_survey','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Surveys','tiki-list_surveys.php',855,'feature_surveys','tiki_p_take_survey','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Stats','tiki-survey_stats.php',860,'feature_surveys','tiki_p_view_survey_stats','',0);

------------------------------------------------------------------------
r37585 | gillesm | 2011-09-23 10:01:26 -0400 (sex, 23 set 2011) | 3 lines

tiki.sql define the lasturl for tiki_referer_stats



Index: tiki.sql
===================================================================
--- tiki.sql	(revision 37584)
+++ tiki.sql	(revision 37585)
@@ -1845,6 +1845,7 @@
   `referer` varchar(255) NOT NULL default '',
   `hits` int(10) default NULL,
   `last` int(14) default NULL,
+  `lasturl` varchar(255) default NULL,
   PRIMARY KEY (`referer`)
 ) ENGINE=MyISAM;
 

------------------------------------------------------------------------
r37472 | arildb | 2011-09-20 16:47:28 -0400 (ter, 20 set 2011) | 1 line

[MERGE] Integrated experimental/innodb branch (rev 37260 to 37457) to trunk

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 37471)
+++ tiki.sql	(revision 37472)
@@ -146,8 +146,7 @@
   KEY `topicId` (`topicId`),
   KEY `publishDate` (`publishDate`),
   KEY `expireDate` (`expireDate`),
-  KEY `type` (`type`),
-  FULLTEXT KEY `ft` (`title`, `heading`, `body`)
+  KEY `type` (`type`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `tiki_article_types`;
@@ -272,8 +271,7 @@
   PRIMARY KEY (`postId`),
   KEY `data` (`data`(255)),
   KEY `blogId` (`blogId`),
-  KEY `created` (`created`),
-  FULLTEXT KEY `ft` (`data`, `title`)
+  KEY `created` (`created`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `tiki_blog_posts_images`;
@@ -319,8 +317,7 @@
   PRIMARY KEY (`blogId`),
   KEY `title` (`title`),
   KEY `description` (`description`(255)),
-  KEY `hits` (`hits`),
-  FULLTEXT KEY `ft` (`title`, `description`)
+  KEY `hits` (`hits`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `tiki_calendar_categories`;
@@ -386,11 +383,7 @@
   `lastmodif` int(14) NOT NULL default '0',
   `allday` tinyint(1) NOT NULL default '0',
   PRIMARY KEY (`calitemId`),
-  KEY `calendarId` (`calendarId`),
-  FULLTEXT KEY `ft` (`name`,`description`),
-  CONSTRAINT `fk_calitems_recurrence`
-    FOREIGN KEY (`recurrenceId`) REFERENCES `tiki_calendar_recurrence`(`recurrenceId`)
-    ON UPDATE CASCADE ON DELETE SET NULL
+  KEY `calendarId` (`calendarId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `tiki_calendar_locations`;
@@ -557,8 +550,7 @@
   KEY `tc_pi` (`parentId`),
   KEY `objectType` (object, `objectType`),
   KEY `commentDate` (`commentDate`),
-  KEY `threaded` (message_id, in_reply_to, `parentId`),
-  FULLTEXT KEY `ft` (title,data)
+  KEY `threaded` (message_id, in_reply_to, `parentId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `tiki_content`;
@@ -643,8 +635,7 @@
   `cache_timestamp` int(14) default NULL,
   PRIMARY KEY (`siteId`),
   KEY (`isValid`),
-  KEY (url),
-  FULLTEXT KEY `ft` (name,description)
+  KEY (url)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `tiki_dsn`;
@@ -682,8 +673,7 @@
   KEY `faqId` (`faqId`),
   KEY `question` (question(255)),
   KEY `answer` (answer(255)),
-  KEY `created` (`created`),
-  FULLTEXT KEY `ft` (question,answer)
+  KEY `created` (`created`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `tiki_faqs`;
@@ -698,8 +688,7 @@
   PRIMARY KEY (`faqId`),
   KEY `title` (title),
   KEY `description` (description(255)),
-  KEY `hits` (hits),
-  FULLTEXT KEY `ft` (title,description)
+  KEY `hits` (hits)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `tiki_featured_links`;
@@ -808,8 +797,7 @@
   KEY `created` (created),
   KEY `archiveId` (`archiveId`),
   KEY `galleryId` (`galleryId`),
-  KEY `hits` (hits),
-  FULLTEXT KEY `ft` (name,description,search_data,filename)
+  KEY `hits` (hits)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `tiki_file_drafts`;
@@ -989,8 +977,7 @@
   KEY `description` (description(255)),
   KEY `hits` (hits),
   KEY `parentgallery` (parentgallery),
-  KEY `visibleUser` (visible, user),
-  FULLTEXT KEY `ft` (name,description)
+  KEY `visibleUser` (visible, user)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `tiki_galleries_scales`;
@@ -1084,8 +1071,7 @@
   KEY `hits` (hits),
   KEY `ti_gId` (`galleryId`),
   KEY `ti_cr` (created),
-  KEY `ti_us` (user),
-  FULLTEXT KEY `ft` (name,description)
+  KEY `ti_us` (user)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `tiki_images_data`;
@@ -1644,7 +1630,6 @@
   UNIQUE KEY `pageName` (`pageName`),
   KEY `data` (`data`(255)),
   KEY `pageRank` (`pageRank`),
-  FULLTEXT KEY `ft` (`pageName`,`description`,`data`),
   KEY `lastModif`(`lastModif`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1;
 
@@ -2234,8 +2219,7 @@
   `value` text,
   PRIMARY KEY (`itemId`,`fieldId`),
   INDEX `fieldId` (`fieldId`),
-  INDEX value (value(250)),
-  FULLTEXT KEY `ft` (value)
+  INDEX value (value(250))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_tracker_item_field_logs`;

------------------------------------------------------------------------
r37299 | chealer | 2011-09-15 17:22:01 -0400 (qui, 15 set 2011) | 2 lines

[FIX] tiki_user_bookmarks_folders definition for strict SQL mode ("Incorrect table definition; there can be only one auto column and it must be defined as a key", from r28)
Thanks Arild Berg

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 37298)
+++ tiki.sql	(revision 37299)
@@ -2331,7 +2331,8 @@
   `parentId` int(12) default NULL,
   `user` varchar(200) NOT NULL default '',
   `name` varchar(30) default NULL,
-  PRIMARY KEY (`user`,`folderId`)
+  PRIMARY KEY (`folderId`),
+  KEY `user` (`user`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `tiki_user_bookmarks_urls`;

------------------------------------------------------------------------
r37198 | nkoth | 2011-09-13 00:48:54 -0400 (ter, 13 set 2011) | 1 line

[NEW] Allow for membership extension of groups by fixed annual or monthly anniversary term periods, including calculation of prorated payment.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 37197)
+++ tiki.sql	(revision 37198)
@@ -2633,6 +2633,8 @@
   `isExternal` char(1) default 'n',
   `expireAfter` int(14) default 0,
   `emailPattern`  varchar(255) default '',
+  `anniversary` char(4) default '',
+  `prorateInterval` varchar(255) default '',
   PRIMARY KEY (`id`),
   UNIQUE KEY `groupName` (`groupName`),
   KEY `expireAfter` (`expireAfter`)

------------------------------------------------------------------------
r37191 | lphuberdeau | 2011-09-12 11:04:05 -0400 (seg, 12 set 2011) | 1 line

[FIX] Remove columns that have not been used in a long time apparently

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 37190)
+++ tiki.sql	(revision 37191)
@@ -2279,15 +2279,7 @@
   `descriptionIsParsed` varchar(1) NULL default '0',
   `created` int(14) default NULL,
   `lastModif` int(14) default NULL,
-  `showCreated` char(1) default NULL,
-  `showStatus` char(1) default NULL,
-  `showLastModif` char(1) default NULL,
-  `useComments` char(1) default NULL,
-  `useAttachments` char(1) default NULL,
-  `showAttachments` char(1) default NULL,
   `items` int(10) default NULL,
-  `showComments` char(1) default NULL,
-  `orderAttachments` varchar(255) NOT NULL default 'filename,created,filesize,hits,desc',
   PRIMARY KEY (`trackerId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 

------------------------------------------------------------------------
r37148 | arildb | 2011-09-11 13:28:29 -0400 (dom, 11 set 2011) | 1 line

[FIX] Add missing table engine specifications

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 37147)
+++ tiki.sql	(revision 37148)
@@ -3667,7 +3667,7 @@
     `quantity` INT( 14 ) NOT NULL,
     `timeHeld` INT( 14 ) NOT NULL,
     `hash` CHAR( 32 ) NOT NULL
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_source_auth`;
 CREATE TABLE `tiki_source_auth` (
@@ -3678,7 +3678,7 @@
     `method` VARCHAR(20) NOT NULL,
     `arguments` TEXT NOT NULL,
     KEY `tiki_source_auth_ix` (`scheme`, `domain`)
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_connect`;
 CREATE TABLE `tiki_connect` (
@@ -3690,4 +3690,4 @@
     `server` TINYINT(1) NOT NULL DEFAULT '0',
     PRIMARY KEY (`id`),
     KEY `server` (`server`)
-);
+) ENGINE=MyISAM;

------------------------------------------------------------------------
r37094 | robertplummer | 2011-09-09 17:33:55 -0400 (sex, 09 set 2011) | 1 line

[NEW] Added forum language to db and forum admin page

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 37093)
+++ tiki.sql	(revision 37094)
@@ -916,6 +916,7 @@
   `commentsPerPage` varchar(100) default NULL,
   `is_flat` char(1) default NULL,
   `mandatory_contribution` char(1) default NULL,
+  `forumLanguage` varchar(255) default NULL,
   PRIMARY KEY (`forumId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 

------------------------------------------------------------------------
r37039 | sylvieg | 2011-09-08 09:11:33 -0400 (qui, 08 set 2011) | 1 line

[FIX]article: author can be null if anonymous submission

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 37038)
+++ tiki.sql	(revision 37039)
@@ -2066,7 +2066,7 @@
   `heading` text,
   `body` text,
   `hash` varchar(32) default NULL,
-  `author` varchar(200) NOT NULL default '',
+  `author` varchar(200) default NULL,
   `nbreads` int(14) default NULL,
   `votes` int(8) default NULL,
   `points` int(14) default NULL,

------------------------------------------------------------------------
r36962 | arildb | 2011-09-05 17:27:44 -0400 (seg, 05 set 2011) | 1 line

[FIX] Make tiki_actionlog handle comments like: <!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\">=><!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\">

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 36961)
+++ tiki.sql	(revision 36962)
@@ -84,7 +84,7 @@
   `objectType` varchar(32) NOT NULL default '',
   `user` varchar(200) default '',
   `ip` varchar(39) default NULL,
-  `comment` varchar(200) default NULL,
+  `comment` varchar(255) default NULL,
   `categId` int(12) NOT NULL default '0',
     `client` VARCHAR( 200 ) NULL DEFAULT NULL,
   PRIMARY KEY (`actionId`),

------------------------------------------------------------------------
r36896 | arildb | 2011-09-04 08:19:08 -0400 (dom, 04 set 2011) | 1 line

[FIX] Shoutbox insert error due to missing tweetId fixed. Now tweetId default = 0 in db table

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 36895)
+++ tiki.sql	(revision 36896)
@@ -2006,7 +2006,7 @@
   `timestamp` int(14) default NULL,
   `user` varchar(200) NULL default '',
   `hash` varchar(32) default NULL,
-  `tweetId` bigint(20) unsigned NOT NULL,
+  `tweetId` bigint(20) unsigned NOT NULL default 0,
   PRIMARY KEY (`msgId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 

------------------------------------------------------------------------
r36800 | chealer | 2011-09-02 01:26:22 -0400 (sex, 02 set 2011) | 4 lines

[user:chealer:FINISHOFF] Workspace Helper: remove ws_container, rootCategId, reverting changes to categlib (22005, 21885, 21791, 21722, 21638 and 21000). Completes r22802
20110902_revert_rootCategId_addition completes 20100214_workspaces_remove_menu_items to cancel 20090921_workspaces
[REF] minor cleanups


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 36799)
+++ tiki.sql	(revision 36800)
@@ -445,7 +445,6 @@
   `description` varchar(250) default NULL,
   `parentId` int(12) default NULL,
   `hits` int(8) default NULL,
-  `rootCategId` int(12) default NULL,
   PRIMARY KEY (`categId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
@@ -3671,23 +3670,23 @@
 
 DROP TABLE IF EXISTS `tiki_source_auth`;
 CREATE TABLE `tiki_source_auth` (
-	`identifier` VARCHAR(50) PRIMARY KEY,
-	`scheme` VARCHAR(20) NOT NULL,
-	`domain` VARCHAR(200) NOT NULL,
-	`path` VARCHAR(200) NOT NULL,
-	`method` VARCHAR(20) NOT NULL,
-	`arguments` TEXT NOT NULL,
-	KEY `tiki_source_auth_ix` (`scheme`, `domain`)
+    `identifier` VARCHAR(50) PRIMARY KEY,
+    `scheme` VARCHAR(20) NOT NULL,
+    `domain` VARCHAR(200) NOT NULL,
+    `path` VARCHAR(200) NOT NULL,
+    `method` VARCHAR(20) NOT NULL,
+    `arguments` TEXT NOT NULL,
+    KEY `tiki_source_auth_ix` (`scheme`, `domain`)
 );
 
 DROP TABLE IF EXISTS `tiki_connect`;
 CREATE TABLE `tiki_connect` (
-	`id` INT(11) unsigned NOT NULL AUTO_INCREMENT,
-	`created` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
-	`type` VARCHAR(64) NOT NULL DEFAULT '',
-	`data` TEXT,
-	`guid` VARCHAR(64) DEFAULT NULL,
-	`server` TINYINT(1) NOT NULL DEFAULT '0',
-	PRIMARY KEY (`id`),
-	KEY `server` (`server`)
+    `id` INT(11) unsigned NOT NULL AUTO_INCREMENT,
+    `created` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    `type` VARCHAR(64) NOT NULL DEFAULT '',
+    `data` TEXT,
+    `guid` VARCHAR(64) DEFAULT NULL,
+    `server` TINYINT(1) NOT NULL DEFAULT '0',
+    PRIMARY KEY (`id`),
+    KEY `server` (`server`)
 );

------------------------------------------------------------------------
r36656 | jonnybradley | 2011-08-30 12:38:38 -0400 (ter, 30 ago 2011) | 2 lines

[REF] connect: Split connect services up into client and server, and use service actions properly (no more cmd param).
Also use JitFilter input params correctly, increase guid length in database and don't delete failed or cancelled connection, just mark as deleted (thanks lphuberdeau)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 36655)
+++ tiki.sql	(revision 36656)
@@ -3686,7 +3686,7 @@
 	`created` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
 	`type` VARCHAR(64) NOT NULL DEFAULT '',
 	`data` TEXT,
-	`guid` VARCHAR(32) DEFAULT NULL,
+	`guid` VARCHAR(64) DEFAULT NULL,
 	`server` TINYINT(1) NOT NULL DEFAULT '0',
 	PRIMARY KEY (`id`),
 	KEY `server` (`server`)

------------------------------------------------------------------------
r36410 | jonnybradley | 2011-08-23 15:17:28 -0400 (ter, 23 ago 2011) | 1 line

[ENH] connect: Storage for data, moved js to  a separate file, some refactoring and renaming

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 36409)
+++ tiki.sql	(revision 36410)
@@ -3680,3 +3680,14 @@
 	KEY `tiki_source_auth_ix` (`scheme`, `domain`)
 );
 
+DROP TABLE IF EXISTS `tiki_connect`;
+CREATE TABLE `tiki_connect` (
+	`id` INT(11) unsigned NOT NULL AUTO_INCREMENT,
+	`created` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
+	`type` VARCHAR(64) NOT NULL DEFAULT '',
+	`data` TEXT,
+	`guid` VARCHAR(32) DEFAULT NULL,
+	`server` TINYINT(1) NOT NULL DEFAULT '0',
+	PRIMARY KEY (`id`),
+	KEY `server` (`server`)
+);

------------------------------------------------------------------------
r36349 | lphuberdeau | 2011-08-19 15:25:22 -0400 (sex, 19 ago 2011) | 1 line

[FIX] Length was effectively still 30 because of the key length, which remains quite random for groupName across tiki, thanks to varchar(255)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 36348)
+++ tiki.sql	(revision 36349)
@@ -2668,7 +2668,7 @@
   `groupName` varchar(255) NOT NULL default '',
   `created` int(14) default NULL,
   `expire` int(14) default NULL,
-  PRIMARY KEY (`userId`,`groupName`(30))
+  PRIMARY KEY (`userId`,`groupName`(225))
 ) ENGINE=MyISAM;
 
 INSERT INTO users_groups (`groupName`,`groupDesc`) VALUES ('Anonymous','Public users not logged');

------------------------------------------------------------------------
r35951 | sylvieg | 2011-08-09 12:02:05 -0400 (ter, 09 ago 2011) | 1 line

[MRG] Automatic merge, branches/7.x 35708 to 35940

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 35950)
+++ tiki.sql	(revision 35951)
@@ -2247,7 +2247,7 @@
   `lang` char(16) default NULL,
   INDEX `version` (`version`),
   INDEX `itemId` (`itemId`),
-  INDEX `fieldId` (`itemId`)
+  INDEX `fieldId` (`fieldId`)
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_tracker_items`;

------------------------------------------------------------------------
r35844 | sampaioprimo | 2011-08-05 09:27:32 -0400 (sex, 05 ago 2011) | 1 line

fix syntax error introduced with r35810

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 35843)
+++ tiki.sql	(revision 35844)
@@ -2647,7 +2647,7 @@
 ) ENGINE=MyISAM AUTO_INCREMENT=1;
 
 DROP TABLE IF EXISTS `users_objectpermissions`;
-CREATE TABLE ` (
+CREATE TABLE `users_objectpermissions` (
   `groupName` varchar(255) NOT NULL default '',
   `permName` varchar(40) NOT NULL default '',
   `objectType` varchar(20) NOT NULL default '',

------------------------------------------------------------------------
r35810 | sylvieg | 2011-08-03 13:56:25 -0400 (qua, 03 ago 2011) | 1 line

[FIX]perm: groups canb have more thatn 30 first common characters

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 35809)
+++ tiki.sql	(revision 35810)
@@ -2647,12 +2647,12 @@
 ) ENGINE=MyISAM AUTO_INCREMENT=1;
 
 DROP TABLE IF EXISTS `users_objectpermissions`;
-CREATE TABLE `users_objectpermissions` (
+CREATE TABLE ` (
   `groupName` varchar(255) NOT NULL default '',
   `permName` varchar(40) NOT NULL default '',
   `objectType` varchar(20) NOT NULL default '',
   `objectId` varchar(32) NOT NULL default '',
-  PRIMARY KEY (`objectId`, `objectType`, `groupName`(30),`permName`)
+  PRIMARY KEY `uo` (`objectId`, `objectType`, `groupName`(170),`permName`)
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `users_permissions`;

------------------------------------------------------------------------
r35688 | lphuberdeau | 2011-07-27 13:45:07 -0400 (qua, 27 jul 2011) | 1 line

[MOD] Remove the lang column in both tiki_tracker_item_fields and tiki_tracker_item_field_logs, store multilingual value as serialized instead to avoid global complexity for a localized problem

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 35687)
+++ tiki.sql	(revision 35688)
@@ -2232,11 +2232,9 @@
   `itemId` int(12) NOT NULL default '0',
   `fieldId` int(12) NOT NULL default '0',
   `value` text,
-  `lang` char(16) default NULL,
-  PRIMARY KEY (`itemId`,`fieldId`,`lang`),
+  PRIMARY KEY (`itemId`,`fieldId`),
   INDEX `fieldId` (`fieldId`),
   INDEX value (value(250)),
-  INDEX lang (lang),
   FULLTEXT KEY `ft` (value)
 ) ENGINE=MyISAM;
 

------------------------------------------------------------------------
r35646 | lphuberdeau | 2011-07-25 11:16:18 -0400 (seg, 25 jul 2011) | 1 line

[MOD]Â Adding a permanent name to tracker fields to be used for services and integration

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 35645)
+++ tiki.sql	(revision 35646)
@@ -2183,6 +2183,7 @@
   `fieldId` int(12) NOT NULL auto_increment,
   `trackerId` int(12) NOT NULL default '0',
   `name` varchar(255) default NULL,
+  `permName` VARCHAR(100) NULL,
   `options` text,
   `type` varchar(15) default NULL,
   `isMain` char(1) default NULL,
@@ -2203,7 +2204,8 @@
   `validationParam` varchar(255) default '',
   `validationMessage` varchar(255) default '',
   PRIMARY KEY (`fieldId`),
-  INDEX `trackerId` (`trackerId`)
+  INDEX `trackerId` (`trackerId`),
+  UNIQUE `permName` (`permName`, `trackerId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `tiki_tracker_item_attachments`;

------------------------------------------------------------------------
r35485 | robertplummer | 2011-07-19 09:13:49 -0400 (ter, 19 jul 2011) | 1 line

[FIX] Added the invoice menu items for standard install

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 35484)
+++ tiki.sql	(revision 35485)
@@ -1472,8 +1472,9 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o', 'Upload Media', 'tiki-kaltura_upload.php', 954, 'feature_kaltura', 'tiki_p_admin | tiki_p_admin_kaltura | tiki_p_upload_videos', '', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Permissions','tiki-objectpermissions.php',1077,'','tiki_p_admin|tiki_p_admin_objects','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Social networks','tiki-socialnetworks.php',115,'feature_mytiki,feature_socialnetworks','tiki_p_socialnetworks|tiki_p_admin_socialnetworks','Registered',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'r', 'Invoice', 'tiki-list_invoices.php', 790, 'feature_invoice', 'tiki_p_admin', '', 0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'o', 'New Invoice', 'tiki-edit_invoice.php', 791, 'feature_invoice', 'tiki_p_admin', '', 0);
 
-
 DROP TABLE IF EXISTS `tiki_menus`;
 CREATE TABLE `tiki_menus` (
   `menuId` int(8) NOT NULL auto_increment,

------------------------------------------------------------------------
r35008 | lphuberdeau | 2011-06-22 11:21:16 -0400 (qua, 22 jun 2011) | 1 line

[MOD] Including URL fetch status in the action log

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 35007)
+++ tiki.sql	(revision 35008)
@@ -2910,6 +2910,8 @@
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Categorized', 'wiki page', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Uncategorized', 'wiki page', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Flagged', 'wiki page', 'n');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Fetch', 'url', 'n');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Refresh', 'url', 'n');
 
 DROP TABLE IF EXISTS `tiki_freetags`;
 CREATE TABLE `tiki_freetags` (

------------------------------------------------------------------------
r34939 | sylvieg | 2011-06-15 06:29:54 -0400 (qua, 15 jun 2011) | 1 line

[FIX]structures: received structures generated a null alias .. and alias can be null

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 34938)
+++ tiki.sql	(revision 34939)
@@ -2031,7 +2031,7 @@
   `parent_id` int(14) default NULL,
   `page_id` int(14) NOT NULL,
   `page_version` int(8) default NULL,
-  `page_alias` varchar(240) NOT NULL default '',
+  `page_alias` varchar(240) default '',
   `pos` int(4) default NULL,
   PRIMARY KEY (`page_ref_id`),
   KEY `pidpaid` (page_id,parent_id),

------------------------------------------------------------------------
r34927 | lphuberdeau | 2011-06-14 13:35:39 -0400 (ter, 14 jun 2011) | 1 line

[MRG] Automatic merge, branches/7.x 34885 to 34926

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 34926)
+++ tiki.sql	(revision 34927)
@@ -3595,7 +3595,7 @@
   `journalDescription` varchar(255) NOT NULL,
   `journalCancelled` int(1) NOT NULL DEFAULT '0',
   `journalTs` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
-  PRIMARY KEY (`journalBookId`,`journalId`)
+  PRIMARY KEY (`journalId`)
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_acct_stack`; 
@@ -3605,7 +3605,7 @@
   `stackDate` date NOT NULL DEFAULT '0000-00-00',
   `stackDescription` varchar(255) NOT NULL,
   `stackTs` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
-  PRIMARY KEY (`stackBookId`,`stackId`)
+  PRIMARY KEY (`stackId`)
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_acct_stackitem`; 
@@ -3634,7 +3634,7 @@
   `statementAmount` double NOT NULL,
   `statementJournalId` int(10) unsigned NOT NULL DEFAULT '0',
   `statementStackId` int(11) NOT NULL,
-  PRIMARY KEY (`statementBookId`,`statementAccountId`,`statementId`)
+  PRIMARY KEY (`statementId`)
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_acct_tax`; 
@@ -3644,7 +3644,7 @@
   `taxText` varchar(63) NOT NULL,
   `taxAmount` double NOT NULL DEFAULT '0',
   `taxIsFix` enum('y','n') NOT NULL DEFAULT 'n',
-  PRIMARY KEY (`taxBookId`,`taxId`)
+  PRIMARY KEY (`taxId`)
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_queue`;

------------------------------------------------------------------------
r34923 | lphuberdeau | 2011-06-14 11:30:13 -0400 (ter, 14 jun 2011) | 1 line

[NEW] Adding support for authenticated HTTP sources configurable from the admin panels, should work magically with all http requests going through the standard paths

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 34922)
+++ tiki.sql	(revision 34923)
@@ -3665,3 +3665,15 @@
     `timeHeld` INT( 14 ) NOT NULL,
     `hash` CHAR( 32 ) NOT NULL
 );
+
+DROP TABLE IF EXISTS `tiki_source_auth`;
+CREATE TABLE `tiki_source_auth` (
+	`identifier` VARCHAR(50) PRIMARY KEY,
+	`scheme` VARCHAR(20) NOT NULL,
+	`domain` VARCHAR(200) NOT NULL,
+	`path` VARCHAR(200) NOT NULL,
+	`method` VARCHAR(20) NOT NULL,
+	`arguments` TEXT NOT NULL,
+	KEY `tiki_source_auth_ix` (`scheme`, `domain`)
+);
+

------------------------------------------------------------------------
r34913 | lphuberdeau | 2011-06-13 11:53:34 -0400 (seg, 13 jun 2011) | 1 line

[MOD] Displaying source in file galleries

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 34912)
+++ tiki.sql	(revision 34913)
@@ -765,6 +765,7 @@
   `show_share` char(1) default NULL,
   `image_max_size_x` int(8) NOT NULL default '0',
   `image_max_size_y` int(8) NOT NULL default '0',
+  show_source CHAR(1) NOT NULL DEFAULT 'o',
   PRIMARY KEY (`galleryId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 

------------------------------------------------------------------------
r34888 | jonnybradley | 2011-06-10 06:32:16 -0400 (sex, 10 jun 2011) | 4 lines

[MRG] Automatic merge, branches/7.x 34852 to 34885
Conflicts:  lang/de/language.php and lang/pt-br/language.php resolved using "mine full"
            lib/setup/twversion.class.php and lib/setup/perms.php fixed manually


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 34887)
+++ tiki.sql	(revision 34888)
@@ -1679,20 +1679,10 @@
   `active` char(1) default NULL,
   `publishDate` int(14) default NULL,
   `voteConsiderationSpan` int(4) default 0,
-    `anonym` ENUM( 'a', 'u', 'i', 'c' ) NOT NULL DEFAULT 'u',
   PRIMARY KEY (`pollId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 ALTER TABLE tiki_polls ADD INDEX tiki_poll_lookup ( active , title );
 
-CREATE TABLE IF NOT EXISTS `tiki_poll_votes` (
-  `pollId` int(11) NOT NULL,
-  `optionId` int(11) NOT NULL,
-  `voteId` int(11) NOT NULL auto_increment,
-  `identification` varchar(300) NOT NULL,
-  `time` int(11) NOT NULL,
-  PRIMARY KEY  (`voteId`)
-) ENGINE=MyISAM AUTO_INCREMENT=1 ;
-
 DROP TABLE IF EXISTS `tiki_preferences`;
 CREATE TABLE `tiki_preferences` (
   `name` varchar(40) NOT NULL default '',
@@ -2629,7 +2619,7 @@
 
 
 INSERT INTO users_grouppermissions (`groupName`,`permName`)
-	VALUES('Anonymous','tiki_p_view'),('Anonymous','tiki_p_search'),('Anonymous','tiki_p_download_files');
+    VALUES('Anonymous','tiki_p_view'),('Anonymous','tiki_p_search'),('Anonymous','tiki_p_download_files');
 
 DROP TABLE IF EXISTS `users_groups`;
 CREATE TABLE `users_groups` (

------------------------------------------------------------------------
r34808 | jonnybradley | 2011-06-07 09:26:59 -0400 (ter, 07 jun 2011) | 1 line

[MRG] Automatic merge, branches/7.x 34741 to 34806

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 34807)
+++ tiki.sql	(revision 34808)
@@ -3666,3 +3666,11 @@
     KEY `queue_name_ix` (`queue`),
     KEY `queue_handler_ix` (`handler`)
 ) ENGINE=MyISAM;
+
+DROP TABLE IF EXISTS `tiki_cart_inventory_hold`;
+CREATE TABLE `tiki_cart_inventory_hold` (
+    `productId` INT( 14 ) NOT NULL,
+    `quantity` INT( 14 ) NOT NULL,
+    `timeHeld` INT( 14 ) NOT NULL,
+    `hash` CHAR( 32 ) NOT NULL
+);

------------------------------------------------------------------------
r34782 | sept_7 | 2011-06-06 06:22:57 -0400 (seg, 06 jun 2011) | 3 lines

[FIX] Ip logging in many table too short for IPv6 reported by canelli
 Now IP fields are 39 character wide.


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 34781)
+++ tiki.sql	(revision 34782)
@@ -541,7 +541,7 @@
   `hash` varchar(32) default NULL,
   `email` varchar(200) default NULL,
   `website` varchar(200) default NULL,
-  `user_ip` varchar(15) default NULL,
+  `user_ip` varchar(39) default NULL,
   `summary` varchar(240) default NULL,
   `smiley` varchar(80) default NULL,
   `message_id` varchar(128) default NULL,
@@ -1029,7 +1029,7 @@
   `lastModif` int(14) default NULL,
   `description` varchar(200) default NULL,
   `user` varchar(200) not null default '',
-  `ip` varchar(15) default NULL,
+  `ip` varchar(39) default NULL,
   `comment` varchar(200) default NULL,
   `data` longblob,
   `type` varchar(50) default NULL,
@@ -1620,7 +1620,7 @@
   `version` int(8) NOT NULL default '0',
   `version_minor` int(8) NOT NULL default '0',
   `user` varchar(200) default '',
-  `ip` varchar(15) default NULL,
+  `ip` varchar(39) default NULL,
   `flag` char(1) default NULL,
   `points` int(8) default NULL,
   `votes` int(8) default NULL,
@@ -2145,7 +2145,7 @@
   `comment` varchar(200) default NULL,
   `version` int(8) NOT NULL default '0',
   `user` varchar(200) NOT NULL default '',
-  `ip` varchar(15) default NULL,
+  `ip` varchar(39) default NULL,
   `flag` char(1) default NULL,
   PRIMARY KEY (`tagName`,`pageName`)
 ) ENGINE=MyISAM;
@@ -2505,7 +2505,7 @@
 DROP TABLE IF EXISTS `tiki_user_votings`;
 CREATE TABLE `tiki_user_votings` (
   `user` varchar(200) NOT NULL default '',
-  `ip` varchar(15) default NULL,
+  `ip` varchar(39) default NULL,
   `id` varchar(255) NOT NULL default '',
   `optionId` int(10) NOT NULL default 0,
   `time` int(14) NOT NULL default 0,

------------------------------------------------------------------------
r34753 | lphuberdeau | 2011-06-03 16:40:05 -0400 (sex, 03 jun 2011) | 1 line

[MOD] Convert tracker comments to standard comments and use the AJAX interface

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 34752)
+++ tiki.sql	(revision 34753)
@@ -2233,17 +2233,6 @@
   INDEX `itemId` (`itemId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
-DROP TABLE IF EXISTS `tiki_tracker_item_comments`;
-CREATE TABLE `tiki_tracker_item_comments` (
-  `commentId` int(12) NOT NULL auto_increment,
-  `itemId` int(12) NOT NULL default '0',
-  `user` varchar(200) default NULL,
-  `data` text,
-  `title` varchar(200) default NULL,
-  `posted` int(14) default NULL,
-  PRIMARY KEY (`commentId`)
-) ENGINE=MyISAM AUTO_INCREMENT=1 ;
-
 DROP TABLE IF EXISTS `tiki_tracker_item_fields`;
 CREATE TABLE `tiki_tracker_item_fields` (
   `itemId` int(12) NOT NULL default '0',

------------------------------------------------------------------------
r34674 | marclaporte | 2011-05-27 16:47:55 -0400 (sex, 27 mai 2011) | 1 line

cosmetic re-ordering a db entry

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 34673)
+++ tiki.sql	(revision 34674)
@@ -332,7 +332,6 @@
   UNIQUE KEY `catname` (`calendarId`, `name`(16))
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
-DROP TABLE IF EXISTS `tiki_calendar_items`;
 DROP TABLE IF EXISTS `tiki_calendar_recurrence`;
 CREATE TABLE `tiki_calendar_recurrence` (
   `recurrenceId` int(14) NOT NULL auto_increment,
@@ -365,6 +364,7 @@
   KEY `calendarId` (`calendarId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
+DROP TABLE IF EXISTS `tiki_calendar_items`;
 CREATE TABLE `tiki_calendar_items` (
   `calitemId` int(14) NOT NULL auto_increment,
   `calendarId` int(14) NOT NULL default '0',

------------------------------------------------------------------------
r34579 | sampaioprimo | 2011-05-23 14:47:42 -0400 (seg, 23 mai 2011) | 1 line

[MRG] Automatic merge, branches/7.x 34565 to 34576

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 34578)
+++ tiki.sql	(revision 34579)
@@ -2425,8 +2425,6 @@
   PRIMARY KEY (`name`)
 ) ENGINE=MyISAM;
 
-INSERT INTO tiki_user_modules (name, title, data, parse) VALUES ('Application Menu', 'Menu', '{menu id=42 css=y type=vert}', 'n');
-
 DROP TABLE IF EXISTS `tiki_user_notes`;
 CREATE TABLE `tiki_user_notes` (
   `user` varchar(200) NOT NULL default '',

------------------------------------------------------------------------
r34503 | sylvieg | 2011-05-19 09:42:26 -0400 (qui, 19 mai 2011) | 1 line

[MRG] Automatic merge, branches/7.x 34460 to 34501

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 34502)
+++ tiki.sql	(revision 34503)
@@ -3498,7 +3498,6 @@
   KEY `used_on_user` (`used_on_user`)
 ) ENGINE=MyISAM;
 
-
 DROP TABLE IF EXISTS `tiki_credits`;
 CREATE TABLE `tiki_credits` (
     `creditId` INT UNSIGNED NOT NULL AUTO_INCREMENT ,

------------------------------------------------------------------------
r34401 | sylvieg | 2011-05-13 14:18:50 -0400 (sex, 13 mai 2011) | 1 line

[ENH]banner: now pref to display a banner of a zone except in some URIs

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 34400)
+++ tiki.sql	(revision 34401)
@@ -216,6 +216,7 @@
   `clicks` int(8) default NULL,
   `zone` varchar(40) default NULL,
   `onlyInURIs` text,
+  `exceptInURIs` text,
   PRIMARY KEY (`bannerId`),
   INDEX ban1(zone,`useDates`,impressions,`maxImpressions`,`hourFrom`,`hourTo`,`fromDate`,`toDate`,mon,tue,wed,thu,fri,sat,sun)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;

------------------------------------------------------------------------
r34066 | jonnybradley | 2011-04-21 13:21:06 -0400 (qui, 21 abr 2011) | 1 line

[MRG] Automatic merge, branches/7.x 34027 to 34065

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 34065)
+++ tiki.sql	(revision 34066)
@@ -1904,36 +1904,6 @@
   PRIMARY KEY (`name`,`rssVer`)
 ) ENGINE=MyISAM;
 
-DROP TABLE IF EXISTS `tiki_searchindex`;
-CREATE TABLE tiki_searchindex(
-  `searchword` varchar(80) NOT NULL default '',
-  `location` varchar(80) NOT NULL default '',
-  `page` varchar(255) NOT NULL default '',
-  `count` int(11) NOT NULL default '1',
-  `last_update` int(11) NOT NULL default '0',
-  PRIMARY KEY (`searchword`,`location`,`page`(80)),
-  KEY `last_update` (last_update),
-  KEY `location` (location(50), page(200))
-) ENGINE=MyISAM;
-
--- LRU (last recently used) list for searching parts of words
-DROP TABLE IF EXISTS `tiki_searchsyllable`;
-CREATE TABLE tiki_searchsyllable(
-  `syllable` varchar(80) NOT NULL default '',
-  `lastUsed` int(11) NOT NULL default '0',
-  `lastUpdated` int(11) NOT NULL default '0',
-  PRIMARY KEY (`syllable`),
-  KEY `lastUsed` (`lastUsed`)
-) ENGINE=MyISAM;
-
--- searchword caching table for search syllables
-DROP TABLE IF EXISTS `tiki_searchwords`;
-CREATE TABLE tiki_searchwords(
-  `syllable` varchar(80) NOT NULL default '',
-  `searchword` varchar(80) NOT NULL default '',
-  PRIMARY KEY (`syllable`,`searchword`)
-) ENGINE=MyISAM;
-
 DROP TABLE IF EXISTS `tiki_search_stats`;
 CREATE TABLE `tiki_search_stats` (
   `term` varchar(50) NOT NULL default '',

------------------------------------------------------------------------
r34052 | lphuberdeau | 2011-04-20 12:38:32 -0400 (qua, 20 abr 2011) | 1 line

[MOD]Â Add an option to include or not the inherited groups in mailing list, and displaying the inherited groups in the list to make it more obvious

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 34051)
+++ tiki.sql	(revision 34052)
@@ -1556,6 +1556,7 @@
   `nlId` int(12) NOT NULL default '0',
   `groupName` varchar(255) NOT NULL default '',
   `code` varchar(32) default NULL,
+  `include_groups` char(1) DEFAULT 'y',
   PRIMARY KEY (`nlId`,`groupName`)
 ) ENGINE=MyISAM;
 

------------------------------------------------------------------------
r33953 | jonnybradley | 2011-04-14 09:44:55 -0400 (qui, 14 abr 2011) | 1 line

[MRG] Automatic merge, branches/7.x 33907 to 33946

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 33952)
+++ tiki.sql	(revision 33953)
@@ -266,7 +266,7 @@
   `trackbacks_to` text,
   `trackbacks_from` text,
   `title` varchar(255) default NULL,
-  `priv` varchar(1) default NULL,
+  `priv` varchar(1) default 'n',
   `wysiwyg` varchar(1) default NULL,
   PRIMARY KEY (`postId`),
   KEY `data` (`data`(255)),

------------------------------------------------------------------------
r33934 | lphuberdeau | 2011-04-12 16:27:14 -0400 (ter, 12 abr 2011) | 1 line

[MOD] Moving permission definitions out of the database, removing tiki-assignpermissions.php (phased out since 4), killing a few functions that were no longer used (instead of rewriting them), might still need to fix quickperms

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 33933)
+++ tiki.sql	(revision 33934)
@@ -2707,305 +2707,10 @@
 DROP TABLE IF EXISTS `users_permissions`;
 CREATE TABLE `users_permissions` (
   `permName` varchar(40) NOT NULL default '',
-  `permDesc` varchar(250) default NULL,
   `level` varchar(80) default NULL,
-  `type` varchar(20) default NULL,
-  `admin` varchar(1) default NULL,
-  `feature_check` varchar(255) default NULL,
-  PRIMARY KEY  (`permName`),
-  KEY `type` (`type`)
+  PRIMARY KEY  (`permName`)
 ) ENGINE=MyISAM;
 
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_calendar', 'Can create/admin calendars', 'admin', 'calendar', 'y', 'feature_calendar');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_add_events', 'Can add events in the calendar', 'registered', 'calendar', NULL, 'feature_calendar');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_change_events', 'Can change events in the calendar', 'registered', 'calendar', NULL, 'feature_calendar');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_calendar', 'Can browse the calendar', 'basic', 'calendar', NULL, 'feature_calendar');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_events', 'Can view events details', 'registered', 'calendar', NULL, 'feature_calendar');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_calendar_add_my_particip', 'Can add own user to the participants', 'registered', 'calendar', NULL, 'feature_calendar');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_calendar_add_guest_particip', 'Can add guest to the participants', 'registered', 'calendar', NULL, 'feature_calendar');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_tiki_calendar', 'Can view Tiki tools calendar', 'basic', 'calendar', NULL, 'feature_calendar');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_chat', 'Administrator, can create channels remove channels etc', 'editors', 'chat', 'y', 'feature_minichat,feature_live_support');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_chat', 'Can use the chat system', 'registered', 'chat', NULL, 'feature_minichat,feature_live_support');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_cms', 'Can admin the articles', 'editors', 'cms', 'y', 'feature_articles');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_approve_submission', 'Can approve submissions', 'editors', 'cms', NULL, 'feature_articles');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_articles_admin_topics', 'Can admin article topics', 'editors', 'cms', NULL, 'feature_articles');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_articles_admin_types', 'Can admin article types', 'editors', 'cms', NULL, 'feature_articles');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_articles_read_heading', 'Can read article headings', 'basic', 'cms', NULL, 'feature_articles');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_autoapprove_submission', 'Submitted articles automatically approved', 'editors', 'cms', NULL, 'feature_articles');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_article', 'Can edit articles', 'editors', 'cms', NULL, 'feature_articles');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_submission', 'Can edit submissions', 'editors', 'cms', NULL, 'feature_articles');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_read_article', 'Can read articles', 'basic', 'cms', NULL, 'feature_articles');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_remove_article', 'Can remove articles', 'editors', 'cms', NULL, 'feature_articles');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_remove_submission', 'Can remove submissions', 'editors', 'cms', NULL, 'feature_articles');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_submit_article', 'Can submit articles', 'basic', 'cms', NULL, 'feature_articles');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_rate_article', 'Can rate articles', 'basic', 'cms', NULL, 'feature_articles');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_topic_read', 'Can read a topic (Applies only to individual topic perms)', 'basic', 'cms', NULL, 'feature_articles');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_contribution', 'Can admin contributions', 'admin', 'contribution', 'y', 'feature_contribution');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_directory', 'Can admin the directory', 'editors', 'directory', 'y', 'feature_directory');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_directory_cats', 'Can admin directory categories', 'editors', 'directory', NULL, 'feature_directory');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_directory_sites', 'Can admin directory sites', 'editors', 'directory', NULL, 'feature_directory');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_autosubmit_link', 'Submitted links are valid', 'editors', 'directory', NULL, 'feature_directory');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_submit_link', 'Can submit sites to the directory', 'basic', 'directory', NULL, 'feature_directory');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_validate_links', 'Can validate submitted links', 'editors', 'directory', NULL, 'feature_directory');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_directory', 'Can use the directory', 'basic', 'directory', NULL, 'feature_directory');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_faqs', 'Can admin faqs', 'editors', 'faqs', 'y', 'feature_faqs');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_suggest_faq', 'Can suggest faq questions', 'basic', 'faqs', NULL, 'feature_faqs');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_faqs', 'Can view faqs', 'basic', 'faqs', NULL, 'feature_faqs');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin', 'Administrator, can manage users groups and permissions, and all features', 'admin', 'tiki', 'y', NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_users', 'Can admin users', 'admin', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_access_closed_site', 'Can access site when closed', 'admin', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_banners', 'Administrator, can admin banners', 'admin', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_banning', 'Can ban users or ips', 'admin', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_dynamic', 'Can admin the dynamic content system', 'editors', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_integrator', 'Can admin integrator repositories and rules', 'admin', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_mailin', 'Can admin mail-in accounts', 'admin', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_objects', 'Can edit object permissions', 'admin', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_rssmodules', 'Can admin external feeds', 'admin', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_clean_cache', 'Can clean cache', 'editors', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_create_css', 'Can create new css suffixed with -user', 'registered', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_detach_translation', 'Can remove association between two pages in a translation set', 'registered', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_cookies', 'Can admin cookies', 'editors', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_languages', 'Can edit translations and create new languages', 'editors', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_menu', 'Can edit menu', 'admin', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_menu_option', 'Can edit menu option', 'admin', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_templates', 'Can edit site templates', 'admin', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_search', 'Can search', 'basic', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_site_report', 'Can report a link to the webmaster', 'basic', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_subscribe_groups', 'Can subscribe to groups', 'registered', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_tell_a_friend', 'Can send a link to a friend', 'Basic', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_share', 'Can share a page (email, twitter, facebook, message, forums)', 'Basic', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_use_HTML', 'Can use HTML in pages', 'editors', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_actionlog', 'Can view action log', 'registered', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_actionlog_owngroups', 'Can view action log for users of his own groups', 'registered', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_integrator', 'Can view integrated repositories', 'basic', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_referer_stats', 'Can view referrer stats', 'editors', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_stats', 'Can view site stats', 'basic', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_templates', 'Can view site templates', 'admin', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_blog_admin', 'Can admin blogs', 'editors', 'blogs', 'y', 'feature_blogs');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_assign_perm_blog', 'Can assign perms to blog', 'admin', 'blogs', NULL, 'feature_blogs');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_blog_post', 'Can post to a blog', 'registered', 'blogs', NULL, 'feature_blogs');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_create_blogs', 'Can create a blog', 'editors', 'blogs', NULL, 'feature_blogs');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_read_blog', 'Can read blogs', 'basic', 'blogs', NULL, 'feature_blogs');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_blog_post_view_ref', 'Can view in module and feed the blog posts', 'basic', 'blogs', NULL, 'feature_blogs');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_blog_view_ref', 'Can view in module and feed the blog', 'basic', 'blogs', NULL, 'feature_blogs');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_file_galleries', 'Can admin file galleries', 'editors', 'file galleries', 'y', 'feature_file_galleries');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_assign_perm_file_gallery', 'Can assign perms to file gallery', 'admin', 'file galleries', NULL, 'feature_file_galleries');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_batch_upload_file_dir', 'Can use Directory Batch Load', 'editors', 'file galleries', NULL, 'feature_file_galleries');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_batch_upload_files', 'Can upload zip files with files', 'editors', 'file galleries', NULL, 'feature_file_galleries');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_create_file_galleries', 'Can create file galleries', 'editors', 'file galleries', NULL, 'feature_file_galleries');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_download_files', 'Can download files', 'basic', 'file galleries', NULL, 'feature_file_galleries');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_gallery_file', 'Can edit a gallery file', 'editors', 'file galleries', NULL, 'feature_file_galleries');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_list_file_galleries', 'Can list file galleries', 'basic', 'file galleries', NULL, 'feature_file_galleries');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_upload_files', 'Can upload files', 'registered', 'file galleries', NULL, 'feature_file_galleries');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_remove_files', 'Can remove files', 'registered', 'file galleries', NULL, 'feature_file_galleries');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_fgal_explorer', 'Can view file galleries explorer', 'basic', 'file galleries', NULL, 'feature_file_galleries');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_fgal_path', 'Can view file galleries path', 'basic', 'file galleries', NULL, 'feature_file_galleries');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_file_gallery', 'Can view file galleries', 'basic', 'file galleries', NULL, 'feature_file_galleries');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_forum', 'Can admin forums', 'editors', 'forums', 'y', 'feature_forums');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_forum_attach', 'Can attach to forum posts', 'registered', 'forums', NULL, 'feature_forums');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_forum_autoapp', 'Auto approve forum posts', 'editors', 'forums', NULL, 'feature_forums');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_forum_edit_own_posts', 'Can edit own forum posts', 'registered', 'forums', NULL, 'feature_forums');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_forum_post', 'Can post in forums', 'registered', 'forums', NULL, 'feature_forums');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_forum_post_topic', 'Can start threads in forums', 'registered', 'forums', NULL, 'feature_forums');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_forum_read', 'Can read forums', 'basic', 'forums', NULL, 'feature_forums');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_forums_report', 'Can report posts to moderator', 'registered', 'forums', NULL, 'feature_forums');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_forum_vote', 'Can vote comments in forums', 'registered', 'forums', NULL, 'feature_forums');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_freetags', 'Can admin freetags', 'admin', 'freetags', 'y', 'feature_freetags');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_galleries', 'Can admin Image Galleries', 'editors', 'image galleries', 'y', 'feature_galleries');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_assign_perm_image_gallery', 'Can assign perms to image gallery', 'admin', 'image galleries', NULL, 'feature_galleries');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_batch_upload_image_dir', 'Can use Directory Batch Load', 'editors', 'image galleries', NULL, 'feature_galleries');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_batch_upload_images', 'Can upload zip files with images', 'editors', 'image galleries', NULL, 'feature_galleries');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_create_galleries', 'Can create image galleries', 'editors', 'image galleries', NULL, 'feature_galleries');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_freetags_tag', 'Can tag objects', 'registered', 'freetags', NULL, 'feature_freetags');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_list_image_galleries', 'Can list image galleries', 'basic', 'image galleries', NULL, 'feature_galleries');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_unassign_freetags', 'Can unassign tags from an object', 'basic', 'freetags', NULL, 'feature_freetags');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_upload_images', 'Can upload images', 'registered', 'image galleries', NULL, 'feature_galleries');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_freetags', 'Can browse freetags', 'basic', 'freetags', NULL, 'feature_freetags');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_image_gallery', 'Can view image galleries', 'basic', 'image galleries', NULL, 'feature_galleries');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_newsletters', 'Can admin newsletters', 'admin', 'newsletters', 'y', 'feature_newsletters');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_batch_subscribe_email', 'Can subscribe many e-mails at once (requires tiki_p_subscribe email)', 'editors', 'newsletters', NULL, 'feature_newsletters');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_send_newsletters', 'Can send newsletters', 'editors', 'newsletters', NULL, 'feature_newsletters');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_subscribe_email', 'Can subscribe any email to newsletters', 'editors', 'newsletters', NULL, 'feature_newsletters');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_subscribe_newsletters', 'Can subscribe to newsletters', 'basic', 'newsletters', NULL, 'feature_newsletters');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_newsletter', 'Can view the archive of a newsletters', 'basic', 'newsletters', NULL, 'feature_newsletters');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_list_newsletters', 'Can list newsletters', 'basic', 'newsletters', NULL, 'feature_newsletters');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_polls', 'Can admin polls', 'admin', 'polls', 'y', 'feature_polls');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_poll_results', 'Can view poll results', 'basic', 'polls', NULL, 'feature_polls');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_vote_poll', 'Can vote polls', 'basic', 'polls', NULL, 'feature_polls');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_poll_voters', 'Can view poll voters', 'basic', 'polls', NULL, 'feature_polls');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_toolbars', 'Can admin toolbars', 'admin', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_quizzes', 'Can admin quizzes', 'editors', 'quizzes', 'y', 'feature_quizzes');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_take_quiz', 'Can take quizzes', 'basic', 'quizzes', NULL, 'feature_quizzes');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_quiz_stats', 'Can view quiz stats', 'basic', 'quizzes', NULL, 'feature_quizzes');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_user_results', 'Can view user quiz results', 'editors', 'quizzes', NULL, 'feature_quizzes');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_sheet', 'Can admin sheet', 'admin', 'sheet', 'y', 'feature_sheet');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_sheet', 'Can create and edit sheets', 'editors', 'sheet', NULL, 'feature_sheet');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_sheet', 'Can view sheet', 'basic', 'sheet', NULL, 'feature_sheet');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_sheet_history', 'Can view sheet history', 'admin', 'sheet', NULL, 'feature_sheet');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_shoutbox', 'Can admin shoutbox (Edit/remove messages)', 'editors', 'shoutbox', 'y', 'feature_shoutbox');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_post_shoutbox', 'Can post messages in shoutbox', 'basic', 'shoutbox', NULL, 'feature_shoutbox');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_shoutbox', 'Can view shoutbox', 'basic', 'shoutbox', NULL, 'feature_shoutbox');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_surveys', 'Can admin surveys', 'editors', 'surveys', 'y', 'feature_surveys');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_take_survey', 'Can take surveys', 'basic', 'surveys', NULL, 'feature_surveys');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_survey_stats', 'Can view survey stats', 'basic', 'surveys', NULL, 'feature_surveys');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_trackers', 'Can admin trackers', 'editors', 'trackers', 'y', 'feature_trackers');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_attach_trackers', 'Can attach files to tracker items', 'registered', 'trackers', NULL, 'feature_trackers');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_tracker_view_attachments', 'Can view tracker items attachments and download', 'registered', 'trackers', NULL, 'feature_trackers');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_comment_tracker_items', 'Can insert comments for tracker items', 'basic', 'trackers', NULL, 'feature_trackers');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_tracker_view_comments', 'Can view tracker items comments', 'basic', 'trackers', NULL, 'feature_trackers');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_create_tracker_items', 'Can create new items for trackers', 'registered', 'trackers', NULL, 'feature_trackers');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_list_trackers', 'Can list trackers', 'basic', 'trackers', NULL, 'feature_trackers');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_modify_tracker_items', 'Can change tracker items', 'registered', 'trackers', NULL, 'feature_trackers');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_modify_tracker_items_pending', 'Can change pending tracker items', 'registered', 'trackers', NULL, 'feature_trackers');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_modify_tracker_items_closed', 'Can change closed tracker items', 'registered', 'trackers', NULL, 'feature_trackers');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_remove_tracker_items', 'Can remove tracker items', 'registered', 'trackers', NULL, 'feature_trackers');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_remove_tracker_items_pending', 'Can remove pending tracker items', 'registered', 'trackers', NULL, 'feature_trackers');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_remove_tracker_items_closed', 'Can remove closed tracker items', 'registered', 'trackers', NULL, 'feature_trackers');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_tracker_view_ratings', 'Can view rating result for tracker items', 'basic', 'trackers', NULL, 'feature_trackers');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_tracker_vote_ratings', 'Can vote a rating for tracker items', 'registered', 'trackers', NULL, 'feature_trackers');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_tracker_revote_ratings', 'Can re-vote a rating for tracker items', 'registered', 'trackers', NULL, 'feature_trackers');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_trackers', 'Can view trackers', 'basic', 'trackers', NULL, 'feature_trackers');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_trackers_closed', 'Can view closed trackers items', 'registered', 'trackers', NULL, 'feature_trackers');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_trackers_pending', 'Can view pending trackers items', 'editors', 'trackers', NULL, 'feature_trackers');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_watch_trackers', 'Can watch tracker', 'registered', 'trackers', NULL, 'feature_trackers');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_export_tracker', 'Can export tracker items', 'registered', 'trackers', NULL, 'feature_trackers');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_wiki', 'Can admin the wiki', 'editors', 'wiki', 'y', 'feature_wiki');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_assign_perm_wiki_page', 'Can assign perms to wiki pages', 'admin', 'wiki', NULL, 'feature_wiki');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit', 'Can edit pages', 'registered', 'wiki', NULL, 'feature_wiki');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_copyrights', 'Can edit copyright notices', 'editors', 'wiki', NULL, 'wiki_feature_copyrights');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_dynvar', 'Can edit dynamic variables', 'editors', 'wiki', NULL, 'feature_wiki');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_structures', 'Can create and edit structures', 'editors', 'wiki', NULL, 'feature_wiki_structure');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_export_wiki', 'Can export wiki pages using the export feature', 'admin', 'wiki', NULL, 'feature_wiki_export');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_lock', 'Can lock pages', 'editors', 'wiki', NULL, 'feature_wiki');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_minor', 'Can save as minor edit', 'registered', 'wiki', NULL, 'feature_wiki');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_remove', 'Can remove', 'editors', 'wiki', NULL, 'feature_wiki');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_rename', 'Can rename pages', 'editors', 'wiki', NULL, 'feature_wiki');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_rollback', 'Can rollback pages', 'editors', 'wiki', NULL, 'feature_wiki');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_upload_picture', 'Can upload pictures to wiki pages', 'registered', 'wiki', NULL, 'feature_wiki_pictures');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_use_as_template', 'Can use the page as a tracker template', 'basic', 'wiki', NULL, 'feature_wiki');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view', 'Can view page/pages', 'basic', 'wiki', NULL, 'feature_wiki');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_wiki_view_ref', 'Can view in module and feed the wiki pages reference', 'basic', 'wiki', NULL, 'feature_wiki');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_watch_structure', 'Can watch structure', 'registered', 'wiki', NULL, 'feature_wiki_structure');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_wiki_admin_attachments', 'Can admin attachments on wiki pages', 'editors', 'wiki', NULL, 'feature_wiki_attachments');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_wiki_admin_ratings', 'Can add and change ratings on wiki pages', 'admin', 'wiki', NULL, 'feature_wiki_ratings');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_wiki_attach_files', 'Can attach files to wiki pages', 'registered', 'wiki', NULL, 'feature_wiki_attachments');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_wiki_view_attachments', 'Can view wiki attachments and download', 'registered', 'wiki', NULL, 'feature_wiki_attachments');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_wiki_view_comments', 'Can view wiki comments', 'basic', 'wiki', NULL, 'feature_wiki_comments');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_wiki_view_history', 'Can view wiki history', 'basic', 'wiki', NULL, 'feature_history');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_wiki_view_ratings', 'Can view rating of wiki pages', 'basic', 'wiki', NULL, 'feature_wiki_ratings');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_wiki_view_source', 'Can view source of wiki pages', 'basic', 'wiki', NULL, 'feature_source');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_wiki_vote_ratings', 'Can participate to rating of wiki pages', 'registered', 'wiki', NULL, 'feature_wiki_ratings');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_wiki_view_similar', 'Can view similar wiki pages', 'registered', 'wiki', NULL, 'feature_wiki');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_received_articles', 'Can admin received articles', 'editors', 'comm', NULL, 'feature_comm');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_received_pages', 'Can admin received pages', 'editors', 'comm', NULL, 'feature_comm');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_send_articles', 'Can send articles to other sites', 'editors', 'comm', NULL, 'feature_comm');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_sendme_articles', 'Can send articles to this site', 'registered', 'comm', NULL, 'feature_comm');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_sendme_pages', 'Can send pages to this site', 'registered', 'comm', NULL, 'feature_comm');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_send_pages', 'Can send pages to other sites', 'registered', 'comm', NULL, 'feature_comm');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_tikitests', 'Can admin the TikiTests', 'admin', 'tikitests', NULL, 'feature_tikitests');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_tikitests', 'Can edit TikiTests', 'editors', 'tikitests', NULL, 'feature_tikitests');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_play_tikitests', 'Can replay the TikiTests', 'registered', 'tikitests', NULL, 'feature_tikitests');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_cache_bookmarks', 'Can cache user bookmarks', 'admin', 'user', NULL, 'feature_user_bookmarks');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_configure_modules', 'Can configure modules', 'registered', 'user', NULL, 'feature_modulecontrols');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_create_bookmarks', 'Can create user bookmarks', 'registered', 'user', NULL, 'feature_user_bookmarks');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_minical', 'Can use the mini event calendar', 'registered', 'user', NULL, 'feature_minical');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_notepad', 'Can use the notepad', 'registered', 'user', NULL, 'feature_notepad');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_tasks_admin', 'Can admin public tasks', 'admin', 'user', NULL, 'feature_tasks');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_tasks', 'Can use tasks', 'registered', 'user', NULL, 'feature_tasks');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_tasks_receive', 'Can receive tasks from other users', 'registered', 'user', NULL, 'feature_tasks');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_tasks_send', 'Can send tasks to other users', 'registered', 'user', NULL, 'feature_tasks');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_userfiles', 'Can upload personal files', 'registered', 'user', NULL, 'feature_userfiles');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_usermenu', 'Can create items in personal menu', 'registered', 'user', NULL, 'feature_usermenu');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_broadcast_all', 'Can broadcast messages to all user', 'admin', 'messu', NULL, 'feature_messages');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_broadcast', 'Can broadcast messages to groups', 'admin', 'messu', NULL, 'feature_messages');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_messages', 'Can use the messaging system', 'registered', 'messu', NULL, 'feature_messages');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_comments', 'Can admin comments', 'admin', 'comments', 'y', 'feature_wiki_comments,feature_blogposts_comments,feature_file_galleries_comments,feature_image_galleries_comments,feature_article_comments,feature_faq_comments,feature_poll_comments,map_comments');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_comments', 'Can edit all comments', 'editors', 'comments', NULL, 'feature_wiki_comments,feature_blogposts_comments,feature_file_galleries_comments,feature_image_galleries_comments,feature_article_comments,feature_faq_comments,feature_poll_comments,map_comments');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_post_comments', 'Can post new comments', 'registered', 'comments', NULL, 'feature_wiki_comments,feature_blogposts_comments,feature_file_galleries_comments,feature_image_galleries_comments,feature_article_comments,feature_faq_comments,feature_poll_comments,map_comments');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_read_comments', 'Can read comments', 'basic', 'comments', NULL, 'feature_wiki_comments,feature_blogposts_comments,feature_file_galleries_comments,feature_image_galleries_comments,feature_article_comments,feature_faq_comments,feature_poll_comments,map_comments');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_remove_comments', 'Can delete comments', 'editors', 'comments', NULL, 'feature_wiki_comments,feature_blogposts_comments,feature_file_galleries_comments,feature_image_galleries_comments,feature_article_comments,feature_faq_comments,feature_poll_comments,map_comments');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_vote_comments', 'Can vote comments', 'registered', 'comments', NULL, 'feature_wiki_comments,feature_blogposts_comments,feature_file_galleries_comments,feature_image_galleries_comments,feature_article_comments,feature_faq_comments,feature_poll_comments,map_comments');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_content_templates', 'Can admin content templates', 'admin', 'content templates', 'y', 'feature_wiki_templates,feature_cms_templates');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_content_templates', 'Can edit content templates', 'editors', 'content templates', NULL, 'feature_wiki_templates,feature_cms_templates');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_use_content_templates', 'Can use content templates', 'registered', 'content templates', NULL, 'feature_wiki_templates,feature_cms_templates');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_html_pages', 'Can edit HTML pages', 'editors', 'html pages', NULL, 'feature_html_pages');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_html_pages', 'Can view HTML pages', 'basic', 'html pages', NULL, 'feature_html_pages');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_list_users', 'Can list registered users', 'registered', 'user', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_live_support_admin', 'Admin live support system', 'admin', 'support', 'y', 'feature_live_support');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_live_support', 'Can use live support system', 'basic', 'support', NULL, 'feature_live_support');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_map_create', 'Can create new mapfile', 'admin', 'maps', NULL, 'feature_maps');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_map_delete', 'Can delete mapfiles', 'admin', 'maps', NULL, 'feature_maps');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_map_edit', 'Can edit mapfiles', 'editors', 'maps', NULL, 'feature_maps');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_map_view', 'Can view mapfiles', 'basic', 'maps', NULL, 'feature_maps');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_map_view_mapfiles', 'Can view contents of mapfiles', 'registered', 'maps', NULL, 'feature_maps');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_use_webmail', 'Can use webmail', 'registered', 'webmail', NULL, 'feature_webmail,feature_contacts');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_use_group_webmail', 'Can use group webmail', 'registered', 'webmail', NULL, 'feature_webmail,feature_contacts');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_group_webmail', 'Can admin group webmail accounts', 'registered', 'webmail', NULL, 'feature_webmail,feature_contacts');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_use_personal_webmail', 'Can use personal webmail accounts', 'registered', 'webmail', NULL, 'feature_webmail,feature_contacts');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_personal_webmail', 'Can admin personal webmail accounts', 'registered', 'webmail', NULL, 'feature_webmail,feature_contacts');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_plugin_viewdetail', 'Can view unapproved plugin details', 'registered', 'wiki', NULL, 'feature_wiki');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_plugin_preview', 'Can execute unapproved plugin', 'registered', 'wiki', NULL, 'feature_wiki');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_plugin_approve', 'Can approve plugin execution', 'editors', 'wiki', NULL, 'feature_wiki');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_trust_input', 'Trust all user inputs including plugins (no security checks)', 'admin', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_backlink', 'View page backlinks', 'basic', 'wiki', NULL, 'feature_wiki');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_notifications', 'Can admin mail notifications', 'editors', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_invite_to_my_groups', 'Can invite user to my groups', 'editors', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_delete_account', 'Can delete his/her own account', 'admin', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_importer', 'Can use the importer', 'admin', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_categories', 'Can admin categories', 'editors', 'category', 'y', 'feature_categories');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_category', 'Can see the category in a listing', 'basic', 'category', NULL, 'feature_categories');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_modify_object_categories', 'Can change the categories of the object', 'editors', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_add_object', 'Can add objects to the category (needs tiki_p_modify_object_categories)', 'editors', 'category', NULL, 'feature_categories');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_remove_object', 'Can remove objects from the category (needs tiki_p_modify_object_categories)', 'editors', 'category', NULL, 'feature_categories');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_create_category', 'Can create new categories', 'admin', 'category', NULL, 'feature_categories');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_perspective_view', 'Can view the perspective', 'basic', 'perspective', NULL, 'feature_perspective');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_perspective_edit', 'Can edit the perspective', 'basic', 'perspective', NULL, 'feature_perspective');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_perspective_create', 'Can create a perspective', 'basic', 'perspective', NULL, 'feature_perspective');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_perspective_admin', 'Can admin perspectives', 'admin', 'perspective', 'y', 'feature_perspective');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_group_view', 'Can view the group', 'basic', 'group', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_group_view_members', 'Can view the group members', 'basic', 'group', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_group_add_member', 'Can add group members', 'admin', 'group', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_group_remove_member', 'Can remove group members', 'admin', 'group', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_group_join', 'Can join or leave the group', 'admin', 'group', NULL, NULL);
-
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_trigger_transition', 'Can trigger the transition between two states', 'admin', 'transition', NULL, 'feature_group_transition,feature_category_transition');
-
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_kaltura', 'Can admin kaltura feature', 'admin', 'kaltura', 'y', 'feature_kaltura');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_upload_videos', 'Can upload video on kaltura server', 'editors', 'kaltura', NULL, 'feature_kaltura');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_videos', 'Can edit information of kaltura entry', 'editors', 'kaltura', NULL, 'feature_kaltura');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_remix_videos', 'Can create kaltura remix video', 'editors', 'kaltura', NULL, 'feature_kaltura');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_delete_videos', 'Can delete kaltura entry', 'editors', 'kaltura', NULL, 'feature_kaltura');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_download_videos', 'Can download kaltura entry', 'registered', 'kaltura', NULL, 'feature_kaltura');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_list_videos', 'Can list kaltura entries', 'basic', 'kaltura', NULL, 'feature_kaltura');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_videos', 'Can view kaltura entry', 'basic', 'kaltura', NULL, 'feature_kaltura');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_dsn_query', 'Can execute arbitrary queries on a given DSN', 'admin', 'dsn', NULL, NULL);
-
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_admin', 'Can administer payments', 'admin', 'payment', 'y', 'payment_feature');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_view', 'Can view payment requests and details', 'admin', 'payment', NULL, 'payment_feature');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_manual', 'Can enter manual payments', 'admin', 'payment', NULL, 'payment_feature');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_request', 'Can request a payment', 'admin', 'payment', NULL, 'payment_feature');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES ('tiki_p_admin_modules', 'User can administer modules', 'registered', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_tracker_dump', 'Can save a .CSV backup of entire trackers', 'admin', 'trackers', NULL, 'feature_trackers');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_bigbluebutton_join', 'Can join a meeting', 'basic', 'bigbluebutton', NULL, 'bigbluebutton_feature');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_bigbluebutton_moderate', 'Can moderate a meeting', 'admin', 'bigbluebutton', NULL, 'bigbluebutton_feature');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_bigbluebutton_create', 'Can create a meeting', 'admin', 'bigbluebutton', NULL, 'bigbluebutton_feature');
-
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_socialnetworks', 'user can use social network integration', 'registered', 'socialnetworks', NULL, 'feature_socialnetworks');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_socialnetworks', 'user can register this site with social networks', 'admin', 'socialnetworks', 'y', 'feature_socialnetworks');
-
-
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_page_contribution_view', 'Can view contributions to a page', 'basic', 'wiki', NULL, 'feature_wiki');
-
-INSERT INTO `users_permissions` (`permName` , `permDesc` , `level` , `type` , `admin` , `feature_check` ) VALUES ( 'tiki_p_acct_create_book', 'Can create/close a book', 'admin', 'accounting', 'y', 'feature_accounting');
-INSERT INTO `users_permissions` (`permName` , `permDesc` , `level` , `type` , `admin` , `feature_check` ) VALUES ( 'tiki_p_acct_manage_accounts', 'Can create/edit/lock accounts', 'admin', 'accounting', 'y', 'feature_accounting' );
-INSERT INTO `users_permissions` (`permName` , `permDesc` , `level` , `type` , `admin` , `feature_check` ) VALUES ( 'tiki_p_acct_book', 'Create a new transaction', 'editor', 'accounting', 'n', 'feature_accounting');
-INSERT INTO `users_permissions` (`permName` , `permDesc` , `level` , `type` , `admin` , `feature_check` ) VALUES ( 'tiki_p_acct_view', 'Permission to view the journal', 'registered', 'accounting', 'n', 'feature_accounting' );
-INSERT INTO `users_permissions` (`permName` , `permDesc` , `level` , `type` , `admin` , `feature_check` ) VALUES ( 'tiki_p_acct_book_stack', 'Can book into the stack, where statements can be changed', 'editor', 'accounting', 'n', 'feature_accounting');
-INSERT INTO `users_permissions` (`permName` , `permDesc` , `level` , `type` , `admin` , `feature_check` ) VALUES ( 'tiki_p_acct_book_import', 'Can import statements from external accounts', 'editor', 'accounting', 'n', 'feature_accounting' );
-INSERT INTO `users_permissions` (`permName` , `permDesc` , `level` , `type` , `admin` , `feature_check` ) VALUES ( 'tiki_p_acct_manage_template', 'Can manage templates for recurring transactions', 'editor', 'accounting', 'n', 'feature_accounting');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_wiki_view_latest', 'Can view unapproved revisions of pages', 'registered', 'wiki', NULL, 'flaggedrev_approval');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_wiki_approve', 'Can approve revisions of pages', 'editor', 'wiki', NULL, 'flaggedrev_approval');
-
 DROP TABLE IF EXISTS `users_usergroups`;
 CREATE TABLE `users_usergroups` (
   `userId` int(8) NOT NULL default '0',
@@ -3821,7 +3526,6 @@
   KEY `used_on_user` (`used_on_user`)
 ) ENGINE=MyISAM;
 
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES ('tiki_p_invite', 'Can invite users by email, and include them in groups', 'registered', 'tiki', NULL, 'feature_invite');
 
 DROP TABLE IF EXISTS `tiki_credits`;
 CREATE TABLE `tiki_credits` (

------------------------------------------------------------------------
r33912 | sylvieg | 2011-04-11 12:13:23 -0400 (seg, 11 abr 2011) | 1 line

ENH]banner: possibility to display banner of a zone only in some URIs

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 33911)
+++ tiki.sql	(revision 33912)
@@ -215,6 +215,7 @@
   `maxClicks` int(8) default NULL,
   `clicks` int(8) default NULL,
   `zone` varchar(40) default NULL,
+  `onlyInURIs` text,
   PRIMARY KEY (`bannerId`),
   INDEX ban1(zone,`useDates`,impressions,`maxImpressions`,`hourFrom`,`hourTo`,`fromDate`,`toDate`,mon,tue,wed,thu,fri,sat,sun)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;

------------------------------------------------------------------------
r33659 | jonnybradley | 2011-03-25 14:30:22 -0400 (sex, 25 mar 2011) | 1 line

[MRG] Automatic merge, branches/7.x 33652 to 33658

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 33658)
+++ tiki.sql	(revision 33659)
@@ -1532,9 +1532,9 @@
 
 INSERT INTO `tiki_modules` (name,position,ord,cache_time,params,groups) VALUES
     ('menu','l',1,7200,'id=42&flip=y','a:1:{i:0;s:10:"Registered";}'),
-    ('logo','t',1,7200,'nobox=y&style=float%3Aleft%3Bmargin%3A0+30px%3B','a:0:{}'),
-    ('login_box','t',2,0,'mode=header&nobox=y&style=position%3Aabsolute%3Bright%3A30px%3Btop%3A5px%3B','a:0:{}'),
-    ('quickadmin','t',3,7200,'nobox=y&style=position%3A+absolute%3B+right%3A+200px%3B','a:1:{i:0;s:6:"Admins";}'),
+    ('logo','t',1,7200,'nobox=y','a:0:{}'),
+    ('login_box','t',2,0,'mode=popup&nobox=y','a:0:{}'),
+    ('quickadmin','t',3,7200,'nobox=y','a:1:{i:0;s:6:"Admins";}'),
     ('rsslist','b',1,7200,'nobox=y','a:0:{}'),
     ('poweredby','b',2,7200,'nobox=y&icons=n&version=n','a:0:{}');
 

------------------------------------------------------------------------
r33641 | jonnybradley | 2011-03-24 17:12:03 -0400 (qui, 24 mar 2011) | 1 line

[MRG] Automatic merge, branches/7.x 33635 to 33640

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 33640)
+++ tiki.sql	(revision 33641)
@@ -2668,7 +2668,8 @@
 ) ENGINE=MyISAM;
 
 
-INSERT INTO users_grouppermissions (`groupName`,`permName`) VALUES('Anonymous','tiki_p_view');
+INSERT INTO users_grouppermissions (`groupName`,`permName`)
+	VALUES('Anonymous','tiki_p_view'),('Anonymous','tiki_p_search'),('Anonymous','tiki_p_download_files');
 
 DROP TABLE IF EXISTS `users_groups`;
 CREATE TABLE `users_groups` (

------------------------------------------------------------------------
r33464 | nkoth | 2011-03-17 13:05:22 -0400 (qui, 17 mar 2011) | 1 line

[MOD] Maximize size for relation and attribute while reatining indexability

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 33463)
+++ tiki.sql	(revision 33464)
@@ -3718,9 +3718,9 @@
 CREATE TABLE `tiki_object_attributes` (
     `attributeId` INT PRIMARY KEY AUTO_INCREMENT,
     `type` varchar(50) NOT NULL,
-    `itemId` varchar(255) NOT NULL,
-    `attribute` varchar(25) NOT NULL,
-    `value` varchar(100),
+    `itemId` varchar(160) NOT NULL,
+    `attribute` varchar(70) NOT NULL,
+    `value` varchar(255),
     UNIQUE `item_attribute_uq` ( `type`, `itemId`, `attribute` ),
     KEY `attribute_lookup_ix` (`attribute`, `value`)
 ) ENGINE=MyISAM;
@@ -3748,11 +3748,11 @@
 DROP TABLE IF EXISTS `tiki_object_relations`;
 CREATE TABLE `tiki_object_relations` (
     `relationId` INT PRIMARY KEY AUTO_INCREMENT,
-    `relation` varchar(25) NOT NULL,
+    `relation` varchar(70) NOT NULL,
     `source_type` varchar(50) NOT NULL,
-    `source_itemId` varchar(255) NOT NULL,
+    `source_itemId` varchar(160) NOT NULL,
     `target_type` varchar(50) NOT NULL,
-    `target_itemId` varchar(255) NOT NULL,
+    `target_itemId` varchar(160) NOT NULL,
     KEY `relation_source_ix` (`source_type`, `source_itemId`),
     KEY `relation_target_ix` (`target_type`, `target_itemId`)
 ) ENGINE=MyISAM;
@@ -3994,12 +3994,11 @@
 
 DROP TABLE IF EXISTS `tiki_queue`;
 CREATE TABLE `tiki_queue` (
-	`entryId` INT PRIMARY KEY AUTO_INCREMENT,
-	`queue` VARCHAR(25) NOT NULL,
-	`timestamp` INT NOT NULL,
-	`handler` VARCHAR(20) NULL,
-	`message` TEXT NOT NULL,
-	KEY `queue_name_ix` (`queue`),
-	KEY `queue_handler_ix` (`handler`)
+    `entryId` INT PRIMARY KEY AUTO_INCREMENT,
+    `queue` VARCHAR(25) NOT NULL,
+    `timestamp` INT NOT NULL,
+    `handler` VARCHAR(20) NULL,
+    `message` TEXT NOT NULL,
+    KEY `queue_name_ix` (`queue`),
+    KEY `queue_handler_ix` (`handler`)
 ) ENGINE=MyISAM;
-

------------------------------------------------------------------------
r33287 | sylvieg | 2011-03-08 18:39:29 -0400 (ter, 08 mar 2011) | 1 line

[FIX]rss: index are limitted to 255

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 33286)
+++ tiki.sql	(revision 33287)
@@ -3711,7 +3711,7 @@
     `description` TEXT,
     `content` TEXT,
     KEY `tiki_rss_items_rss` (`rssId`),
-    UNIQUE `tiki_rss_items_item` (`rssId`, `guid`)
+    KEY `tiki_rss_items_item` (`rssId`, `guid`(200))
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_object_attributes`;

------------------------------------------------------------------------
r33274 | jonnybradley | 2011-03-07 16:01:47 -0400 (seg, 07 mar 2011) | 2 lines

[KIL] Calendar reminder removed.
Interesting feature but still not functioning after several months. Also not using Tiki conventions and libraries for notifications, database access, mail sending etc.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 33273)
+++ tiki.sql	(revision 33274)
@@ -3856,26 +3856,6 @@
     PRIMARY KEY ( `credit_type` ) 
 ) ENGINE=MyISAM;
 
-
--- --------------------------------------------------------
--- Calendar reminder table
--- --------------------------------------------------------
-DROP TABLE IF EXISTS custom_calendar_reminder;
-CREATE TABLE custom_calendar_reminder
-(
-    reminder_id INT NOT NULL AUTO_INCREMENT,
-    calendar_item_id INT NOT NULL,
-    reminder_type TINYINT NOT NULL DEFAULT 0,
-    fixed_date INT NOT NULL DEFAULT 0,
-    time_offset INT NOT NULL DEFAULT 0,
-    related_to CHAR(1) NOT NULL DEFAULT 'S',
-    when_run CHAR(1) NOT NULL DEFAULT 'B',
-    last_sent INT NOT NULL DEFAULT 0,
-    times_sent INT NOT NULL DEFAULT 0,
-    PRIMARY KEY (reminder_id),
-    INDEX (calendar_item_id)
-) ENGINE=MyISAM;
-
 DROP TABLE IF EXISTS `tiki_acct_account`;
 CREATE TABLE `tiki_acct_account` (
   `accountBookId` int(10) unsigned NOT NULL,

------------------------------------------------------------------------
r33061 | lphuberdeau | 2011-02-23 11:31:39 -0400 (qua, 23 fev 2011) | 1 line

[MOD] Use a queue to collect the documents that need updating in the index, prevent the queue from being processed during a complete rebuild and process the queue right after a complete rebuild

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 33060)
+++ tiki.sql	(revision 33061)
@@ -4011,3 +4011,15 @@
   `taxIsFix` enum('y','n') NOT NULL DEFAULT 'n',
   PRIMARY KEY (`taxBookId`,`taxId`)
 ) ENGINE=MyISAM;
+
+DROP TABLE IF EXISTS `tiki_queue`;
+CREATE TABLE `tiki_queue` (
+	`entryId` INT PRIMARY KEY AUTO_INCREMENT,
+	`queue` VARCHAR(25) NOT NULL,
+	`timestamp` INT NOT NULL,
+	`handler` VARCHAR(20) NULL,
+	`message` TEXT NOT NULL,
+	KEY `queue_name_ix` (`queue`),
+	KEY `queue_handler_ix` (`handler`)
+) ENGINE=MyISAM;
+

------------------------------------------------------------------------
r32922 | luciash | 2011-02-20 02:44:32 -0400 (dom, 20 fev 2011) | 1 line

[ENH] tiki_p_tracker_view_attachments: new perm to allow viewing and downloading of tracker items attachments

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 32921)
+++ tiki.sql	(revision 32922)
@@ -2848,6 +2848,7 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_survey_stats', 'Can view survey stats', 'basic', 'surveys', NULL, 'feature_surveys');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_trackers', 'Can admin trackers', 'editors', 'trackers', 'y', 'feature_trackers');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_attach_trackers', 'Can attach files to tracker items', 'registered', 'trackers', NULL, 'feature_trackers');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_tracker_view_attachments', 'Can view tracker items attachments and download', 'registered', 'trackers', NULL, 'feature_trackers');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_comment_tracker_items', 'Can insert comments for tracker items', 'basic', 'trackers', NULL, 'feature_trackers');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_tracker_view_comments', 'Can view tracker items comments', 'basic', 'trackers', NULL, 'feature_trackers');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_create_tracker_items', 'Can create new items for trackers', 'registered', 'trackers', NULL, 'feature_trackers');

------------------------------------------------------------------------
r32569 | eromneg | 2011-02-11 09:53:52 -0400 (sex, 11 fev 2011) | 1 line

[FIX] mistyped File Gallery menu permission

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 32568)
+++ tiki.sql	(revision 32569)
@@ -1364,7 +1364,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Admin Directory','tiki-directory_admin.php',565,'feature_directory','tiki_p_view_directory,tiki_p_admin_directory_cats','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Admin Directory','tiki-directory_admin.php',565,'feature_directory','tiki_p_view_directory,tiki_p_admin_directory_sites','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Admin Directory','tiki-directory_admin.php',565,'feature_directory','tiki_p_view_directory,tiki_p_validate_links','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','File Galleries','tiki-list_file_gallery.php',600,'feature_file_galleries','tiki-list_file_gallery.php|tiki_p_view_file_gallery|tiki_p_upload_files','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','File Galleries','tiki-list_file_gallery.php',600,'feature_file_galleries','tiki_p_list_file_galleries|tiki_p_view_file_gallery|tiki_p_upload_files','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Galleries','tiki-list_file_gallery.php',605,'feature_file_galleries','tiki_p_list_file_galleries','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Rankings','tiki-file_galleries_rankings.php',610,'feature_file_galleries,feature_file_galleries_rankings','tiki_p_list_file_galleries','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Upload File','tiki-upload_file.php',615,'feature_file_galleries','tiki_p_upload_files','',0);

------------------------------------------------------------------------
r32542 | changi67 | 2011-02-10 03:45:12 -0400 (qui, 10 fev 2011) | 1 line

[FIX] Force MyISAM Engine - http://dev.tiki.org/wish3790

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 32541)
+++ tiki.sql	(revision 32542)
@@ -659,7 +659,7 @@
   `name` varchar(40) NOT NULL,
   `data` text,
   `lang` VARCHAR(16) NULL
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_extwiki`;
 CREATE TABLE `tiki_extwiki` (
@@ -1572,7 +1572,7 @@
     `validateAddrs` CHAR( 1 ) NOT NULL DEFAULT 'n',
     `addToList` CHAR( 1 ) NOT NULL DEFAULT 'n',
     PRIMARY KEY ( `nlId` , `wikiPageName` )
-) ENGINE = MYISAM ;
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_newsletters`;
 CREATE TABLE `tiki_newsletters` (
@@ -3322,7 +3322,7 @@
   KEY (`page_id`),
   KEY (`original_translation_bit`),
   KEY (`source_translation_bit`)
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_pages_changes`;
 CREATE TABLE `tiki_pages_changes` (
@@ -3332,7 +3332,7 @@
   `segments_removed` int(10),
   `segments_total` int(10),
   PRIMARY KEY (page_id, version)
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_minichat`;
 CREATE TABLE `tiki_minichat` (
@@ -3344,7 +3344,7 @@
   `msg` varchar(255) NOT NULL,
   PRIMARY KEY (`id`),
   KEY `channel` (`channel`)
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_profile_symbols`;
 CREATE TABLE `tiki_profile_symbols` (
@@ -3357,7 +3357,7 @@
   `creation_date` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
   PRIMARY KEY ( `domain`, `profile`, `object` ),
   INDEX(`named`)
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_feature`;
 CREATE TABLE `tiki_feature` (
@@ -3438,7 +3438,7 @@
   `filename` varchar(256) NOT NULL,
   PRIMARY KEY  (`id`),
   KEY `editionId` (`editionId`)
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_sefurl_regex_out`;
 CREATE TABLE `tiki_sefurl_regex_out` (
@@ -3453,7 +3453,7 @@
   PRIMARY KEY (`id`),
   UNIQUE KEY `left` (`left`(128)),
   INDEX `idx1` (silent, type, feature(30))
-);
+) ENGINE=MyISAM;
 
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`) VALUES('tiki-index.php\\?page=(.+)', '$1', 'wiki', 'feature_wiki');
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`) VALUES('tiki-slideshow.php\\?page=(.+)', 'show:$1', '', 'feature_wiki');
@@ -3541,7 +3541,7 @@
   `last_objectType` VARCHAR(20) NOT NULL,
   `last_objectId` VARCHAR(200) NOT NULL,
   KEY `last_object` (last_objectType, last_objectId)
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_user_reports`;
 CREATE TABLE `tiki_user_reports` (
@@ -3608,7 +3608,7 @@
     `groups` VARCHAR(255),
     PRIMARY KEY( `tokenId` ),
     KEY `tiki_auth_tokens_token` (`token`)
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `metrics_assigned`;
 CREATE TABLE `metrics_assigned` (
@@ -3618,7 +3618,7 @@
     PRIMARY KEY (`assigned_id`),
     KEY `metric_id` (`metric_id`),
     KEY `tab_id` (`tab_id`)
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `metrics_metric`;
 CREATE TABLE `metrics_metric` (
@@ -3631,7 +3631,7 @@
     `metric_dsn` VARCHAR(200) NOT NULL DEFAULT 'local',
     PRIMARY KEY (`metric_id`),
     UNIQUE KEY `metric_name` (`metric_name`)
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `metrics_tab`;
 CREATE TABLE `metrics_tab` (
@@ -3641,7 +3641,7 @@
     `tab_content` longtext NOT NULL,
     PRIMARY KEY (`tab_id`),
     UNIQUE KEY `tab_name` (`tab_name`)
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_file_backlinks`;
 CREATE TABLE `tiki_file_backlinks` (
@@ -3649,7 +3649,7 @@
        `objectId` int(12) NOT NULL,
        KEY `objectId` (`objectId`),
        KEY `fileId` (`fileId`)
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_payment_requests`;
 CREATE TABLE `tiki_payment_requests` (
@@ -3665,7 +3665,7 @@
     `detail` TEXT,
     `userId` int(8),
     PRIMARY KEY( `paymentRequestId` )
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_payment_received`;
 CREATE TABLE `tiki_payment_received` (
@@ -3678,7 +3678,7 @@
     `userId` int(8),
     PRIMARY KEY(`paymentReceivedId`),
     KEY `payment_request_ix` (`paymentRequestId`)
-);
+) ENGINE=MyISAM;
 DROP TABLE IF EXISTS `tiki_discount`;
 CREATE TABLE `tiki_discount`( 
     `id` INT NOT NULL AUTO_INCREMENT,
@@ -3688,7 +3688,7 @@
     `comment` TEXT,
     PRIMARY KEY(`id`),
     KEY `code` (`code`)
-);
+) ENGINE=MyISAM;
 DROP TABLE IF EXISTS `tiki_translations_in_progress`;
 CREATE TABLE IF NOT EXISTS `tiki_translations_in_progress` (
    `page_id` int(14) NOT NULL,
@@ -3696,7 +3696,7 @@
    KEY `page_id` (`page_id`),
    KEY `language` (`language`),
    UNIQUE (`page_id`, `language`)
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_rss_items`;
 CREATE TABLE `tiki_rss_items` (
@@ -3711,7 +3711,7 @@
     `content` TEXT,
     KEY `tiki_rss_items_rss` (`rssId`),
     UNIQUE `tiki_rss_items_item` (`rssId`, `guid`)
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_object_attributes`;
 CREATE TABLE `tiki_object_attributes` (
@@ -3722,7 +3722,7 @@
     `value` varchar(100),
     UNIQUE `item_attribute_uq` ( `type`, `itemId`, `attribute` ),
     KEY `attribute_lookup_ix` (`attribute`, `value`)
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_rating_configs`;
 CREATE TABLE `tiki_rating_configs` (
@@ -3731,7 +3731,7 @@
     `expiry` INT NOT NULL DEFAULT 3600,
     `formula` TEXT NOT NULL,
     `callbacks` TEXT
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_rating_obtained`;
 CREATE TABLE `tiki_rating_obtained` (
@@ -3742,7 +3742,7 @@
     `expire` INT NOT NULL,
     `value` FLOAT NOT NULL,
     UNIQUE `tiki_obtained_rating_uq` (`type`, `object`, `ratingConfigId`)
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_object_relations`;
 CREATE TABLE `tiki_object_relations` (
@@ -3754,7 +3754,7 @@
     `target_itemId` varchar(255) NOT NULL,
     KEY `relation_source_ix` (`source_type`, `source_itemId`),
     KEY `relation_target_ix` (`target_type`, `target_itemId`)
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_todo`;
 CREATE TABLE `tiki_todo` (
@@ -3768,7 +3768,7 @@
     PRIMARY KEY (`todoId`),
     KEY `what` (`objectType`, `objectId`),
     KEY `after` (`after`)
-);
+) ENGINE=MyISAM;
 DROP TABLE IF EXISTS `tiki_todo_notif`;
 CREATE TABLE `tiki_todo_notif` (
     `todoId` INT(12) NOT NULL,
@@ -3776,7 +3776,7 @@
     `objectId` VARCHAR(255) default NULL,
     KEY `todoId` (`todoId`),
     KEY `objectId` (`objectId`)
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_url_shortener`;
 CREATE TABLE `tiki_url_shortener` (
@@ -3802,7 +3802,7 @@
   `wikicontent` text,
   `wikipageafter` varchar(255) default NULL,
   PRIMARY KEY  (`id`)
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_invited`;
 CREATE TABLE `tiki_invited` (
@@ -3816,7 +3816,7 @@
   PRIMARY KEY  (`id`),
   KEY `id_invite` (`id_invite`),
   KEY `used_on_user` (`used_on_user`)
-);
+) ENGINE=MyISAM;
 
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES ('tiki_p_invite', 'Can invite users by email, and include them in groups', 'registered', 'tiki', NULL, 'feature_invite');
 
@@ -3832,7 +3832,7 @@
     `product_id` INT( 8 ) NULL ,
     PRIMARY KEY ( `creditId` ) ,
     INDEX ( `userId` , `credit_type` )
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_credits_usage`;
 CREATE TABLE `tiki_credits_usage` (
@@ -3843,7 +3843,7 @@
     `used_amount` FLOAT NOT NULL DEFAULT 0,
     `product_id` INT( 8 ) NULL ,
     PRIMARY KEY ( `usageId` )
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_credits_types`;
 CREATE TABLE `tiki_credits_types` (
@@ -3853,7 +3853,7 @@
     `is_static_level` CHAR( 1 ) DEFAULT 'n',
     `scaling_divisor` FLOAT NOT NULL DEFAULT 1,
     PRIMARY KEY ( `credit_type` ) 
-);
+) ENGINE=MyISAM;
 
 
 -- --------------------------------------------------------
@@ -3873,7 +3873,7 @@
     times_sent INT NOT NULL DEFAULT 0,
     PRIMARY KEY (reminder_id),
     INDEX (calendar_item_id)
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_acct_account`;
 CREATE TABLE `tiki_acct_account` (
@@ -3887,7 +3887,7 @@
   `accountUserId` int(8) NOT NULL DEFAULT '0',
   PRIMARY KEY (`accountBookId`,`accountId`),
   KEY `accountTax` (`accountTax`)
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_acct_bankaccount`; 
 CREATE TABLE `tiki_acct_bankaccount` (
@@ -3918,7 +3918,7 @@
   `SignPositive` varchar(7) NOT NULL,
   `SignNegative` varchar(7) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL,
   PRIMARY KEY (`bankBookId`,`bankAccountId`)
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_acct_book`;
 CREATE TABLE `tiki_acct_book` (
@@ -3937,7 +3937,7 @@
   `exportQuote` varchar(4) NOT NULL DEFAULT '"',
   `bookAutoTax` enum('y','n') NOT NULL DEFAULT 'y',
   PRIMARY KEY (`bookId`)
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_acct_item`; 
 CREATE TABLE `tiki_acct_item` (
@@ -3949,7 +3949,7 @@
   `itemText` varchar(255) NOT NULL DEFAULT '',
   `itemTs` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
   PRIMARY KEY (`itemBookId`,`itemJournalId`,`itemAccountId`,`itemType`)
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_acct_journal`; 
 CREATE TABLE `tiki_acct_journal` (
@@ -3960,7 +3960,7 @@
   `journalCancelled` int(1) NOT NULL DEFAULT '0',
   `journalTs` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
   PRIMARY KEY (`journalBookId`,`journalId`)
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_acct_stack`; 
 CREATE TABLE `tiki_acct_stack` (
@@ -3970,7 +3970,7 @@
   `stackDescription` varchar(255) NOT NULL,
   `stackTs` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
   PRIMARY KEY (`stackBookId`,`stackId`)
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_acct_stackitem`; 
 CREATE TABLE `tiki_acct_stackitem` (
@@ -3981,7 +3981,7 @@
   `stackItemAmount` double NOT NULL DEFAULT '0',
   `stackItemText` varchar(255) NOT NULL DEFAULT '',
   PRIMARY KEY (`stackBookId`,`stackItemStackId`,`stackItemAccountId`,`stackItemType`)
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_acct_statement`;
 CREATE TABLE `tiki_acct_statement` (
@@ -3999,7 +3999,7 @@
   `statementJournalId` int(10) unsigned NOT NULL DEFAULT '0',
   `statementStackId` int(11) NOT NULL,
   PRIMARY KEY (`statementBookId`,`statementAccountId`,`statementId`)
-);
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_acct_tax`; 
 CREATE TABLE `tiki_acct_tax` (
@@ -4009,4 +4009,4 @@
   `taxAmount` double NOT NULL DEFAULT '0',
   `taxIsFix` enum('y','n') NOT NULL DEFAULT 'n',
   PRIMARY KEY (`taxBookId`,`taxId`)
-);
+) ENGINE=MyISAM;

------------------------------------------------------------------------
r32539 | sylvieg | 2011-02-09 18:20:26 -0400 (qua, 09 fev 2011) | 1 line

[FIX]users: tiki_p_list_users is now used outside the feature

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 32538)
+++ tiki.sql	(revision 32539)
@@ -2927,7 +2927,7 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_use_content_templates', 'Can use content templates', 'registered', 'content templates', NULL, 'feature_wiki_templates,feature_cms_templates');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_html_pages', 'Can edit HTML pages', 'editors', 'html pages', NULL, 'feature_html_pages');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_html_pages', 'Can view HTML pages', 'basic', 'html pages', NULL, 'feature_html_pages');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_list_users', 'Can list registered users', 'registered', 'user', NULL, 'feature_friends');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_list_users', 'Can list registered users', 'registered', 'user', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_live_support_admin', 'Admin live support system', 'admin', 'support', 'y', 'feature_live_support');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_live_support', 'Can use live support system', 'basic', 'support', NULL, 'feature_live_support');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_map_create', 'Can create new mapfile', 'admin', 'maps', NULL, 'feature_maps');

------------------------------------------------------------------------
r32346 | chealer | 2011-02-01 14:40:40 -0400 (ter, 01 fev 2011) | 2 lines

MySQL 5.5: don't use removed TIMESTAMP(N), just TIMESTAMP. thanks elmonty
sorry, Aptana might be messing with indentation a bit

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 32345)
+++ tiki.sql	(revision 32346)
@@ -229,8 +229,8 @@
   `ip3` char(3) default NULL,
   `ip4` char(3) default NULL,
   `user` varchar(200) default '',
-  `date_from` timestamp(14) NOT NULL,
-  `date_to` timestamp(14) NOT NULL,
+  `date_from` timestamp NOT NULL,
+  `date_to` timestamp NOT NULL,
   `use_dates` char(1) default NULL,
   `created` int(14) default NULL,
   `message` text,
@@ -1531,12 +1531,12 @@
 ) ENGINE=MyISAM;
 
 INSERT INTO `tiki_modules` (name,position,ord,cache_time,params,groups) VALUES
-	('menu','l',1,7200,'id=42&flip=y','a:1:{i:0;s:10:"Registered";}'),
-	('logo','t',1,7200,'nobox=y&style=float%3Aleft%3Bmargin%3A0+30px%3B','a:0:{}'),
-	('login_box','t',2,0,'mode=header&nobox=y&style=position%3Aabsolute%3Bright%3A30px%3Btop%3A5px%3B','a:0:{}'),
-	('quickadmin','t',3,7200,'nobox=y&style=position%3A+absolute%3B+right%3A+200px%3B','a:1:{i:0;s:6:"Admins";}'),
-	('rsslist','b',1,7200,'nobox=y','a:0:{}'),
-	('poweredby','b',2,7200,'nobox=y&icons=n&version=n','a:0:{}');
+    ('menu','l',1,7200,'id=42&flip=y','a:1:{i:0;s:10:"Registered";}'),
+    ('logo','t',1,7200,'nobox=y&style=float%3Aleft%3Bmargin%3A0+30px%3B','a:0:{}'),
+    ('login_box','t',2,0,'mode=header&nobox=y&style=position%3Aabsolute%3Bright%3A30px%3Btop%3A5px%3B','a:0:{}'),
+    ('quickadmin','t',3,7200,'nobox=y&style=position%3A+absolute%3B+right%3A+200px%3B','a:1:{i:0;s:6:"Admins";}'),
+    ('rsslist','b',1,7200,'nobox=y','a:0:{}'),
+    ('poweredby','b',2,7200,'nobox=y&icons=n&version=n','a:0:{}');
 
 DROP TABLE IF EXISTS `tiki_newsletter_subscriptions`;
 CREATE TABLE `tiki_newsletter_subscriptions` (
@@ -1676,7 +1676,7 @@
   `active` char(1) default NULL,
   `publishDate` int(14) default NULL,
   `voteConsiderationSpan` int(4) default 0,
-	`anonym` ENUM( 'a', 'u', 'i', 'c' ) NOT NULL DEFAULT 'u',
+    `anonym` ENUM( 'a', 'u', 'i', 'c' ) NOT NULL DEFAULT 'u',
   PRIMARY KEY (`pollId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 ALTER TABLE tiki_polls ADD INDEX tiki_poll_lookup ( active , title );
@@ -3115,7 +3115,7 @@
 CREATE TABLE `tiki_friendship_requests` (
   `userFrom` varchar(200) NOT NULL default '',
   `userTo` varchar(200) NOT NULL default '',
-  `tstamp` timestamp(14) NOT NULL,
+  `tstamp` timestamp NOT NULL,
   PRIMARY KEY (`userFrom`(120),`userTo`(120))
 ) ENGINE=MyISAM;
 
@@ -3163,7 +3163,7 @@
   `user` char(200) NOT NULL default '',
   `event_id` char(200) NOT NULL default '',
   `expire` int(14) NOT NULL default '0',
-  `tstamp` timestamp(14) NOT NULL,
+  `tstamp` timestamp NOT NULL,
   PRIMARY KEY (`user`(110),`event_id`(110)),
   KEY `user` (user(110),event_id(110),expire)
 ) ENGINE=MyISAM;

------------------------------------------------------------------------
r32334 | robertplummer | 2011-02-01 10:49:28 -0400 (ter, 01 fev 2011) | 2 lines

[FIX] Some code refactoring for organization
[ADD] SQL for cloning spreadsheets to tiki.db

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 32333)
+++ tiki.sql	(revision 32334)
@@ -2000,6 +2000,7 @@
   `footerRow` int(4) NOT NULL default '0',
   `className` varchar(64) default NULL,
   `parseValues` char( 1 ) NOT NULL default 'n',
+  `clonedSheetId` int(8) NULL,
   UNIQUE KEY `sheetId` (`sheetId`, `begin`)
 ) ENGINE=MyISAM;
 
@@ -2018,6 +2019,7 @@
   `user` varchar(200) default '',
   `style` varchar( 255 ) default '',
   `class` varchar( 255 ) default '',
+  `clonedSheetId` int(8) NULL,
   UNIQUE KEY `sheetId` (`sheetId`,begin,`rowIndex`,`columnIndex`),
   KEY `sheetId_2` (`sheetId`,`rowIndex`,`columnIndex`)
 ) ENGINE=MyISAM;
@@ -2029,6 +2031,7 @@
   `description` text,
   `author` varchar(200) NOT NULL default '',
   `parentSheetId` int(8) NULL,
+  `clonedSheetId` int(8) NULL,
   PRIMARY KEY (`sheetId`)
 ) ENGINE=MyISAM;
 

------------------------------------------------------------------------
r32297 | nyloth | 2011-01-30 22:13:29 -0400 (dom, 30 jan 2011) | 3 lines

[NEW] Wiki Attachments in File Galleries: new pref 'feature_use_fgal_for_wiki_attachments' to handle attachments in file galleries + new smarty attachments plugin



Index: tiki.sql
===================================================================
--- tiki.sql	(revision 32296)
+++ tiki.sql	(revision 32297)
@@ -768,6 +768,7 @@
 
 INSERT INTO `tiki_file_galleries` (`galleryId`, `name`, `type`, `description`, `visible`, `user`, `public`, `parentId`) VALUES ('1','File Galleries', 'system', '', 'y', 'admin', 'y', -1);
 INSERT INTO `tiki_file_galleries` (`galleryId`, `name`, `type`, `description`, `visible`, `user`, `public`, `parentId`) VALUES ('2','Users File Galleries', 'system', '', 'y', 'admin', 'y', -1);
+INSERT INTO `tiki_file_galleries` (`galleryId`, `name`, `type`, `description`, `visible`, `user`, `public`, `parentId`) VALUES ('3','Wiki Attachments', 'system', '', 'y', 'admin', 'y', -1);
 
 
 DROP TABLE IF EXISTS `tiki_files`;

------------------------------------------------------------------------
r32289 | nyloth | 2011-01-30 21:16:51 -0400 (dom, 30 jan 2011) | 7 lines

[NEW] User files in file galleries
- new preference 'feature_use_fgal_for_user_files' to allow the usage of File Galleries for user files (with all advantages of File Galleries, like display options or WebDAV for example)
	(each user gets their own gallery, automatically created at first access. The gallery is named with the user name, in the special parent gallery 'Users File Galleries')
- User uploads can be done using tiki-userupload.php (not in a menu yet - has to be done)




Index: tiki.sql
===================================================================
--- tiki.sql	(revision 32288)
+++ tiki.sql	(revision 32289)
@@ -766,7 +766,8 @@
   PRIMARY KEY (`galleryId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
-INSERT INTO `tiki_file_galleries` (`name`, `type`, `description`, `visible`, `user`, `public`, `parentId`) VALUES ('File Galleries', 'system', '', 'y', 'admin', 'y', -1);
+INSERT INTO `tiki_file_galleries` (`galleryId`, `name`, `type`, `description`, `visible`, `user`, `public`, `parentId`) VALUES ('1','File Galleries', 'system', '', 'y', 'admin', 'y', -1);
+INSERT INTO `tiki_file_galleries` (`galleryId`, `name`, `type`, `description`, `visible`, `user`, `public`, `parentId`) VALUES ('2','Users File Galleries', 'system', '', 'y', 'admin', 'y', -1);
 
 
 DROP TABLE IF EXISTS `tiki_files`;

------------------------------------------------------------------------
r32278 | nyloth | 2011-01-30 19:27:17 -0400 (dom, 30 jan 2011) | 1 line

[ENH] filegals: new preference to display checkboxes in filegal listing for mass actions + installer/schema for show_deleteAfer and show_share columns that were not included in r32269 and r32256 by mistake.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 32277)
+++ tiki.sql	(revision 32278)
@@ -759,6 +759,7 @@
   `backlinkPerms` char(1) default 'n',
   `show_backlinks` char(1) default NULL,
   `show_deleteAfter` char(1) default NULL,
+  `show_checked` char(1) default NULL,
   `show_share` char(1) default NULL,
   `image_max_size_x` int(8) NOT NULL default '0',
   `image_max_size_y` int(8) NOT NULL default '0',

------------------------------------------------------------------------
r32269 | nyloth | 2011-01-30 17:12:22 -0400 (dom, 30 jan 2011) | 15 lines

[NEW] Share This Page: New features to be able to use Tiki as a file sharing service
- New Admin panel for "Share This Page" options
- Better handle the temporary file sharing & file max hits
- In filegal listings : add a column 'share' to display the people which have some temporary access to the file and the number of hits they have done or can do
- Add AJAX Autocomplete to lookup into users & contacts
- Allow the user to specify the max number of access are allowed
- New options to hide or display info on the share page (for links, name, email, ...)
- Allow Tiki to send a notification to the Tiki user that shared the resource when the recipient has accessed the resource (through a Token that allow him to get temporarily superior rights)
- New options to automatically add unknown recipients to the user contacts

Other notes for Auth Tokens:
- Tokens are stored with an optional e-mail to be able to identify who has originally received the token (when the token was generated by "Share This Page" feature)
- Handle Token Errors (at the UI level)



Index: tiki.sql
===================================================================
--- tiki.sql	(revision 32268)
+++ tiki.sql	(revision 32269)
@@ -759,6 +759,7 @@
   `backlinkPerms` char(1) default 'n',
   `show_backlinks` char(1) default NULL,
   `show_deleteAfter` char(1) default NULL,
+  `show_share` char(1) default NULL,
   `image_max_size_x` int(8) NOT NULL default '0',
   `image_max_size_y` int(8) NOT NULL default '0',
   PRIMARY KEY (`galleryId`)
@@ -781,6 +782,7 @@
   `user` varchar(200) default '',
   `author` varchar(40) default NULL,
   `hits` int(14) default NULL,
+  `maxhits` INT( 14 ) default NULL, 
   `lastDownload` int(14) default NULL,
   `votes` int(8) default NULL,
   `points` decimal(8,2) default NULL,
@@ -3592,8 +3594,10 @@
     `creation` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
     `timeout` INT NOT NULL DEFAULT 0,
     `hits` INT NOT NULL DEFAULT 1,
+    `maxhits` INT NOT NULL DEFAULT 1, 
     `token` CHAR(32),
     `entry` VARCHAR(50),
+    `email` varchar(255) NOT NULL,
     `parameters` VARCHAR(255),
     `groups` VARCHAR(255),
     PRIMARY KEY( `tokenId` ),

------------------------------------------------------------------------
r32256 | nyloth | 2011-01-30 11:31:09 -0400 (dom, 30 jan 2011) | 1 line

[ENH] file galleries: handle the 'deleteAfter' file parameter as any other information in file listings (display it as a column, in the popup info, ...)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 32255)
+++ tiki.sql	(revision 32256)
@@ -758,6 +758,7 @@
   `wiki_syntax` varchar(200) default NULL,
   `backlinkPerms` char(1) default 'n',
   `show_backlinks` char(1) default NULL,
+  `show_deleteAfter` char(1) default NULL,
   `image_max_size_x` int(8) NOT NULL default '0',
   `image_max_size_y` int(8) NOT NULL default '0',
   PRIMARY KEY (`galleryId`)

------------------------------------------------------------------------
r31980 | sylvieg | 2011-01-18 12:30:54 -0400 (ter, 18 jan 2011) | 1 line

[ENH]tracker: split tiki_p_modify_tracker_item_xxx with tiki_p_remove_tracker_items_xxx

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 31979)
+++ tiki.sql	(revision 31980)
@@ -2846,6 +2846,9 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_modify_tracker_items', 'Can change tracker items', 'registered', 'trackers', NULL, 'feature_trackers');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_modify_tracker_items_pending', 'Can change pending tracker items', 'registered', 'trackers', NULL, 'feature_trackers');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_modify_tracker_items_closed', 'Can change closed tracker items', 'registered', 'trackers', NULL, 'feature_trackers');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_remove_tracker_items', 'Can remove tracker items', 'registered', 'trackers', NULL, 'feature_trackers');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_remove_tracker_items_pending', 'Can remove pending tracker items', 'registered', 'trackers', NULL, 'feature_trackers');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_remove_tracker_items_closed', 'Can remove closed tracker items', 'registered', 'trackers', NULL, 'feature_trackers');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_tracker_view_ratings', 'Can view rating result for tracker items', 'basic', 'trackers', NULL, 'feature_trackers');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_tracker_vote_ratings', 'Can vote a rating for tracker items', 'registered', 'trackers', NULL, 'feature_trackers');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_tracker_revote_ratings', 'Can re-vote a rating for tracker items', 'registered', 'trackers', NULL, 'feature_trackers');

------------------------------------------------------------------------
r31958 | jonnybradley | 2011-01-17 16:39:15 -0400 (seg, 17 jan 2011) | 1 line

[FIX] modules: Better upgrade and defaults to match default theme (FiveAlive) - also restore siteheader.jpg to fivealives.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 31957)
+++ tiki.sql	(revision 31958)
@@ -1526,9 +1526,9 @@
 
 INSERT INTO `tiki_modules` (name,position,ord,cache_time,params,groups) VALUES
 	('menu','l',1,7200,'id=42&flip=y','a:1:{i:0;s:10:"Registered";}'),
-	('logo','t',1,7200,'nobox=y&style=float%3Aleft%3Bmargin%3A0+5em%3B','a:0:{}'),
-	('login_box','t',2,0,'mode=header&nobox=y&style=float%3Aright%3B','a:0:{}'),
-	('quickadmin','t',3,7200,'nobox=y&style=float%3Aleft%3Bmargin%3A0+5em%3B','a:1:{i:0;s:6:"Admins";}'),
+	('logo','t',1,7200,'nobox=y&style=float%3Aleft%3Bmargin%3A0+30px%3B','a:0:{}'),
+	('login_box','t',2,0,'mode=header&nobox=y&style=position%3Aabsolute%3Bright%3A30px%3Btop%3A5px%3B','a:0:{}'),
+	('quickadmin','t',3,7200,'nobox=y&style=position%3A+absolute%3B+right%3A+200px%3B','a:1:{i:0;s:6:"Admins";}'),
 	('rsslist','b',1,7200,'nobox=y','a:0:{}'),
 	('poweredby','b',2,7200,'nobox=y&icons=n&version=n','a:0:{}');
 

------------------------------------------------------------------------
r31953 | jonnybradley | 2011-01-17 14:55:08 -0400 (seg, 17 jan 2011) | 1 line

[FIX] modules revamp: Better defaults for new installs - no search or tiki-top menu, use menu module for application menu

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 31952)
+++ tiki.sql	(revision 31953)
@@ -1525,13 +1525,10 @@
 ) ENGINE=MyISAM;
 
 INSERT INTO `tiki_modules` (name,position,ord,cache_time,params,groups) VALUES
-	('Application Menu','l',30,7200,'flip=y','a:1:{i:0;s:10:"Registered";}'),
+	('menu','l',1,7200,'id=42&flip=y','a:1:{i:0;s:10:"Registered";}'),
 	('logo','t',1,7200,'nobox=y&style=float%3Aleft%3Bmargin%3A0+5em%3B','a:0:{}'),
 	('login_box','t',2,0,'mode=header&nobox=y&style=float%3Aright%3B','a:0:{}'),
-	('search','t',6,7200,'nobox=y&style=float%3Aright%3Bclear%3Aright%3B','a:0:{}'),
 	('quickadmin','t',3,7200,'nobox=y&style=float%3Aleft%3Bmargin%3A0+5em%3B','a:1:{i:0;s:6:"Admins";}'),
-	('menu','t',5,7200,'id=43&type=horiz&menu_id=tiki-top&menu_class=clearfix&nobox=y&style=float%3Aleft%3Bclear%3Aboth%3Bwidth%3A100%25%3B','a:0:{}'),
-	('breadcrumbs','t',6,0,'nobox=y','a:0:{}'),
 	('rsslist','b',1,7200,'nobox=y','a:0:{}'),
 	('poweredby','b',2,7200,'nobox=y&icons=n&version=n','a:0:{}');
 

------------------------------------------------------------------------
r31950 | jonnybradley | 2011-01-17 14:02:36 -0400 (seg, 17 jan 2011) | 7 lines

[ENH] modules revamp: Merge from experimental branch (known as "xajax_removal").
Drag and drop & double click modules admin
New module zones: top, pagetop, bottom and pagebottom
New modules (including menu, poweredby etc)
Upgrade script v1 to migrate header and footer prefs.
Many general [FIX]s and [MOD]s in modules.
More CSS work TODO.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 31949)
+++ tiki.sql	(revision 31950)
@@ -1524,7 +1524,16 @@
   KEY `namePosOrdParam` (`name`(100), `position`, `ord`, `params`(140))
 ) ENGINE=MyISAM;
 
-INSERT INTO tiki_modules (name,position,ord,cache_time,params,groups) VALUES ('Application Menu','l',30,0,'flip=y','a:1:{i:0;s:10:"Registered";}');
+INSERT INTO `tiki_modules` (name,position,ord,cache_time,params,groups) VALUES
+	('Application Menu','l',30,7200,'flip=y','a:1:{i:0;s:10:"Registered";}'),
+	('logo','t',1,7200,'nobox=y&style=float%3Aleft%3Bmargin%3A0+5em%3B','a:0:{}'),
+	('login_box','t',2,0,'mode=header&nobox=y&style=float%3Aright%3B','a:0:{}'),
+	('search','t',6,7200,'nobox=y&style=float%3Aright%3Bclear%3Aright%3B','a:0:{}'),
+	('quickadmin','t',3,7200,'nobox=y&style=float%3Aleft%3Bmargin%3A0+5em%3B','a:1:{i:0;s:6:"Admins";}'),
+	('menu','t',5,7200,'id=43&type=horiz&menu_id=tiki-top&menu_class=clearfix&nobox=y&style=float%3Aleft%3Bclear%3Aboth%3Bwidth%3A100%25%3B','a:0:{}'),
+	('breadcrumbs','t',6,0,'nobox=y','a:0:{}'),
+	('rsslist','b',1,7200,'nobox=y','a:0:{}'),
+	('poweredby','b',2,7200,'nobox=y&icons=n&version=n','a:0:{}');
 
 DROP TABLE IF EXISTS `tiki_newsletter_subscriptions`;
 CREATE TABLE `tiki_newsletter_subscriptions` (

------------------------------------------------------------------------
r31875 | lphuberdeau | 2011-01-12 13:11:06 -0400 (qua, 12 jan 2011) | 1 line

[NEW] Adding permissions for flagged revision approval and basic approval interface

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 31874)
+++ tiki.sql	(revision 31875)
@@ -2982,6 +2982,8 @@
 INSERT INTO `users_permissions` (`permName` , `permDesc` , `level` , `type` , `admin` , `feature_check` ) VALUES ( 'tiki_p_acct_book_stack', 'Can book into the stack, where statements can be changed', 'editor', 'accounting', 'n', 'feature_accounting');
 INSERT INTO `users_permissions` (`permName` , `permDesc` , `level` , `type` , `admin` , `feature_check` ) VALUES ( 'tiki_p_acct_book_import', 'Can import statements from external accounts', 'editor', 'accounting', 'n', 'feature_accounting' );
 INSERT INTO `users_permissions` (`permName` , `permDesc` , `level` , `type` , `admin` , `feature_check` ) VALUES ( 'tiki_p_acct_manage_template', 'Can manage templates for recurring transactions', 'editor', 'accounting', 'n', 'feature_accounting');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_wiki_view_latest', 'Can view unapproved revisions of pages', 'registered', 'wiki', NULL, 'flaggedrev_approval');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_wiki_approve', 'Can approve revisions of pages', 'editor', 'wiki', NULL, 'flaggedrev_approval');
 
 DROP TABLE IF EXISTS `users_usergroups`;
 CREATE TABLE `users_usergroups` (

------------------------------------------------------------------------
r31749 | lphuberdeau | 2011-01-04 12:37:33 -0400 (ter, 04 jan 2011) | 1 line

[NEW]Â Initial support for flagged revision approval scheme, much UI still missing

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 31748)
+++ tiki.sql	(revision 31749)
@@ -3231,6 +3231,7 @@
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Removed', 'wiki page attachment', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Categorized', 'wiki page', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Uncategorized', 'wiki page', 'n');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Flagged', 'wiki page', 'n');
 
 DROP TABLE IF EXISTS `tiki_freetags`;
 CREATE TABLE `tiki_freetags` (

------------------------------------------------------------------------
r31689 | lphuberdeau | 2010-12-31 12:34:52 -0400 (sex, 31 dez 2010) | 1 line

[FIX]Â Missing drop table if exists

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 31688)
+++ tiki.sql	(revision 31689)
@@ -3836,6 +3836,7 @@
 -- --------------------------------------------------------
 -- Calendar reminder table
 -- --------------------------------------------------------
+DROP TABLE IF EXISTS custom_calendar_reminder;
 CREATE TABLE custom_calendar_reminder
 (
     reminder_id INT NOT NULL AUTO_INCREMENT,

------------------------------------------------------------------------
r31557 | jonnybradley | 2010-12-20 21:04:49 -0400 (seg, 20 dez 2010) | 1 line

[bp/r31497 & 31499][KIL] feature_mobile

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 31556)
+++ tiki.sql	(revision 31557)
@@ -1288,7 +1288,6 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Calendar','tiki-calendar.php',35,'feature_calendar','tiki_p_view_calendar','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Users Map','tiki-gmap_usermap.php',36,'feature_gmap','','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Tiki Calendar','tiki-action_calendar.php',37,'feature_action_calendar','tiki_p_view_tiki_calendar','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Mobile','tiki-mobile.php',37,'feature_mobile','','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','(debug)','javascript:toggle(\'debugconsole\')',40,'feature_debug_console','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','MyTiki','tiki-my_tiki.php',50,'feature_mytiki','','Registered',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','MyTiki Home','tiki-my_tiki.php',51,'feature_mytiki','','Registered',0);
@@ -3483,7 +3482,6 @@
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-stats.php', 'stats', '', 'feature_stats', 200);
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-list_surveys.php', 'surveys', '', 'feature_surveys', 200);
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-list_trackers.php', 'trackers', '', 'feature_trackers', 200);
-INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-mobile.php', 'mobile', '', 'feature_mobile', 200);
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-sheets.php', 'sheets', '', 'feature_sheet', 200);
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-view_tracker_item.php\\?trackerId=(\\d+)\\&itemId=(\\d+)', 'item$2', 'trackeritem', 'feature_trackers', 200);
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-view_tracker_item.php\\?itemId=(\\d+)', 'item$1', 'trackeritem', 'feature_trackers', 200);

------------------------------------------------------------------------
r31434 | jonnybradley | 2010-12-15 11:31:39 -0400 (qua, 15 dez 2010) | 8 lines

[bp/r31354 & 31355] From xajax_removal branch.
[KIL] xajax removal: First pass of removing Xajax.
3rd party library link disconnected and support files removed.
"loadComponent" functionality removed.
Remaining dependant features' (gmap, webmail, shoutbox) ajax operation disabled and marked with AJAX_TODO comments.
[KIL] xajax removal: Part 2 - feature_wiki_save_draft
Table tiki_page_drafts not removed to preserve existing data but removed from tiki.sql for new installs.
Script in devtools started for manual removal.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 31433)
+++ tiki.sql	(revision 31434)
@@ -1632,17 +1632,6 @@
   KEY `lastModif`(`lastModif`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1;
 
-DROP TABLE IF EXISTS `tiki_page_drafts`;
-CREATE TABLE `tiki_page_drafts` (
-  `user` varchar(200) default '',
-  `pageName` varchar(255) NOT NULL,
-  `data` mediumtext,
-  `description` varchar(200) default NULL,
-  `comment` varchar(200) default NULL,
-  `lastModif` int(14) default NULL,
-  PRIMARY KEY (`pageName`(120), `user`(120))
-) ENGINE=MyISAM;
-
 DROP TABLE IF EXISTS `tiki_pageviews`;
 CREATE TABLE `tiki_pageviews` (
   `day` int(14) NOT NULL default '0',

------------------------------------------------------------------------
r31429 | killianebel | 2010-12-15 10:01:27 -0400 (qua, 15 dez 2010) | 1 line

[ADD] File galleries can be created / edited from a template, which define parameters in YAML format

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 31428)
+++ tiki.sql	(revision 31429)
@@ -717,6 +717,7 @@
   `galleryId` int(14) NOT NULL auto_increment,
   `name` varchar(80) NOT NULL default '',
   `type` varchar(20) NOT NULL default 'default',
+  `template` int(10) default NULL,
   `description` text,
   `created` int(14) default NULL,
   `visible` char(1) default NULL,

------------------------------------------------------------------------
r31422 | lphuberdeau | 2010-12-15 09:25:50 -0400 (qua, 15 dez 2010) | 1 line

[REVERT] r31417 The commit implies anyone with auto-approve right approves plugin by visiting the page, regardless of them introducing them or not. This removes all possible protection. Might as well introduce a preference that disables the security altogether.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 31421)
+++ tiki.sql	(revision 31422)
@@ -2936,7 +2936,6 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_plugin_viewdetail', 'Can view unapproved plugin details', 'registered', 'wiki', NULL, 'feature_wiki');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_plugin_preview', 'Can execute unapproved plugin', 'registered', 'wiki', NULL, 'feature_wiki');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_plugin_approve', 'Can approve plugin execution', 'editors', 'wiki', NULL, 'feature_wiki');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_plugin_autoapprove', 'Auto approve plugin execution', 'editors', 'wiki', NULL, 'feature_wiki');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_trust_input', 'Trust all user inputs including plugins (no security checks)', 'admin', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_backlink', 'View page backlinks', 'basic', 'wiki', NULL, 'feature_wiki');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_notifications', 'Can admin mail notifications', 'editors', 'tiki', NULL, NULL);

------------------------------------------------------------------------
r31421 | killianebel | 2010-12-15 09:24:08 -0400 (qua, 15 dez 2010) | 1 line

[ADD] Permission on file suppression

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 31420)
+++ tiki.sql	(revision 31421)
@@ -2791,6 +2791,7 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_gallery_file', 'Can edit a gallery file', 'editors', 'file galleries', NULL, 'feature_file_galleries');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_list_file_galleries', 'Can list file galleries', 'basic', 'file galleries', NULL, 'feature_file_galleries');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_upload_files', 'Can upload files', 'registered', 'file galleries', NULL, 'feature_file_galleries');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_remove_files', 'Can remove files', 'registered', 'file galleries', NULL, 'feature_file_galleries');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_fgal_explorer', 'Can view file galleries explorer', 'basic', 'file galleries', NULL, 'feature_file_galleries');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_fgal_path', 'Can view file galleries path', 'basic', 'file galleries', NULL, 'feature_file_galleries');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_file_gallery', 'Can view file galleries', 'basic', 'file galleries', NULL, 'feature_file_galleries');

------------------------------------------------------------------------
r31417 | killianebel | 2010-12-15 09:11:53 -0400 (qua, 15 dez 2010) | 1 line

[ADD] Autoapprove right on wiki plugins

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 31416)
+++ tiki.sql	(revision 31417)
@@ -2935,6 +2935,7 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_plugin_viewdetail', 'Can view unapproved plugin details', 'registered', 'wiki', NULL, 'feature_wiki');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_plugin_preview', 'Can execute unapproved plugin', 'registered', 'wiki', NULL, 'feature_wiki');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_plugin_approve', 'Can approve plugin execution', 'editors', 'wiki', NULL, 'feature_wiki');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_plugin_autoapprove', 'Auto approve plugin execution', 'editors', 'wiki', NULL, 'feature_wiki');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_trust_input', 'Trust all user inputs including plugins (no security checks)', 'admin', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_backlink', 'View page backlinks', 'basic', 'wiki', NULL, 'feature_wiki');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_notifications', 'Can admin mail notifications', 'editors', 'tiki', NULL, NULL);

------------------------------------------------------------------------
r31414 | jonnybradley | 2010-12-14 18:30:46 -0400 (ter, 14 dez 2010) | 1 line

[MRG] Automatic merge, branches/6.x 31378 to 31409

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 31413)
+++ tiki.sql	(revision 31414)
@@ -1675,10 +1675,20 @@
   `active` char(1) default NULL,
   `publishDate` int(14) default NULL,
   `voteConsiderationSpan` int(4) default 0,
+	`anonym` ENUM( 'a', 'u', 'i', 'c' ) NOT NULL DEFAULT 'u',
   PRIMARY KEY (`pollId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 ALTER TABLE tiki_polls ADD INDEX tiki_poll_lookup ( active , title );
 
+CREATE TABLE IF NOT EXISTS `tiki_poll_votes` (
+  `pollId` int(11) NOT NULL,
+  `optionId` int(11) NOT NULL,
+  `voteId` int(11) NOT NULL auto_increment,
+  `identification` varchar(300) NOT NULL,
+  `time` int(11) NOT NULL,
+  PRIMARY KEY  (`voteId`)
+) ENGINE=MyISAM AUTO_INCREMENT=1 ;
+
 DROP TABLE IF EXISTS `tiki_preferences`;
 CREATE TABLE `tiki_preferences` (
   `name` varchar(40) NOT NULL default '',

------------------------------------------------------------------------
r31291 | killianebel | 2010-12-08 04:55:50 -0400 (qua, 08 dez 2010) | 1 line

[MOD] SOAP Tiki server + SOAP client in webservices admin

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 31290)
+++ tiki.sql	(revision 31291)
@@ -3379,6 +3379,8 @@
 CREATE TABLE `tiki_webservice` (
   `service` VARCHAR(25) NOT NULL PRIMARY KEY,
   `url` VARCHAR(250),
+  `wstype` CHAR(4),
+  `operation` VARCHAR(250),
   `body` TEXT,
   `schema_version` VARCHAR(5),
   `schema_documentation` VARCHAR(250)

------------------------------------------------------------------------
r31251 | killianebel | 2010-12-07 10:15:31 -0400 (ter, 07 dez 2010) | 1 line

[MOD] Files in file galleries can have a draft, using the 'file_galleries_save_drafts' feature.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 31250)
+++ tiki.sql	(revision 31251)
@@ -803,6 +803,21 @@
   FULLTEXT KEY `ft` (name,description,search_data,filename)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
+DROP TABLE IF EXISTS `tiki_file_drafts`;
+CREATE TABLE `tiki_file_drafts` (
+  `fileId` int(14) NOT NULL,
+  `filename` varchar(80) default NULL,
+  `filesize` int(14) default NULL,
+  `filetype` varchar(250) default NULL,
+  `data` longblob,
+  `user` varchar(200) default '',
+  `path` varchar(255) default NULL,
+  `hash` varchar(32) default NULL,
+  `lastModif` integer(14) DEFAULT NULL,
+  `lockedby` varchar(200) default '',
+  PRIMARY KEY (`fileId`, `user`)
+) ENGINE=MyISAM;
+
 DROP TABLE IF EXISTS `tiki_forum_attachments`;
 CREATE TABLE `tiki_forum_attachments` (
   `attId` int(14) NOT NULL auto_increment,

------------------------------------------------------------------------
r31228 | killianebel | 2010-12-07 06:08:11 -0400 (ter, 07 dez 2010) | 1 line

[FIX] User login is now unique.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 31227)
+++ tiki.sql	(revision 31228)
@@ -3010,7 +3010,7 @@
   `waiting` char(1) default NULL,
   PRIMARY KEY (`userId`),
   KEY `score` (score),
-  KEY `login` (login),
+  UNIQUE KEY `login` (login),
   KEY `registrationDate` (`registrationDate`),
   KEY `openid_url` (openid_url)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;

------------------------------------------------------------------------
r31034 | jonnybradley | 2010-12-03 15:54:07 -0400 (sex, 03 dez 2010) | 1 line

[MRG] Automatic merge, branches/6.x 30996 to 31032

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 31033)
+++ tiki.sql	(revision 31034)
@@ -739,7 +739,7 @@
   `parentId` int(14) NOT NULL default -1,
   `lockable` char(1) default 'n',
   `show_lockedby` char(1) default NULL,
-  `archives` int(4) default -1,
+  `archives` int(4) default 0,
   `sort_mode` char(20) default NULL,
   `show_modified` char(1) default NULL,
   `show_author` char(1) default NULL,

------------------------------------------------------------------------
r30995 | cdrwhite | 2010-12-02 13:48:51 -0400 (qui, 02 dez 2010) | 4 lines

[FIX] Permissions in accounting, problems with AUTOINCREMENT
[NEW] Accounting books can be closed
[NEW] First steps for cancelling journal entries
[ENH] Switching templates to new icons/{icon}-Plugin

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 30994)
+++ tiki.sql	(revision 30995)
@@ -3901,6 +3901,7 @@
 
 DROP TABLE IF EXISTS `tiki_acct_item`; 
 CREATE TABLE `tiki_acct_item` (
+  `itemBookId` int(10) unsigned NOT NULL,
   `itemJournalId` int(10) unsigned NOT NULL DEFAULT '0',
   `itemAccountId` int(10) unsigned NOT NULL DEFAULT '0',
   `itemType` int(1) NOT NULL DEFAULT '-1',
@@ -3907,7 +3908,7 @@
   `itemAmount` double NOT NULL DEFAULT '0',
   `itemText` varchar(255) NOT NULL DEFAULT '',
   `itemTs` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
-  PRIMARY KEY (`itemJournalId`,`itemAccountId`,`itemType`)
+  PRIMARY KEY (`itemBookId`,`itemJournalId`,`itemAccountId`,`itemType`)
 );
 
 DROP TABLE IF EXISTS `tiki_acct_journal`; 
@@ -3933,12 +3934,13 @@
 
 DROP TABLE IF EXISTS `tiki_acct_stackitem`; 
 CREATE TABLE `tiki_acct_stackitem` (
+  `stackBookId` int(10) unsigned NOT NULL,
   `stackItemStackId` int(10) unsigned NOT NULL DEFAULT '0',
   `stackItemAccountId` int(10) unsigned NOT NULL DEFAULT '0',
   `stackItemType` int(1) NOT NULL DEFAULT '-1',
   `stackItemAmount` double NOT NULL DEFAULT '0',
   `stackItemText` varchar(255) NOT NULL DEFAULT '',
-  PRIMARY KEY (`stackItemStackId`,`stackItemAccountId`,`stackItemType`)
+  PRIMARY KEY (`stackBookId`,`stackItemStackId`,`stackItemAccountId`,`stackItemType`)
 );
 
 DROP TABLE IF EXISTS `tiki_acct_statement`;

------------------------------------------------------------------------
r30951 | cdrwhite | 2010-11-30 12:43:25 -0400 (ter, 30 nov 2010) | 1 line

Database structures for accounting

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 30950)
+++ tiki.sql	(revision 30951)
@@ -2960,6 +2960,14 @@
 
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_page_contribution_view', 'Can view contributions to a page', 'basic', 'wiki', NULL, 'feature_wiki');
 
+INSERT INTO `users_permissions` (`permName` , `permDesc` , `level` , `type` , `admin` , `feature_check` ) VALUES ( 'tiki_p_acct_create_book', 'Can create/close a book', 'admin', 'accounting', 'y', 'feature_accounting');
+INSERT INTO `users_permissions` (`permName` , `permDesc` , `level` , `type` , `admin` , `feature_check` ) VALUES ( 'tiki_p_acct_manage_accounts', 'Can create/edit/lock accounts', 'admin', 'accounting', 'y', 'feature_accounting' );
+INSERT INTO `users_permissions` (`permName` , `permDesc` , `level` , `type` , `admin` , `feature_check` ) VALUES ( 'tiki_p_acct_book', 'Create a new transaction', 'editor', 'accounting', 'n', 'feature_accounting');
+INSERT INTO `users_permissions` (`permName` , `permDesc` , `level` , `type` , `admin` , `feature_check` ) VALUES ( 'tiki_p_acct_view', 'Permission to view the journal', 'registered', 'accounting', 'n', 'feature_accounting' );
+INSERT INTO `users_permissions` (`permName` , `permDesc` , `level` , `type` , `admin` , `feature_check` ) VALUES ( 'tiki_p_acct_book_stack', 'Can book into the stack, where statements can be changed', 'editor', 'accounting', 'n', 'feature_accounting');
+INSERT INTO `users_permissions` (`permName` , `permDesc` , `level` , `type` , `admin` , `feature_check` ) VALUES ( 'tiki_p_acct_book_import', 'Can import statements from external accounts', 'editor', 'accounting', 'n', 'feature_accounting' );
+INSERT INTO `users_permissions` (`permName` , `permDesc` , `level` , `type` , `admin` , `feature_check` ) VALUES ( 'tiki_p_acct_manage_template', 'Can manage templates for recurring transactions', 'editor', 'accounting', 'n', 'feature_accounting');
+
 DROP TABLE IF EXISTS `users_usergroups`;
 CREATE TABLE `users_usergroups` (
   `userId` int(8) NOT NULL default '0',
@@ -3826,3 +3834,137 @@
     PRIMARY KEY (reminder_id),
     INDEX (calendar_item_id)
 );
+
+DROP TABLE IF EXISTS `tiki_acct_account`;
+CREATE TABLE `tiki_acct_account` (
+  `accountBookId` int(10) unsigned NOT NULL,
+  `accountId` int(10) unsigned NOT NULL DEFAULT '0',
+  `accountName` varchar(255) NOT NULL,
+  `accountNotes` text NOT NULL,
+  `accountBudget` double NOT NULL DEFAULT '0',
+  `accountLocked` int(1) NOT NULL DEFAULT '0',
+  `accountTax` int(11) NOT NULL DEFAULT '0',
+  `accountUserId` int(8) NOT NULL DEFAULT '0',
+  PRIMARY KEY (`accountBookId`,`accountId`),
+  KEY `accountTax` (`accountTax`)
+);
+
+DROP TABLE IF EXISTS `tiki_acct_bankaccount`; 
+CREATE TABLE `tiki_acct_bankaccount` (
+  `bankBookId` int(10) unsigned NOT NULL,
+  `bankAccountId` int(10) unsigned NOT NULL,
+  `externalNumber` int(10) NOT NULL,
+  `bankCountry` varchar(2) NOT NULL,
+  `bankCode` varchar(11) NOT NULL,
+  `bankIBAN` varchar(63) NOT NULL,
+  `bankBIC` varchar(63) NOT NULL,
+  `bankDelimeter` varchar(15) NOT NULL DEFAULT ';',
+  `bankDecPoint` varchar(1) NOT NULL DEFAULT ',',
+  `bankThousand` varchar(1) NOT NULL DEFAULT '.',
+  `bankHasHeader` tinyint(1) NOT NULL DEFAULT '1',
+  `fieldNameAccount` varchar(63) NOT NULL,
+  `fieldNameBookingDate` varchar(63) NOT NULL,
+  `formatBookingDate` varchar(31) NOT NULL,
+  `fieldNameValueDate` varchar(63) NOT NULL,
+  `formatValueDate` varchar(31) NOT NULL,
+  `fieldNameBookingText` varchar(63) NOT NULL,
+  `fieldNameReason` varchar(63) NOT NULL,
+  `fieldNameCounterpartName` varchar(63) NOT NULL,
+  `fieldNameCounterpartAccount` varchar(63) NOT NULL,
+  `fieldNameCounterpartBankCode` varchar(63) NOT NULL,
+  `fieldNameAmount` varchar(63) NOT NULL,
+  `amountType` int(10) unsigned NOT NULL,
+  `fieldNameAmountSign` varchar(63) NOT NULL,
+  `SignPositive` varchar(7) NOT NULL,
+  `SignNegative` varchar(7) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL,
+  PRIMARY KEY (`bankBookId`,`bankAccountId`)
+);
+
+DROP TABLE IF EXISTS `tiki_acct_book`;
+CREATE TABLE `tiki_acct_book` (
+  `bookId` int(10) unsigned NOT NULL AUTO_INCREMENT,
+  `bookName` varchar(255) NOT NULL,
+  `bookClosed` enum('y','n') NOT NULL DEFAULT 'n',
+  `bookStartDate` date NOT NULL,
+  `bookEndDate` date NOT NULL,
+  `bookCurrency` varchar(3) NOT NULL DEFAULT 'EUR',
+  `bookCurrencyPos` int(11) NOT NULL,
+  `bookDecimals` int(11) NOT NULL DEFAULT '2',
+  `bookDecPoint` varchar(1) NOT NULL DEFAULT ',',
+  `bookThousand` varchar(1) NOT NULL DEFAULT '.',
+  `exportSeparator` varchar(4) NOT NULL DEFAULT ';',
+  `exportEOL` varchar(4) NOT NULL DEFAULT 'LF',
+  `exportQuote` varchar(4) NOT NULL DEFAULT '"',
+  `bookAutoTax` enum('y','n') NOT NULL DEFAULT 'y',
+  PRIMARY KEY (`bookId`)
+);
+
+DROP TABLE IF EXISTS `tiki_acct_item`; 
+CREATE TABLE `tiki_acct_item` (
+  `itemJournalId` int(10) unsigned NOT NULL DEFAULT '0',
+  `itemAccountId` int(10) unsigned NOT NULL DEFAULT '0',
+  `itemType` int(1) NOT NULL DEFAULT '-1',
+  `itemAmount` double NOT NULL DEFAULT '0',
+  `itemText` varchar(255) NOT NULL DEFAULT '',
+  `itemTs` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
+  PRIMARY KEY (`itemJournalId`,`itemAccountId`,`itemType`)
+);
+
+DROP TABLE IF EXISTS `tiki_acct_journal`; 
+CREATE TABLE `tiki_acct_journal` (
+  `journalBookId` int(10) unsigned NOT NULL,
+  `journalId` int(10) unsigned NOT NULL AUTO_INCREMENT,
+  `journalDate` date NOT NULL DEFAULT '0000-00-00',
+  `journalDescription` varchar(255) NOT NULL,
+  `journalCancelled` int(1) NOT NULL DEFAULT '0',
+  `journalTs` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
+  PRIMARY KEY (`journalBookId`,`journalId`)
+);
+
+DROP TABLE IF EXISTS `tiki_acct_stack`; 
+CREATE TABLE `tiki_acct_stack` (
+  `stackBookId` int(10) unsigned NOT NULL,
+  `stackId` int(10) unsigned NOT NULL AUTO_INCREMENT,
+  `stackDate` date NOT NULL DEFAULT '0000-00-00',
+  `stackDescription` varchar(255) NOT NULL,
+  `stackTs` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
+  PRIMARY KEY (`stackBookId`,`stackId`)
+);
+
+DROP TABLE IF EXISTS `tiki_acct_stackitem`; 
+CREATE TABLE `tiki_acct_stackitem` (
+  `stackItemStackId` int(10) unsigned NOT NULL DEFAULT '0',
+  `stackItemAccountId` int(10) unsigned NOT NULL DEFAULT '0',
+  `stackItemType` int(1) NOT NULL DEFAULT '-1',
+  `stackItemAmount` double NOT NULL DEFAULT '0',
+  `stackItemText` varchar(255) NOT NULL DEFAULT '',
+  PRIMARY KEY (`stackItemStackId`,`stackItemAccountId`,`stackItemType`)
+);
+
+DROP TABLE IF EXISTS `tiki_acct_statement`;
+CREATE TABLE `tiki_acct_statement` (
+  `statementBookId` int(10) unsigned NOT NULL,
+  `statementAccountId` int(10) unsigned NOT NULL DEFAULT '0',
+  `statementId` int(10) unsigned NOT NULL AUTO_INCREMENT,
+  `statementBookingDate` date NOT NULL,
+  `statementValueDate` date NOT NULL,
+  `statementBookingText` varchar(255) NOT NULL,
+  `statementReason` varchar(255) NOT NULL,
+  `statementCounterpart` varchar(63) NOT NULL,
+  `statementCounterpartAccount` varchar(63) NOT NULL,
+  `statementCounterpartBankCode` varchar(63) NOT NULL,
+  `statementAmount` double NOT NULL,
+  `statementJournalId` int(10) unsigned NOT NULL DEFAULT '0',
+  `statementStackId` int(11) NOT NULL,
+  PRIMARY KEY (`statementBookId`,`statementAccountId`,`statementId`)
+);
+
+DROP TABLE IF EXISTS `tiki_acct_tax`; 
+CREATE TABLE `tiki_acct_tax` (
+  `taxBookId` int(10) unsigned NOT NULL,
+  `taxId` int(10) unsigned NOT NULL AUTO_INCREMENT,
+  `taxText` varchar(63) NOT NULL,
+  `taxAmount` double NOT NULL DEFAULT '0',
+  `taxIsFix` enum('y','n') NOT NULL DEFAULT 'n',
+  PRIMARY KEY (`taxBookId`,`taxId`)
+);

------------------------------------------------------------------------
r30876 | qoumaq | 2010-11-26 10:46:23 -0400 (sex, 26 nov 2010) | 1 line

calendar reminder added

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 30875)
+++ tiki.sql	(revision 30876)
@@ -3807,3 +3807,22 @@
     `scaling_divisor` FLOAT NOT NULL DEFAULT 1,
     PRIMARY KEY ( `credit_type` ) 
 );
+
+
+-- --------------------------------------------------------
+-- Calendar reminder table
+-- --------------------------------------------------------
+CREATE TABLE custom_calendar_reminder
+(
+    reminder_id INT NOT NULL AUTO_INCREMENT,
+    calendar_item_id INT NOT NULL,
+    reminder_type TINYINT NOT NULL DEFAULT 0,
+    fixed_date INT NOT NULL DEFAULT 0,
+    time_offset INT NOT NULL DEFAULT 0,
+    related_to CHAR(1) NOT NULL DEFAULT 'S',
+    when_run CHAR(1) NOT NULL DEFAULT 'B',
+    last_sent INT NOT NULL DEFAULT 0,
+    times_sent INT NOT NULL DEFAULT 0,
+    PRIMARY KEY (reminder_id),
+    INDEX (calendar_item_id)
+);

------------------------------------------------------------------------
r30800 | sampaioprimo | 2010-11-19 14:41:25 -0400 (sex, 19 nov 2010) | 2 lines

differentiate blog post and forum post menu entries strings for easier
translations

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 30799)
+++ tiki.sql	(revision 30800)
@@ -1331,8 +1331,8 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Blogs','tiki-list_blogs.php',455,'feature_blogs','tiki_p_read_blog','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Rankings','tiki-blog_rankings.php',460,'feature_blogs,feature_blog_rankings','tiki_p_read_blog','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Create Blog','tiki-edit_blog.php',465,'feature_blogs','tiki_p_read_blog,tiki_p_create_blogs','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Post','tiki-blog_post.php',470,'feature_blogs','tiki_p_read_blog,tiki_p_blog_post','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Admin Posts','tiki-list_posts.php',475,'feature_blogs','tiki_p_read_blog,tiki_p_blog_admin','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','New Blog Post','tiki-blog_post.php',470,'feature_blogs','tiki_p_read_blog,tiki_p_blog_post','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Blog Posts','tiki-list_posts.php',475,'feature_blogs','tiki_p_read_blog,tiki_p_blog_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','Forums','tiki-forums.php',500,'feature_forums','tiki_p_forum_read','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Forums','tiki-forums.php',505,'feature_forums','tiki_p_forum_read','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Rankings','tiki-forum_rankings.php',510,'feature_forums,feature_forum_rankings','tiki_p_forum_read','',0);

------------------------------------------------------------------------
r30790 | sylvieg | 2010-11-19 10:56:04 -0400 (sex, 19 nov 2010) | 1 line

[FIX]categ: describe dependance of the categ perms

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 30789)
+++ tiki.sql	(revision 30790)
@@ -2919,8 +2919,8 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_categories', 'Can admin categories', 'editors', 'category', 'y', 'feature_categories');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_category', 'Can see the category in a listing', 'basic', 'category', NULL, 'feature_categories');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_modify_object_categories', 'Can change the categories of the object', 'editors', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_add_object', 'Can add objects to the category', 'editors', 'category', NULL, 'feature_categories');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_remove_object', 'Can remove objects from the category', 'editors', 'category', NULL, 'feature_categories');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_add_object', 'Can add objects to the category (needs tiki_p_modify_object_categories)', 'editors', 'category', NULL, 'feature_categories');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_remove_object', 'Can remove objects from the category (needs tiki_p_modify_object_categories)', 'editors', 'category', NULL, 'feature_categories');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_create_category', 'Can create new categories', 'admin', 'category', NULL, 'feature_categories');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_perspective_view', 'Can view the perspective', 'basic', 'perspective', NULL, 'feature_perspective');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_perspective_edit', 'Can edit the perspective', 'basic', 'perspective', NULL, 'feature_perspective');

------------------------------------------------------------------------
r30754 | sylvieg | 2010-11-17 14:52:21 -0400 (qua, 17 nov 2010) | 1 line

[NEW]actionlog: record categorize or ucategorize of wiki page

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 30753)
+++ tiki.sql	(revision 30754)
@@ -3206,6 +3206,8 @@
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Viewed', 'trackeritem', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Created', 'wiki page attachment', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Removed', 'wiki page attachment', 'n');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Categorized', 'wiki page', 'n');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Uncategorized', 'wiki page', 'n');
 
 DROP TABLE IF EXISTS `tiki_freetags`;
 CREATE TABLE `tiki_freetags` (

------------------------------------------------------------------------
r30630 | sylvieg | 2010-11-10 17:03:05 -0400 (qua, 10 nov 2010) | 1 line

[NEW]actionlog: log wiki attachment

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 30629)
+++ tiki.sql	(revision 30630)
@@ -3204,6 +3204,8 @@
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Created', 'trackeritem', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Viewed', 'trackeritem', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Viewed', 'trackeritem', 'n');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Created', 'wiki page attachment', 'n');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Removed', 'wiki page attachment', 'n');
 
 DROP TABLE IF EXISTS `tiki_freetags`;
 CREATE TABLE `tiki_freetags` (

------------------------------------------------------------------------
r30414 | sylvieg | 2010-10-29 15:16:34 -0400 (sex, 29 out 2010) | 1 line

[MRG] Automatic merge, branches/6.x 30341 to 30411

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 30413)
+++ tiki.sql	(revision 30414)
@@ -2913,7 +2913,7 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_trust_input', 'Trust all user inputs including plugins (no security checks)', 'admin', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_backlink', 'View page backlinks', 'basic', 'wiki', NULL, 'feature_wiki');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_notifications', 'Can admin mail notifications', 'editors', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_invite', 'Can invite user to groups', 'editors', 'tiki', NULL, NULL);
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_invite_to_my_groups', 'Can invite user to my groups', 'editors', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_delete_account', 'Can delete his/her own account', 'admin', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_importer', 'Can use the importer', 'admin', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_categories', 'Can admin categories', 'editors', 'category', 'y', 'feature_categories');
@@ -3542,7 +3542,7 @@
     `to` varchar(255) NOT NULL,
     `guards` text,
     PRIMARY KEY(`transitionId`),
-	KEY `transition_lookup` (`type`, `from`)
+    KEY `transition_lookup` (`type`, `from`)
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_auth_tokens`;
@@ -3740,8 +3740,8 @@
   KEY `longurl_hash` (`longurl_hash`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
-DROP TABLE IF EXISTS `tiki_invit`;
-CREATE TABLE `tiki_invit` (
+DROP TABLE IF EXISTS `tiki_invite`;
+CREATE TABLE `tiki_invite` (
   `id` int(11) NOT NULL auto_increment,
   `inviter` varchar(200) NOT NULL,
   `groups` varchar(255) default NULL,
@@ -3756,7 +3756,7 @@
 DROP TABLE IF EXISTS `tiki_invited`;
 CREATE TABLE `tiki_invited` (
   `id` int(11) NOT NULL auto_increment,
-  `id_invit` int(11) NOT NULL,
+  `id_invite` int(11) NOT NULL,
   `email` varchar(255) NOT NULL,
   `firstname` varchar(24) NOT NULL,
   `lastname` varchar(24) NOT NULL,
@@ -3763,8 +3763,43 @@
   `used` enum('no','registered','logged') NOT NULL,
   `used_on_user` varchar(200) default NULL,
   PRIMARY KEY  (`id`),
-  KEY `id_invit` (`id_invit`),
+  KEY `id_invite` (`id_invite`),
   KEY `used_on_user` (`used_on_user`)
 );
 
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES ('tiki_p_invit', 'Can invit users by email, and include them in groups', 'registered', 'tiki', NULL, 'feature_invit');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES ('tiki_p_invite', 'Can invite users by email, and include them in groups', 'registered', 'tiki', NULL, 'feature_invite');
+
+DROP TABLE IF EXISTS `tiki_credits`;
+CREATE TABLE `tiki_credits` (
+    `creditId` INT UNSIGNED NOT NULL AUTO_INCREMENT ,
+    `userId` INT( 8 ) NOT NULL ,
+    `credit_type` VARCHAR( 25 ) NOT NULL ,
+    `creation_date` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ,
+    `expiration_date` TIMESTAMP NULL ,
+    `total_amount` FLOAT NOT NULL DEFAULT 0,
+    `used_amount` FLOAT NOT NULL DEFAULT 0,
+    `product_id` INT( 8 ) NULL ,
+    PRIMARY KEY ( `creditId` ) ,
+    INDEX ( `userId` , `credit_type` )
+);
+
+DROP TABLE IF EXISTS `tiki_credits_usage`;
+CREATE TABLE `tiki_credits_usage` (
+    `usageId` INT NOT NULL AUTO_INCREMENT,
+    `userId` INT NOT NULL,
+    `usage_date` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    `credit_type` VARCHAR( 25 ) NOT NULL,
+    `used_amount` FLOAT NOT NULL DEFAULT 0,
+    `product_id` INT( 8 ) NULL ,
+    PRIMARY KEY ( `usageId` )
+);
+
+DROP TABLE IF EXISTS `tiki_credits_types`;
+CREATE TABLE `tiki_credits_types` (
+    `credit_type` VARCHAR( 25 ) NOT NULL,
+    `display_text` VARCHAR( 50 ) DEFAULT NULL,
+    `unit_text` VARCHAR( 25 ) DEFAULT NULL,
+    `is_static_level` CHAR( 1 ) DEFAULT 'n',
+    `scaling_divisor` FLOAT NOT NULL DEFAULT 1,
+    PRIMARY KEY ( `credit_type` ) 
+);

------------------------------------------------------------------------
r30280 | sampaioprimo | 2010-10-25 10:55:26 -0400 (seg, 25 out 2010) | 1 line

[FIX] renaming blog menu entry from 'Create/Edit Blog' to 'Create Blog' since this is the real functionality of the link

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 30279)
+++ tiki.sql	(revision 30280)
@@ -1330,7 +1330,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','Blogs','tiki-list_blogs.php',450,'feature_blogs','tiki_p_read_blog','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Blogs','tiki-list_blogs.php',455,'feature_blogs','tiki_p_read_blog','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Rankings','tiki-blog_rankings.php',460,'feature_blogs,feature_blog_rankings','tiki_p_read_blog','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Create/Edit Blog','tiki-edit_blog.php',465,'feature_blogs','tiki_p_read_blog,tiki_p_create_blogs','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Create Blog','tiki-edit_blog.php',465,'feature_blogs','tiki_p_read_blog,tiki_p_create_blogs','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Post','tiki-blog_post.php',470,'feature_blogs','tiki_p_read_blog,tiki_p_blog_post','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Admin Posts','tiki-list_posts.php',475,'feature_blogs','tiki_p_read_blog,tiki_p_blog_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','Forums','tiki-forums.php',500,'feature_forums','tiki_p_forum_read','',0);

------------------------------------------------------------------------
r30124 | sylvieg | 2010-10-19 10:26:33 -0400 (ter, 19 out 2010) | 1 line

[MRG] Automatic merge, branches/6.x 30050 to 30123

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 30123)
+++ tiki.sql	(revision 30124)
@@ -1,7 +1,9 @@
-- --------------------------------------------------------
+-- --------------------------------------------------------
 -- Database : Tiki 
 -- --------------------------------------------------------
 
+ALTER DATABASE DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;
+
 DROP TABLE IF EXISTS `messu_messages`;
 CREATE TABLE `messu_messages` (
   `msgId` int(14) NOT NULL auto_increment,

------------------------------------------------------------------------
r30051 | jonnybradley | 2010-10-15 15:06:16 -0400 (sex, 15 out 2010) | 1 line

[MRG] Automatic merge, branches/6.x 30020 to 30050

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 30050)
+++ tiki.sql	(revision 30051)
@@ -1,4 +1,4 @@
--- --------------------------------------------------------
+- --------------------------------------------------------
 -- Database : Tiki 
 -- --------------------------------------------------------
 
@@ -2799,7 +2799,7 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_poll_results', 'Can view poll results', 'basic', 'polls', NULL, 'feature_polls');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_vote_poll', 'Can vote polls', 'basic', 'polls', NULL, 'feature_polls');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_poll_voters', 'Can view poll voters', 'basic', 'polls', NULL, 'feature_polls');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_toolbars', 'Can admin toolbars', 'admin', 'tiki', 'y', NULL);
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_toolbars', 'Can admin toolbars', 'admin', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_quizzes', 'Can admin quizzes', 'editors', 'quizzes', 'y', 'feature_quizzes');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_take_quiz', 'Can take quizzes', 'basic', 'quizzes', NULL, 'feature_quizzes');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_quiz_stats', 'Can view quiz stats', 'basic', 'quizzes', NULL, 'feature_quizzes');
@@ -2913,7 +2913,7 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_notifications', 'Can admin mail notifications', 'editors', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_invite', 'Can invite user to groups', 'editors', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_delete_account', 'Can delete his/her own account', 'admin', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_importer', 'Can use the importer', 'admin', 'tiki', 'y', NULL);
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_importer', 'Can use the importer', 'admin', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_categories', 'Can admin categories', 'editors', 'category', 'y', 'feature_categories');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_category', 'Can see the category in a listing', 'basic', 'category', NULL, 'feature_categories');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_modify_object_categories', 'Can change the categories of the object', 'editors', 'tiki', NULL, NULL);

------------------------------------------------------------------------
r30027 | sampaioprimo | 2010-10-14 19:42:52 -0400 (qui, 14 out 2010) | 2 lines

[ENH] log time of the last modification to a string when using interactive translation
[FIX] only show diff option if there is a difference between the original string and the new string

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 30026)
+++ tiki.sql	(revision 30027)
@@ -1084,6 +1084,7 @@
   `tran` text,
   `changed` bool,
   `userId` int(8),
+  `lastModif` int(14) NULL,
   PRIMARY KEY (`id`)
 ) ENGINE=MyISAM;
 

------------------------------------------------------------------------
r29907 | sampaioprimo | 2010-10-08 13:35:49 -0400 (sex, 08 out 2010) | 2 lines

[ENH] log which user translated each string for interactive translation and tiki-edit_languages.php


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 29906)
+++ tiki.sql	(revision 29907)
@@ -1083,6 +1083,7 @@
   `lang` char(16) NOT NULL default '',
   `tran` text,
   `changed` bool,
+  `userId` int(8),
   PRIMARY KEY (`id`)
 ) ENGINE=MyISAM;
 

------------------------------------------------------------------------
r29782 | sylvieg | 2010-10-04 13:13:51 -0400 (seg, 04 out 2010) | 1 line

[MRG] Automatic merge, branches/6.x 29683 to 29781

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 29781)
+++ tiki.sql	(revision 29782)
@@ -3410,7 +3410,7 @@
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`) VALUES('tiki-browse_image.php\\?imageId=(\\d+)', 'browseimage$1', 'image', 'feature_galleries');
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`) VALUES('tiki-directory_browse.php\\?parent=(\\d+)', 'directory$1', 'directory', 'feature_directory');
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`) VALUES('tiki-view_faq.php\\?faqId=(\\d+)', 'faq$1', 'faq', 'feature_faqs');
-INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`) VALUES('tiki-download_file.php\\?fileId=(\\d+)', 'dl$1', 'file', 'feature_file_galleries');
+INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-download_file.php\\?fileId=(\\d+)', 'dl$1', 'file', 'feature_file_galleries', 10);
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`) VALUES('tiki-download_file.php\\?fileId=(\\d+)&amp;thumbnail', 'thumbnail$1', 'thumbnail', 'feature_file_galleries');
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`) VALUES('tiki-download_file.php\\?fileId=(\\d+)&amp;display', 'display$1', 'display', 'feature_file_galleries');
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`) VALUES('tiki-download_file.php\\?fileId=(\\d+)&amp;preview', 'preview$1', 'preview', 'feature_file_galleries');

------------------------------------------------------------------------
r29657 | sylvieg | 2010-09-27 10:55:48 -0400 (seg, 27 set 2010) | 1 line

[MRG] Automatic merge, branches/6.x 29594 to 29656

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 29656)
+++ tiki.sql	(revision 29657)
@@ -1,5 +1,5 @@
 -- --------------------------------------------------------
--- Database : tikiwiki
+-- Database : Tiki 
 -- --------------------------------------------------------
 
 DROP TABLE IF EXISTS `messu_messages`;
@@ -1410,6 +1410,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Search Stats','tiki-search_stats.php',1125,'feature_search_stats','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Theme Control','tiki-theme_control.php',1130,'feature_theme_control','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Toolbars','tiki-admin_toolbars.php',1135,'','tiki_p_admin_toolbars','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Transitions','tiki-admin_transitions.php',1140,'','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Categories','tiki-admin_categories.php',1145,'feature_categories','tiki_p_admin_categories','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Banners','tiki-list_banners.php',1150,'feature_banners','tiki_p_admin_banners','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Edit Templates','tiki-edit_templates.php',1155,'feature_edit_templates','tiki_p_edit_templates','',0);

------------------------------------------------------------------------
r29595 | sylvieg | 2010-09-24 09:13:17 -0400 (sex, 24 set 2010) | 1 line

[MRG] Automatic merge, branches/6.x 29559 to 29594

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 29594)
+++ tiki.sql	(revision 29595)
@@ -1101,7 +1101,6 @@
 CREATE TABLE `tiki_links` (
   `fromPage` varchar(160) NOT NULL default '',
   `toPage` varchar(160) NOT NULL default '',
-  `reltype` varchar(50),
   PRIMARY KEY (`fromPage`,`toPage`),
   KEY `toPage` (`toPage`)
 ) ENGINE=MyISAM;
@@ -2511,7 +2510,7 @@
 
 DROP TABLE IF EXISTS `tiki_user_votings`;
 CREATE TABLE `tiki_user_votings` (
-  `user` varchar(200) default '',
+  `user` varchar(200) NOT NULL default '',
   `ip` varchar(15) default NULL,
   `id` varchar(255) NOT NULL default '',
   `optionId` int(10) NOT NULL default 0,
@@ -3537,7 +3536,8 @@
     `from` varchar(255) NOT NULL,
     `to` varchar(255) NOT NULL,
     `guards` text,
-    PRIMARY KEY(`transitionId`)
+    PRIMARY KEY(`transitionId`),
+	KEY `transition_lookup` (`type`, `from`)
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_auth_tokens`;

------------------------------------------------------------------------
r29384 | sylvieg | 2010-09-20 08:31:10 -0400 (seg, 20 set 2010) | 1 line

opps schema must be identical

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 29383)
+++ tiki.sql	(revision 29384)
@@ -3704,7 +3704,7 @@
 CREATE TABLE `tiki_todo` (
     `todoId` INT(12) NOT NULL auto_increment,
     `after` INT(12) NOT NULL,
-    `event` VARCHAR(50),
+    `event` VARCHAR(50) NOT NULL,
     `objectType` VARCHAR(50),
     `objectId` VARCHAR(255) default NULL,
     `from` VARCHAR(255) default NULL,

------------------------------------------------------------------------
r29383 | sylvieg | 2010-09-20 07:57:06 -0400 (seg, 20 set 2010) | 1 line

[ENH]todo: open the event type to more events

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 29382)
+++ tiki.sql	(revision 29383)
@@ -3704,7 +3704,7 @@
 CREATE TABLE `tiki_todo` (
     `todoId` INT(12) NOT NULL auto_increment,
     `after` INT(12) NOT NULL,
-    `event` ENUM('creation', 'modification', 'upload'),
+    `event` VARCHAR(50),
     `objectType` VARCHAR(50),
     `objectId` VARCHAR(255) default NULL,
     `from` VARCHAR(255) default NULL,

------------------------------------------------------------------------
r29381 | cdrwhite | 2010-09-20 06:11:31 -0400 (seg, 20 set 2010) | 2 lines

[FIX]Glitch in escape if the first word is a html tag, renaming to tiki-page_contribution, own feature feature_page_contribution, better permission checking
[ENH] View page button

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 29380)
+++ tiki.sql	(revision 29381)
@@ -2954,7 +2954,7 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_socialnetworks', 'user can register this site with social networks', 'admin', 'socialnetworks', 'y', 'feature_socialnetworks');
 
 
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_page-contribution_view', 'Can view contributions to a page', 'basic', 'wiki', NULL, 'feature_wiki');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_page_contribution_view', 'Can view contributions to a page', 'basic', 'wiki', NULL, 'feature_wiki');
 
 DROP TABLE IF EXISTS `users_usergroups`;
 CREATE TABLE `users_usergroups` (

------------------------------------------------------------------------
r29273 | sampaioprimo | 2010-09-15 15:17:41 -0400 (qua, 15 set 2010) | 2 lines

updating previously created menu entry to check if lang_use_db is enabled


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 29272)
+++ tiki.sql	(revision 29273)
@@ -1403,7 +1403,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','External Pages Cache','tiki-list_cache.php',1080,'cachepages','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Modules','tiki-admin_modules.php',1085,'','tiki_p_admin_modules','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Hotwords','tiki-admin_hotwords.php',1095,'feature_hotwords','tiki_p_admin','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Edit languages','tiki-edit_languages.php',1098,'','tiki_p_edit_languages','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Edit languages','tiki-edit_languages.php',1098,'lang_use_db','tiki_p_edit_languages','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','External Feeds','tiki-admin_rssmodules.php',1100,'','tiki_p_admin_rssmodules','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Menus','tiki-admin_menus.php',1105,'','tiki_p_edit_menu','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Polls','tiki-admin_polls.php',1110,'feature_polls','tiki_p_admin_polls','',0);

------------------------------------------------------------------------
r29253 | sampaioprimo | 2010-09-15 11:12:30 -0400 (qua, 15 set 2010) | 2 lines

[ENH] menu option under admin section for tiki-edit_languages.php


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 29252)
+++ tiki.sql	(revision 29253)
@@ -1403,6 +1403,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','External Pages Cache','tiki-list_cache.php',1080,'cachepages','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Modules','tiki-admin_modules.php',1085,'','tiki_p_admin_modules','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Hotwords','tiki-admin_hotwords.php',1095,'feature_hotwords','tiki_p_admin','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Edit languages','tiki-edit_languages.php',1098,'','tiki_p_edit_languages','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','External Feeds','tiki-admin_rssmodules.php',1100,'','tiki_p_admin_rssmodules','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Menus','tiki-admin_menus.php',1105,'','tiki_p_edit_menu','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Polls','tiki-admin_polls.php',1110,'feature_polls','tiki_p_admin_polls','',0);

------------------------------------------------------------------------
r29120 | sampaioprimo | 2010-09-10 16:17:08 -0400 (sex, 10 set 2010) | 4 lines

[ENH] options to control whether to display or not blog title, description and breadcrumbs
[ENH] remove help button from each blog title
[ENH] add sefurl to blog link in blog title


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 29119)
+++ tiki.sql	(revision 29120)
@@ -299,6 +299,10 @@
   `heading` text,
   `post_heading` text,
   `use_find` char(1) default NULL,
+  `use_title` char(1) default 'y',
+  `use_title_in_post` char(1) default 'y',
+  `use_description` char(1) default 'y',
+  `use_breadcrumbs` char(1) default 'n',
   `use_author` char(1) default NULL,
   `use_excerpt` char(1) default NULL,
   `add_date` char(1) default NULL,

------------------------------------------------------------------------
r29086 | sampaioprimo | 2010-09-09 18:08:14 -0400 (qui, 09 set 2010) | 2 lines

[FIX] remove 255 characters limit to store translations in the database


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 29085)
+++ tiki.sql	(revision 29086)
@@ -1075,9 +1075,9 @@
 DROP TABLE IF EXISTS `tiki_language`;
 CREATE TABLE `tiki_language` (
   `id` int(14) NOT NULL auto_increment,
-  `source` tinytext NOT NULL,
+  `source` text NOT NULL,
   `lang` char(16) NOT NULL default '',
-  `tran` tinytext,
+  `tran` text,
   `changed` bool,
   PRIMARY KEY (`id`)
 ) ENGINE=MyISAM;

------------------------------------------------------------------------
r29068 | chealer | 2010-09-09 13:41:01 -0400 (qui, 09 set 2010) | 1 line

[ENH][DB] Wiki attachments: Increase filename size limit from 80 to 255, supporting LFN and files from most Unix filesystems

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 29067)
+++ tiki.sql	(revision 29068)
@@ -2587,7 +2587,7 @@
 CREATE TABLE `tiki_wiki_attachments` (
   `attId` int(12) NOT NULL auto_increment,
   `page` varchar(200) NOT NULL default '',
-  `filename` varchar(80) default NULL,
+  `filename` varchar(255) default NULL,
   `filetype` varchar(80) default NULL,
   `filesize` int(14) default NULL,
   `user` varchar(200) NOT NULL default '',

------------------------------------------------------------------------
r28925 | pascalstjean | 2010-09-03 17:46:48 -0400 (sex, 03 set 2010) | 1 line

Added Article isPublished on/off feature. 

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 28924)
+++ tiki.sql	(revision 28925)
@@ -134,6 +134,7 @@
   `type` varchar(50) default NULL,
   `rating` decimal(3,2) default NULL,
   `isfloat` char(1) default NULL,
+  `ispublished` char(1) NOT NULL DEFAULT 'y',
   PRIMARY KEY (`articleId`),
   KEY `title` (`title`),
   KEY `heading` (`heading`(255)),

------------------------------------------------------------------------
r28869 | niclone | 2010-09-02 17:14:37 -0400 (qui, 02 set 2010) | 2 lines

[FIX] also added sql to tiki.sql for tiki-invit


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 28868)
+++ tiki.sql	(revision 28869)
@@ -3728,3 +3728,32 @@
   UNIQUE KEY `shorturl` (`shorturl`),
   KEY `longurl_hash` (`longurl_hash`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
+
+DROP TABLE IF EXISTS `tiki_invit`;
+CREATE TABLE `tiki_invit` (
+  `id` int(11) NOT NULL auto_increment,
+  `inviter` varchar(200) NOT NULL,
+  `groups` varchar(255) default NULL,
+  `ts` int(11) NOT NULL,
+  `emailsubject` varchar(255) NOT NULL,
+  `emailcontent` text NOT NULL,
+  `wikicontent` text,
+  `wikipageafter` varchar(255) default NULL,
+  PRIMARY KEY  (`id`)
+);
+
+DROP TABLE IF EXISTS `tiki_invited`;
+CREATE TABLE `tiki_invited` (
+  `id` int(11) NOT NULL auto_increment,
+  `id_invit` int(11) NOT NULL,
+  `email` varchar(255) NOT NULL,
+  `firstname` varchar(24) NOT NULL,
+  `lastname` varchar(24) NOT NULL,
+  `used` enum('no','registered','logged') NOT NULL,
+  `used_on_user` varchar(200) default NULL,
+  PRIMARY KEY  (`id`),
+  KEY `id_invit` (`id_invit`),
+  KEY `used_on_user` (`used_on_user`)
+);
+
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES ('tiki_p_invit', 'Can invit users by email, and include them in groups', 'registered', 'tiki', NULL, 'feature_invit');

------------------------------------------------------------------------
r28852 | sylvieg | 2010-09-02 08:11:18 -0400 (qui, 02 set 2010) | 1 line

[FIX]group: really memorise the group expiration date to avoid changing the assignment date for periods > 1. Displays assignement+expiration date in the memberlist

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 28851)
+++ tiki.sql	(revision 28852)
@@ -2955,6 +2955,7 @@
   `userId` int(8) NOT NULL default '0',
   `groupName` varchar(255) NOT NULL default '',
   `created` int(14) default NULL,
+  `expire` int(14) default NULL,
   PRIMARY KEY (`userId`,`groupName`(30))
 ) ENGINE=MyISAM;
 

------------------------------------------------------------------------
r28800 | sylvieg | 2010-08-31 06:55:55 -0400 (ter, 31 ago 2010) | 1 line

[FIX}freetag: increase freetag size

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 28799)
+++ tiki.sql	(revision 28800)
@@ -3197,8 +3197,8 @@
 DROP TABLE IF EXISTS `tiki_freetags`;
 CREATE TABLE `tiki_freetags` (
   `tagId` int(10) unsigned NOT NULL auto_increment,
-  `tag` varchar(30) NOT NULL default '',
-  `raw_tag` varchar(50) NOT NULL default '',
+  `tag` varchar(128) NOT NULL default '',
+  `raw_tag` varchar(150) NOT NULL default '',
   `lang` varchar(16) NULL,
   PRIMARY KEY (`tagId`)
 ) ENGINE=MyISAM;

------------------------------------------------------------------------
r28771 | robertplummer | 2010-08-30 12:50:48 -0400 (seg, 30 ago 2010) | 3 lines

[MOD] Added the columns style and class to table tiki_sheet_values and the modification on how to handle it.
[MOD] Added 20100830_sheet_add_styles_and_classes.sql to take care of updates.
[MOD] Added most of the needed modifications to grid.php to handle style and class and a bit of js to tiki-jquery.js to send the information to the php handler.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 28770)
+++ tiki.sql	(revision 28771)
@@ -1980,6 +1980,8 @@
   `height` int(4) NOT NULL default '1',
   `format` varchar(255) default NULL,
   `user` varchar(200) default '',
+  `style` varchar( 255 ) default '',
+  `class` varchar( 255 ) default '',
   UNIQUE KEY `sheetId` (`sheetId`,begin,`rowIndex`,`columnIndex`),
   KEY `sheetId_2` (`sheetId`,`rowIndex`,`columnIndex`)
 ) ENGINE=MyISAM;

------------------------------------------------------------------------
r28735 | sylvieg | 2010-08-27 08:26:30 -0400 (sex, 27 ago 2010) | 1 line

[FIX]blog: fix commit 28338; post_heading was added in articles not blogs

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 28734)
+++ tiki.sql	(revision 28735)
@@ -125,7 +125,6 @@
   `expireDate` int(14) default NULL,
   `created` int(14) default NULL,
   `heading` text,
-  `post_heading` text,
   `body` text,
   `hash` varchar(32) default NULL,
   `author` varchar(200) default NULL,
@@ -297,6 +296,7 @@
   `hits` int(8) default NULL,
   `activity` decimal(4,2) default NULL,
   `heading` text,
+  `post_heading` text,
   `use_find` char(1) default NULL,
   `use_author` char(1) default NULL,
   `use_excerpt` char(1) default NULL,

------------------------------------------------------------------------
r28716 | sampaioprimo | 2010-08-25 17:38:23 -0400 (qua, 25 ago 2010) | 2 lines

[KIL] blog option 'use_title' (as proposed in the blog revamp page)


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 28715)
+++ tiki.sql	(revision 28716)
@@ -298,7 +298,6 @@
   `activity` decimal(4,2) default NULL,
   `heading` text,
   `use_find` char(1) default NULL,
-  `use_title` char(1) default NULL,
   `use_author` char(1) default NULL,
   `use_excerpt` char(1) default NULL,
   `add_date` char(1) default NULL,

------------------------------------------------------------------------
r28713 | sampaioprimo | 2010-08-25 13:16:27 -0400 (qua, 25 ago 2010) | 2 lines

[ENH] keep track of changed translations in the database


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 28712)
+++ tiki.sql	(revision 28713)
@@ -1074,10 +1074,12 @@
 
 DROP TABLE IF EXISTS `tiki_language`;
 CREATE TABLE `tiki_language` (
+  `id` int(14) NOT NULL auto_increment,
   `source` tinytext NOT NULL,
   `lang` char(16) NOT NULL default '',
   `tran` tinytext,
-  PRIMARY KEY (`source`(255),`lang`)
+  `changed` bool,
+  PRIMARY KEY (`id`)
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_link_cache`;

------------------------------------------------------------------------
r28698 | sampaioprimo | 2010-08-24 11:49:51 -0400 (ter, 24 ago 2010) | 2 lines

[NEW] blog post excerpt


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 28697)
+++ tiki.sql	(revision 28698)
@@ -257,6 +257,7 @@
   `blogId` int(8) NOT NULL default '0',
   `data` text,
   `data_size` int(11) unsigned NOT NULL default '0',
+  `excerpt` text default NULL,
   `created` int(14) default NULL,
   `user` varchar(200) default '',
   `trackbacks_to` text,
@@ -299,6 +300,7 @@
   `use_find` char(1) default NULL,
   `use_title` char(1) default NULL,
   `use_author` char(1) default NULL,
+  `use_excerpt` char(1) default NULL,
   `add_date` char(1) default NULL,
   `add_poster` char(1) default NULL,
   `allow_comments` char(1) default NULL,

------------------------------------------------------------------------
r28685 | marclaporte | 2010-08-23 17:55:24 -0400 (seg, 23 ago 2010) | 1 line

[FIX] various minor fixes to permission names (typos, spelling, unclearness, etc) for new installs. Upgrades are unnafected

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 28684)
+++ tiki.sql	(revision 28685)
@@ -2677,15 +2677,15 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_events', 'Can view events details', 'registered', 'calendar', NULL, 'feature_calendar');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_calendar_add_my_particip', 'Can add own user to the participants', 'registered', 'calendar', NULL, 'feature_calendar');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_calendar_add_guest_particip', 'Can add guest to the participants', 'registered', 'calendar', NULL, 'feature_calendar');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_tiki_calendar', 'Can view Tikiwiki tools calendar', 'basic', 'calendar', NULL, 'feature_calendar');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_tiki_calendar', 'Can view Tiki tools calendar', 'basic', 'calendar', NULL, 'feature_calendar');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_chat', 'Administrator, can create channels remove channels etc', 'editors', 'chat', 'y', 'feature_minichat,feature_live_support');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_chat', 'Can use the chat system', 'registered', 'chat', NULL, 'feature_minichat,feature_live_support');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_cms', 'Can admin the cms', 'editors', 'cms', 'y', 'feature_articles');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_cms', 'Can admin the articles', 'editors', 'cms', 'y', 'feature_articles');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_approve_submission', 'Can approve submissions', 'editors', 'cms', NULL, 'feature_articles');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_articles_admin_topics', 'Can admin article topics', 'editors', 'cms', NULL, 'feature_articles');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_articles_admin_types', 'Can admin article types', 'editors', 'cms', NULL, 'feature_articles');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_articles_read_heading', 'Can read article headings', 'basic', 'cms', NULL, 'feature_articles');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_autoapprove_submission', 'Submited articles automatically approved', 'editors', 'cms', NULL, 'feature_articles');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_autoapprove_submission', 'Submitted articles automatically approved', 'editors', 'cms', NULL, 'feature_articles');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_article', 'Can edit articles', 'editors', 'cms', NULL, 'feature_articles');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_submission', 'Can edit submissions', 'editors', 'cms', NULL, 'feature_articles');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_read_article', 'Can read articles', 'basic', 'cms', NULL, 'feature_articles');
@@ -2698,14 +2698,14 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_directory', 'Can admin the directory', 'editors', 'directory', 'y', 'feature_directory');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_directory_cats', 'Can admin directory categories', 'editors', 'directory', NULL, 'feature_directory');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_directory_sites', 'Can admin directory sites', 'editors', 'directory', NULL, 'feature_directory');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_autosubmit_link', 'Submited links are valid', 'editors', 'directory', NULL, 'feature_directory');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_autosubmit_link', 'Submitted links are valid', 'editors', 'directory', NULL, 'feature_directory');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_submit_link', 'Can submit sites to the directory', 'basic', 'directory', NULL, 'feature_directory');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_validate_links', 'Can validate submited links', 'editors', 'directory', NULL, 'feature_directory');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_validate_links', 'Can validate submitted links', 'editors', 'directory', NULL, 'feature_directory');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_directory', 'Can use the directory', 'basic', 'directory', NULL, 'feature_directory');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_faqs', 'Can admin faqs', 'editors', 'faqs', 'y', 'feature_faqs');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_suggest_faq', 'Can suggest faq questions', 'basic', 'faqs', NULL, 'feature_faqs');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_faqs', 'Can view faqs', 'basic', 'faqs', NULL, 'feature_faqs');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin', 'Administrator, can manage users groups and permissions, Hotwords and all the weblog features', 'admin', 'tiki', 'y', NULL);
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin', 'Administrator, can manage users groups and permissions, and all features', 'admin', 'tiki', 'y', NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_users', 'Can admin users', 'admin', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_access_closed_site', 'Can access site when closed', 'admin', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_banners', 'Administrator, can admin banners', 'admin', 'tiki', NULL, NULL);
@@ -2732,7 +2732,7 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_actionlog', 'Can view action log', 'registered', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_actionlog_owngroups', 'Can view action log for users of his own groups', 'registered', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_integrator', 'Can view integrated repositories', 'basic', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_referer_stats', 'Can view referer stats', 'editors', 'tiki', NULL, NULL);
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_referer_stats', 'Can view referrer stats', 'editors', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_stats', 'Can view site stats', 'basic', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_templates', 'Can view site templates', 'admin', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_blog_admin', 'Can admin blogs', 'editors', 'blogs', 'y', 'feature_blogs');
@@ -2761,7 +2761,7 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_forum_post', 'Can post in forums', 'registered', 'forums', NULL, 'feature_forums');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_forum_post_topic', 'Can start threads in forums', 'registered', 'forums', NULL, 'feature_forums');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_forum_read', 'Can read forums', 'basic', 'forums', NULL, 'feature_forums');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_forums_report', 'Can report msgs to moderator', 'registered', 'forums', NULL, 'feature_forums');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_forums_report', 'Can report posts to moderator', 'registered', 'forums', NULL, 'feature_forums');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_forum_vote', 'Can vote comments in forums', 'registered', 'forums', NULL, 'feature_forums');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_freetags', 'Can admin freetags', 'admin', 'freetags', 'y', 'feature_freetags');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_galleries', 'Can admin Image Galleries', 'editors', 'image galleries', 'y', 'feature_galleries');
@@ -2795,7 +2795,7 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_sheet', 'Can create and edit sheets', 'editors', 'sheet', NULL, 'feature_sheet');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_sheet', 'Can view sheet', 'basic', 'sheet', NULL, 'feature_sheet');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_sheet_history', 'Can view sheet history', 'admin', 'sheet', NULL, 'feature_sheet');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_shoutbox', 'Can admin shoutbox (Edit/remove msgs)', 'editors', 'shoutbox', 'y', 'feature_shoutbox');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_shoutbox', 'Can admin shoutbox (Edit/remove messages)', 'editors', 'shoutbox', 'y', 'feature_shoutbox');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_post_shoutbox', 'Can post messages in shoutbox', 'basic', 'shoutbox', NULL, 'feature_shoutbox');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_shoutbox', 'Can view shoutbox', 'basic', 'shoutbox', NULL, 'feature_shoutbox');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_surveys', 'Can admin surveys', 'editors', 'surveys', 'y', 'feature_surveys');
@@ -2808,14 +2808,14 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_create_tracker_items', 'Can create new items for trackers', 'registered', 'trackers', NULL, 'feature_trackers');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_list_trackers', 'Can list trackers', 'basic', 'trackers', NULL, 'feature_trackers');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_modify_tracker_items', 'Can change tracker items', 'registered', 'trackers', NULL, 'feature_trackers');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_modify_tracker_items_pending', 'Can change tracker pending items', 'registered', 'trackers', NULL, 'feature_trackers');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_modify_tracker_items_closed', 'Can change tracker closed items', 'registered', 'trackers', NULL, 'feature_trackers');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_modify_tracker_items_pending', 'Can change pending tracker items', 'registered', 'trackers', NULL, 'feature_trackers');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_modify_tracker_items_closed', 'Can change closed tracker items', 'registered', 'trackers', NULL, 'feature_trackers');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_tracker_view_ratings', 'Can view rating result for tracker items', 'basic', 'trackers', NULL, 'feature_trackers');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_tracker_vote_ratings', 'Can vote a rating for tracker items', 'registered', 'trackers', NULL, 'feature_trackers');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_tracker_revote_ratings', 'Can re-vote a rating for tracker items', 'registered', 'trackers', NULL, 'feature_trackers');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_trackers', 'Can view trackers', 'basic', 'trackers', NULL, 'feature_trackers');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_trackers_closed', 'Can view trackers closed items', 'registered', 'trackers', NULL, 'feature_trackers');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_trackers_pending', 'Can view trackers pending items', 'editors', 'trackers', NULL, 'feature_trackers');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_trackers_closed', 'Can view closed trackers items', 'registered', 'trackers', NULL, 'feature_trackers');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_trackers_pending', 'Can view pending trackers items', 'editors', 'trackers', NULL, 'feature_trackers');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_watch_trackers', 'Can watch tracker', 'registered', 'trackers', NULL, 'feature_trackers');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_export_tracker', 'Can export tracker items', 'registered', 'trackers', NULL, 'feature_trackers');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_wiki', 'Can admin the wiki', 'editors', 'wiki', 'y', 'feature_wiki');
@@ -2835,7 +2835,7 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view', 'Can view page/pages', 'basic', 'wiki', NULL, 'feature_wiki');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_wiki_view_ref', 'Can view in module and feed the wiki pages reference', 'basic', 'wiki', NULL, 'feature_wiki');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_watch_structure', 'Can watch structure', 'registered', 'wiki', NULL, 'feature_wiki_structure');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_wiki_admin_attachments', 'Can admin attachments to wiki pages', 'editors', 'wiki', NULL, 'feature_wiki_attachments');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_wiki_admin_attachments', 'Can admin attachments on wiki pages', 'editors', 'wiki', NULL, 'feature_wiki_attachments');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_wiki_admin_ratings', 'Can add and change ratings on wiki pages', 'admin', 'wiki', NULL, 'feature_wiki_ratings');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_wiki_attach_files', 'Can attach files to wiki pages', 'registered', 'wiki', NULL, 'feature_wiki_attachments');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_wiki_view_attachments', 'Can view wiki attachments and download', 'registered', 'wiki', NULL, 'feature_wiki_attachments');
@@ -2889,9 +2889,9 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_map_view_mapfiles', 'Can view contents of mapfiles', 'registered', 'maps', NULL, 'feature_maps');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_use_webmail', 'Can use webmail', 'registered', 'webmail', NULL, 'feature_webmail,feature_contacts');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_use_group_webmail', 'Can use group webmail', 'registered', 'webmail', NULL, 'feature_webmail,feature_contacts');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_group_webmail', 'Can administrate group webmail accounts', 'registered', 'webmail', NULL, 'feature_webmail,feature_contacts');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_group_webmail', 'Can admin group webmail accounts', 'registered', 'webmail', NULL, 'feature_webmail,feature_contacts');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_use_personal_webmail', 'Can use personal webmail accounts', 'registered', 'webmail', NULL, 'feature_webmail,feature_contacts');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_personal_webmail', 'Can administrate personal webmail accounts', 'registered', 'webmail', NULL, 'feature_webmail,feature_contacts');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_personal_webmail', 'Can admin personal webmail accounts', 'registered', 'webmail', NULL, 'feature_webmail,feature_contacts');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_plugin_viewdetail', 'Can view unapproved plugin details', 'registered', 'wiki', NULL, 'feature_wiki');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_plugin_preview', 'Can execute unapproved plugin', 'registered', 'wiki', NULL, 'feature_wiki');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_plugin_approve', 'Can approve plugin execution', 'editors', 'wiki', NULL, 'feature_wiki');
@@ -2898,13 +2898,13 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_trust_input', 'Trust all user inputs including plugins (no security checks)', 'admin', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_backlink', 'View page backlinks', 'basic', 'wiki', NULL, 'feature_wiki');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_notifications', 'Can admin mail notifications', 'editors', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_invite', 'Can invite user in groups', 'editors', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_delete_account', 'Can delete his own account', 'admin', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_importer', 'Can use the Tiki Importer', 'admin', 'tiki', 'y', NULL);
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_invite', 'Can invite user to groups', 'editors', 'tiki', NULL, NULL);
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_delete_account', 'Can delete his/her own account', 'admin', 'tiki', NULL, NULL);
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_importer', 'Can use the importer', 'admin', 'tiki', 'y', NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_categories', 'Can admin categories', 'editors', 'category', 'y', 'feature_categories');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_category', 'Can see the category in a listing', 'basic', 'category', NULL, 'feature_categories');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_modify_object_categories', 'Can change the categories on the object', 'editors', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_add_object', 'Can add objects in the category', 'editors', 'category', NULL, 'feature_categories');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_modify_object_categories', 'Can change the categories of the object', 'editors', 'tiki', NULL, NULL);
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_add_object', 'Can add objects to the category', 'editors', 'category', NULL, 'feature_categories');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_remove_object', 'Can remove objects from the category', 'editors', 'category', NULL, 'feature_categories');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_create_category', 'Can create new categories', 'admin', 'category', NULL, 'feature_categories');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_perspective_view', 'Can view the perspective', 'basic', 'perspective', NULL, 'feature_perspective');
@@ -2933,14 +2933,14 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_view', 'Can view payment requests and details', 'admin', 'payment', NULL, 'payment_feature');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_manual', 'Can enter manual payments', 'admin', 'payment', NULL, 'payment_feature');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_request', 'Can request a payment', 'admin', 'payment', NULL, 'payment_feature');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES ('tiki_p_admin_modules', 'User can Administer Modules', 'registered', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_tracker_dump', 'Can save a CSV backup of entire trackers', 'admin', 'trackers', NULL, 'feature_trackers');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES ('tiki_p_admin_modules', 'User can administer modules', 'registered', 'tiki', NULL, NULL);
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_tracker_dump', 'Can save a .CSV backup of entire trackers', 'admin', 'trackers', NULL, 'feature_trackers');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_bigbluebutton_join', 'Can join a meeting', 'basic', 'bigbluebutton', NULL, 'bigbluebutton_feature');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_bigbluebutton_moderate', 'Can moderate a meeting', 'admin', 'bigbluebutton', NULL, 'bigbluebutton_feature');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_bigbluebutton_create', 'Can create a meeting', 'admin', 'bigbluebutton', NULL, 'bigbluebutton_feature');
 
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_socialnetworks', 'user can use social network integration', 'registered', 'socialnetworks', NULL, 'feature_socialnetworks');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_socialnetworks', 'user can register this site with socialnetworks', 'admin', 'socialnetworks', 'y', 'feature_socialnetworks');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_socialnetworks', 'user can register this site with social networks', 'admin', 'socialnetworks', 'y', 'feature_socialnetworks');
 
 
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_page-contribution_view', 'Can view contributions to a page', 'basic', 'wiki', NULL, 'feature_wiki');

------------------------------------------------------------------------
r28624 | Jyhem | 2010-08-20 08:12:16 -0400 (sex, 20 ago 2010) | 1 line

[ENH] Store parsing format of blog posts for correct display when some are entered wysiwyg and others are not

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 28623)
+++ tiki.sql	(revision 28624)
@@ -263,6 +263,7 @@
   `trackbacks_from` text,
   `title` varchar(255) default NULL,
   `priv` varchar(1) default NULL,
+  `wysiwyg` varchar(1) default NULL,
   PRIMARY KEY (`postId`),
   KEY `data` (`data`(255)),
   KEY `blogId` (`blogId`),

------------------------------------------------------------------------
r28596 | chealer | 2010-08-18 14:39:04 -0400 (qua, 18 ago 2010) | 1 line

tiki_*_watches: restore index on event+object+user/group 

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 28595)
+++ tiki.sql	(revision 28596)
@@ -983,7 +983,8 @@
   `title` varchar(250) default NULL,
   `type` varchar(200) default NULL,
   `url` varchar(250) default NULL,
-  PRIMARY KEY (`watchId`)
+  PRIMARY KEY (`watchId`),
+  INDEX `event-object-group` ( `event` , `object` ( 100 ) , `group` ( 50 ) ) 
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_history`;
@@ -2518,7 +2519,8 @@
   `type` varchar(200) default NULL,
   `url` varchar(250) default NULL,
   `email` varchar(200) default NULL,
-  PRIMARY KEY (`watchId`)
+  PRIMARY KEY (`watchId`),
+  INDEX `event-object-user` ( `event` , `object` ( 100 ) , `user` ( 50 ) )
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_userfiles`;

------------------------------------------------------------------------
r28592 | chealer | 2010-08-18 12:41:53 -0400 (qua, 18 ago 2010) | 1 line

move watches primary key on watchId allowing to make user watches email null. 

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 28591)
+++ tiki.sql	(revision 28592)
@@ -983,8 +983,7 @@
   `title` varchar(250) default NULL,
   `type` varchar(200) default NULL,
   `url` varchar(250) default NULL,
-  KEY `watchId` (`watchId`),
-  PRIMARY KEY (`group`(50),event,object(100))
+  PRIMARY KEY (`watchId`)
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_history`;
@@ -2519,8 +2518,7 @@
   `type` varchar(200) default NULL,
   `url` varchar(250) default NULL,
   `email` varchar(200) default NULL,
-  KEY `watchId` (`watchId`),
-  PRIMARY KEY (`user`(50),event,object(100),email(50))
+  PRIMARY KEY (`watchId`)
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_userfiles`;
@@ -3594,7 +3592,7 @@
     `description` VARCHAR(100) NOT NULL,
     `actions` TEXT,
     `detail` TEXT,
-	`userId` int(8),
+    `userId` int(8),
     PRIMARY KEY( `paymentRequestId` )
 );
 
@@ -3606,19 +3604,19 @@
     `amount` DECIMAL(7,2),
     `type` VARCHAR(15),
     `details` TEXT,
-	`userId` int(8),
+    `userId` int(8),
     PRIMARY KEY(`paymentReceivedId`),
     KEY `payment_request_ix` (`paymentRequestId`)
 );
 DROP TABLE IF EXISTS `tiki_discount`;
 CREATE TABLE `tiki_discount`( 
-	`id` INT NOT NULL AUTO_INCREMENT,
-	`code` VARCHAR(255),
-	`value` VARCHAR(255),
-	`max` INT,
-	`comment` TEXT,
-	PRIMARY KEY(`id`),
-	KEY `code` (`code`)
+    `id` INT NOT NULL AUTO_INCREMENT,
+    `code` VARCHAR(255),
+    `value` VARCHAR(255),
+    `max` INT,
+    `comment` TEXT,
+    PRIMARY KEY(`id`),
+    KEY `code` (`code`)
 );
 DROP TABLE IF EXISTS `tiki_translations_in_progress`;
 CREATE TABLE IF NOT EXISTS `tiki_translations_in_progress` (
@@ -3689,24 +3687,24 @@
 
 DROP TABLE IF EXISTS `tiki_todo`;
 CREATE TABLE `tiki_todo` (
-	`todoId` INT(12) NOT NULL auto_increment,
-	`after` INT(12) NOT NULL,
-	`event` ENUM('creation', 'modification', 'upload'),
-	`objectType` VARCHAR(50),
-	`objectId` VARCHAR(255) default NULL,
-	`from` VARCHAR(255) default NULL,
-	`to` VARCHAR(255) default NULL,
-	PRIMARY KEY (`todoId`),
-	KEY `what` (`objectType`, `objectId`),
-	KEY `after` (`after`)
+    `todoId` INT(12) NOT NULL auto_increment,
+    `after` INT(12) NOT NULL,
+    `event` ENUM('creation', 'modification', 'upload'),
+    `objectType` VARCHAR(50),
+    `objectId` VARCHAR(255) default NULL,
+    `from` VARCHAR(255) default NULL,
+    `to` VARCHAR(255) default NULL,
+    PRIMARY KEY (`todoId`),
+    KEY `what` (`objectType`, `objectId`),
+    KEY `after` (`after`)
 );
 DROP TABLE IF EXISTS `tiki_todo_notif`;
 CREATE TABLE `tiki_todo_notif` (
-	`todoId` INT(12) NOT NULL,
-	`objectType` VARCHAR(50),
-	`objectId` VARCHAR(255) default NULL,
-	KEY `todoId` (`todoId`),
-	KEY `objectId` (`objectId`)
+    `todoId` INT(12) NOT NULL,
+    `objectType` VARCHAR(50),
+    `objectId` VARCHAR(255) default NULL,
+    KEY `todoId` (`todoId`),
+    KEY `objectId` (`objectId`)
 );
 
 DROP TABLE IF EXISTS `tiki_url_shortener`;

------------------------------------------------------------------------
r28583 | sampaioprimo | 2010-08-18 00:48:51 -0400 (qua, 18 ago 2010) | 2 lines

[NEW] website and email optional fields for comments


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 28582)
+++ tiki.sql	(revision 28583)
@@ -528,6 +528,8 @@
   `title` varchar(255) default NULL,
   `data` text,
   `hash` varchar(32) default NULL,
+  `email` varchar(200) default NULL,
+  `website` varchar(200) default NULL,
   `user_ip` varchar(15) default NULL,
   `summary` varchar(240) default NULL,
   `smiley` varchar(80) default NULL,

------------------------------------------------------------------------
r28542 | sampaioprimo | 2010-08-16 12:40:44 -0400 (seg, 16 ago 2010) | 2 lines

[NEW] field to set the number of posts to display in the related content section of a post


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 28541)
+++ tiki.sql	(revision 28542)
@@ -304,6 +304,7 @@
   `show_avatar` char(1) default NULL,
   `always_owner` char(1) default NULL,
   `show_related` char(1) default NULL,
+  `related_max` int(4) default 5,
   PRIMARY KEY (`blogId`),
   KEY `title` (`title`),
   KEY `description` (`description`(255)),

------------------------------------------------------------------------
r28476 | sampaioprimo | 2010-08-12 16:50:54 -0400 (qui, 12 ago 2010) | 2 lines

[NEW] related posts on the bottom of each post


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 28475)
+++ tiki.sql	(revision 28476)
@@ -303,6 +303,7 @@
   `allow_comments` char(1) default NULL,
   `show_avatar` char(1) default NULL,
   `always_owner` char(1) default NULL,
+  `show_related` char(1) default NULL,
   PRIMARY KEY (`blogId`),
   KEY `title` (`title`),
   KEY `description` (`description`(255)),

------------------------------------------------------------------------
r28360 | sampaioprimo | 2010-08-07 01:17:06 -0400 (sÃ¡b, 07 ago 2010) | 2 lines

modify fields in tiki_language to tinytext instead of tinyblob


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 28359)
+++ tiki.sql	(revision 28360)
@@ -1067,9 +1067,9 @@
 
 DROP TABLE IF EXISTS `tiki_language`;
 CREATE TABLE `tiki_language` (
-  `source` tinyblob NOT NULL,
+  `source` tinytext NOT NULL,
   `lang` char(16) NOT NULL default '',
-  `tran` tinyblob,
+  `tran` tinytext,
   PRIMARY KEY (`source`(255),`lang`)
 ) ENGINE=MyISAM;
 

------------------------------------------------------------------------
r28338 | Jyhem | 2010-08-06 10:42:54 -0400 (sex, 06 ago 2010) | 1 line

[NEW] Allow custom blog post heading

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 28337)
+++ tiki.sql	(revision 28338)
@@ -125,6 +125,7 @@
   `expireDate` int(14) default NULL,
   `created` int(14) default NULL,
   `heading` text,
+  `post_heading` text,
   `body` text,
   `hash` varchar(32) default NULL,
   `author` varchar(200) default NULL,

------------------------------------------------------------------------
r28326 | sampaioprimo | 2010-08-05 16:42:05 -0400 (qui, 05 ago 2010) | 2 lines

[KIL] feature to create a new language in the database (new languages created using the database were used nowhere)


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 28325)
+++ tiki.sql	(revision 28326)
@@ -1072,15 +1072,6 @@
   PRIMARY KEY (`source`(255),`lang`)
 ) ENGINE=MyISAM;
 
-DROP TABLE IF EXISTS `tiki_languages`;
-CREATE TABLE `tiki_languages` (
-  `lang` char(16) NOT NULL default '',
-  `language` varchar(255) default NULL,
-  PRIMARY KEY (`lang`)
-) ENGINE=MyISAM;
-
-INSERT INTO tiki_languages (lang, language) VALUES ('en','English');
-
 DROP TABLE IF EXISTS `tiki_link_cache`;
 CREATE TABLE `tiki_link_cache` (
   `cacheId` int(14) NOT NULL auto_increment,

------------------------------------------------------------------------
r28263 | cdrwhite | 2010-08-02 11:46:13 -0400 (seg, 02 ago 2010) | 1 line

[ENH] Adding URL-Shortener functionality to socialnetworks and rename promote to share

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 28262)
+++ tiki.sql	(revision 28263)
@@ -2730,7 +2730,7 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_site_report', 'Can report a link to the webmaster', 'basic', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_subscribe_groups', 'Can subscribe to groups', 'registered', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_tell_a_friend', 'Can send a link to a friend', 'Basic', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_promote_page', 'Can promote a page (email, twitter, facebook)', 'Basic', 'tiki', NULL, NULL);
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_share', 'Can share a page (email, twitter, facebook, message, forums)', 'Basic', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_use_HTML', 'Can use HTML in pages', 'editors', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_actionlog', 'Can view action log', 'registered', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_actionlog_owngroups', 'Can view action log for users of his own groups', 'registered', 'tiki', NULL, NULL);
@@ -3712,3 +3712,16 @@
 	KEY `todoId` (`todoId`),
 	KEY `objectId` (`objectId`)
 );
+
+DROP TABLE IF EXISTS `tiki_url_shortener`;
+CREATE TABLE `tiki_url_shortener` (
+  `urlId` int(10) unsigned NOT NULL AUTO_INCREMENT,
+  `user` varchar(200) NOT NULL,
+  `longurl` tinytext NOT NULL,
+  `longurl_hash` varchar(32) NOT NULL,
+  `service` varchar(32) NOT NULL,
+  `shorturl` varchar(63) NOT NULL,
+  PRIMARY KEY (`urlId`),
+  UNIQUE KEY `shorturl` (`shorturl`),
+  KEY `longurl_hash` (`longurl_hash`)
+) ENGINE=MyISAM AUTO_INCREMENT=1 ;

------------------------------------------------------------------------
r28213 | sylvieg | 2010-07-30 10:40:48 -0400 (sex, 30 jul 2010) | 1 line

[FIX]articles: better implementation 27943: a global param giving the image width in list mode does not work as image can be landscape or portrait. So need to be defined for each article

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 28212)
+++ tiki.sql	(revision 28213)
@@ -119,6 +119,7 @@
   `image_size` int(14) default NULL,
   `image_x` int(4) default NULL,
   `image_y` int(4) default NULL,
+  `list_image_x` int(4) default NULL,
   `image_data` longblob,
   `publishDate` int(14) default NULL,
   `expireDate` int(14) default NULL,

------------------------------------------------------------------------
r28156 | cdrwhite | 2010-07-27 12:12:07 -0400 (ter, 27 jul 2010) | 2 lines

[NEW] feature_promote allows to promote a page via email (like tell a friend) + post on facebook wall + Tweet via twitter


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 28155)
+++ tiki.sql	(revision 28156)
@@ -2729,6 +2729,7 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_site_report', 'Can report a link to the webmaster', 'basic', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_subscribe_groups', 'Can subscribe to groups', 'registered', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_tell_a_friend', 'Can send a link to a friend', 'Basic', 'tiki', NULL, NULL);
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_promote_page', 'Can promote a page (email, twitter, facebook)', 'Basic', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_use_HTML', 'Can use HTML in pages', 'editors', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_actionlog', 'Can view action log', 'registered', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_actionlog_owngroups', 'Can view action log for users of his own groups', 'registered', 'tiki', NULL, NULL);

------------------------------------------------------------------------
r28114 | marclaporte | 2010-07-23 15:49:24 -0400 (sex, 23 jul 2010) | 1 line

[FIX] stray comma

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 28113)
+++ tiki.sql	(revision 28114)
@@ -3526,7 +3526,7 @@
     `from` varchar(255) NOT NULL,
     `to` varchar(255) NOT NULL,
     `guards` text,
-    PRIMARY KEY(`transitionId`),
+    PRIMARY KEY(`transitionId`)
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_auth_tokens`;
@@ -3709,4 +3709,4 @@
 	`objectId` VARCHAR(255) default NULL,
 	KEY `todoId` (`todoId`),
 	KEY `objectId` (`objectId`)
-);
\ No newline at end of file
+);

------------------------------------------------------------------------
r28107 | sylvieg | 2010-07-23 09:45:50 -0400 (sex, 23 jul 2010) | 1 line

[FIX]missing commit to 28085

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 28106)
+++ tiki.sql	(revision 28107)
@@ -3705,6 +3705,7 @@
 DROP TABLE IF EXISTS `tiki_todo_notif`;
 CREATE TABLE `tiki_todo_notif` (
 	`todoId` INT(12) NOT NULL,
+	`objectType` VARCHAR(50),
 	`objectId` VARCHAR(255) default NULL,
 	KEY `todoId` (`todoId`),
 	KEY `objectId` (`objectId`)

------------------------------------------------------------------------
r28085 | sylvieg | 2010-07-21 11:21:19 -0400 (qua, 21 jul 2010) | 1 line

[FIX]tracker: reimplement 27986 in special tables: possibility to change the status of a tracker's items a certain time after creation or last modif + notof creator before a certain time : a cron job must be set up

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 28084)
+++ tiki.sql	(revision 28085)
@@ -3688,3 +3688,24 @@
     KEY `relation_source_ix` (`source_type`, `source_itemId`),
     KEY `relation_target_ix` (`target_type`, `target_itemId`)
 );
+
+DROP TABLE IF EXISTS `tiki_todo`;
+CREATE TABLE `tiki_todo` (
+	`todoId` INT(12) NOT NULL auto_increment,
+	`after` INT(12) NOT NULL,
+	`event` ENUM('creation', 'modification', 'upload'),
+	`objectType` VARCHAR(50),
+	`objectId` VARCHAR(255) default NULL,
+	`from` VARCHAR(255) default NULL,
+	`to` VARCHAR(255) default NULL,
+	PRIMARY KEY (`todoId`),
+	KEY `what` (`objectType`, `objectId`),
+	KEY `after` (`after`)
+);
+DROP TABLE IF EXISTS `tiki_todo_notif`;
+CREATE TABLE `tiki_todo_notif` (
+	`todoId` INT(12) NOT NULL,
+	`objectId` VARCHAR(255) default NULL,
+	KEY `todoId` (`todoId`),
+	KEY `objectId` (`objectId`)
+);
\ No newline at end of file

------------------------------------------------------------------------
r28083 | sylvieg | 2010-07-21 11:04:00 -0400 (qua, 21 jul 2010) | 1 line

[FIX]transition: partial rollback to batch transition

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 28082)
+++ tiki.sql	(revision 28083)
@@ -3523,15 +3523,10 @@
     `preserve` int(1) NOT NULL DEFAULT 0,
     `name` varchar(50),
     `type` varchar(20) NOT NULL,
-	`objectId` int(12) DEFAULT NULL,
     `from` varchar(255) NOT NULL,
     `to` varchar(255) NOT NULL,
     `guards` text,
-    `batch` char(1) DEFAULT NULL,
     PRIMARY KEY(`transitionId`),
-    KEY `transition_lookup` (`type`, `from`),
-	KEY `batch` (`batch`),
-	KEY `objectId` (`objectId`)
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_auth_tokens`;

------------------------------------------------------------------------
r28078 | cdrwhite | 2010-07-20 12:21:01 -0400 (ter, 20 jul 2010) | 1 line

[NEW] Contributional  stats and track changes to a wiki page

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 28077)
+++ tiki.sql	(revision 28078)
@@ -2943,6 +2943,9 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_socialnetworks', 'user can use social network integration', 'registered', 'socialnetworks', NULL, 'feature_socialnetworks');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_socialnetworks', 'user can register this site with socialnetworks', 'admin', 'socialnetworks', 'y', 'feature_socialnetworks');
 
+
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_page-contribution_view', 'Can view contributions to a page', 'basic', 'wiki', NULL, 'feature_wiki');
+
 DROP TABLE IF EXISTS `users_usergroups`;
 CREATE TABLE `users_usergroups` (
   `userId` int(8) NOT NULL default '0',

------------------------------------------------------------------------
r28057 | marclaporte | 2010-07-18 11:05:53 -0400 (dom, 18 jul 2010) | 1 line

[KIL] removing a seemingly unused table. users_users is what your are looking for.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 28056)
+++ tiki.sql	(revision 28057)
@@ -2549,15 +2549,6 @@
   `voted` int(8) default NULL
 ) ENGINE=MyISAM;
 
-DROP TABLE IF EXISTS `tiki_users`;
-CREATE TABLE `tiki_users` (
-  `user` varchar(200) NOT NULL default '',
-  `password` varchar(40) default NULL,
-  `email` varchar(200) default NULL,
-  `lastLogin` int(14) default NULL,
-  PRIMARY KEY (`user`)
-) ENGINE=MyISAM;
-
 DROP TABLE IF EXISTS `tiki_webmail_contacts`;
 CREATE TABLE `tiki_webmail_contacts` (
   `contactId` int(12) NOT NULL auto_increment,

------------------------------------------------------------------------
r27986 | sylvieg | 2010-07-14 11:56:08 -0400 (qua, 14 jul 2010) | 1 line

[NEW]tracker: possibility to change the status of a tracker's items a certain time after creation or last modif: a cron job to run tiki-batch_transition must be set up

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 27985)
+++ tiki.sql	(revision 27986)
@@ -3529,11 +3529,15 @@
     `preserve` int(1) NOT NULL DEFAULT 0,
     `name` varchar(50),
     `type` varchar(20) NOT NULL,
+	`objectId` int(12) DEFAULT NULL,
     `from` varchar(255) NOT NULL,
     `to` varchar(255) NOT NULL,
     `guards` text,
+    `batch` char(1) DEFAULT NULL,
     PRIMARY KEY(`transitionId`),
-    KEY `transition_lookup` (`type`, `from`)
+    KEY `transition_lookup` (`type`, `from`),
+	KEY `batch` (`batch`),
+	KEY `objectId` (`objectId`)
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_auth_tokens`;

------------------------------------------------------------------------
r27823 | sylvieg | 2010-07-02 08:39:15 -0400 (sex, 02 jul 2010) | 1 line

[NEW]discount: library to manage discount in payment

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 27822)
+++ tiki.sql	(revision 27823)
@@ -3619,6 +3619,16 @@
     PRIMARY KEY(`paymentReceivedId`),
     KEY `payment_request_ix` (`paymentRequestId`)
 );
+DROP TABLE IF EXISTS `tiki_discount`;
+CREATE TABLE `tiki_discount`( 
+	`id` INT NOT NULL AUTO_INCREMENT,
+	`code` VARCHAR(255),
+	`value` VARCHAR(255),
+	`max` INT,
+	`comment` TEXT,
+	PRIMARY KEY(`id`),
+	KEY `code` (`code`)
+);
 DROP TABLE IF EXISTS `tiki_translations_in_progress`;
 CREATE TABLE IF NOT EXISTS `tiki_translations_in_progress` (
    `page_id` int(14) NOT NULL,

------------------------------------------------------------------------
r27808 | sampaioprimo | 2010-06-29 15:39:45 -0400 (ter, 29 jun 2010) | 2 lines

[KIL] feature_blog_comments


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 27807)
+++ tiki.sql	(revision 27808)
@@ -1427,7 +1427,6 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Content Templates','tiki-admin_content_templates.php',1256,'feature_wiki_templates','tiki_p_edit_content_templates','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Comments','tiki-list_comments.php',1260,'feature_wiki_comments','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Comments','tiki-list_comments.php',1260,'feature_article_comments','tiki_p_admin','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Comments','tiki-list_comments.php',1260,'feature_blog_comments','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Comments','tiki-list_comments.php',1260,'feature_file_galleries_comments','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Comments','tiki-list_comments.php',1260,'feature_image_galleries_comments','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Comments','tiki-list_comments.php',1260,'feature_poll_comments','tiki_p_admin','',0);
@@ -2879,12 +2878,12 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_broadcast_all', 'Can broadcast messages to all user', 'admin', 'messu', NULL, 'feature_messages');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_broadcast', 'Can broadcast messages to groups', 'admin', 'messu', NULL, 'feature_messages');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_messages', 'Can use the messaging system', 'registered', 'messu', NULL, 'feature_messages');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_comments', 'Can admin comments', 'admin', 'comments', 'y', 'feature_wiki_comments,feature_blog_comments,feature_blogposts_comments,feature_file_galleries_comments,feature_image_galleries_comments,feature_article_comments,feature_faq_comments,feature_poll_comments,map_comments');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_comments', 'Can edit all comments', 'editors', 'comments', NULL, 'feature_wiki_comments,feature_blog_comments,feature_blogposts_comments,feature_file_galleries_comments,feature_image_galleries_comments,feature_article_comments,feature_faq_comments,feature_poll_comments,map_comments');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_post_comments', 'Can post new comments', 'registered', 'comments', NULL, 'feature_wiki_comments,feature_blog_comments,feature_blogposts_comments,feature_file_galleries_comments,feature_image_galleries_comments,feature_article_comments,feature_faq_comments,feature_poll_comments,map_comments');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_read_comments', 'Can read comments', 'basic', 'comments', NULL, 'feature_wiki_comments,feature_blog_comments,feature_blogposts_comments,feature_file_galleries_comments,feature_image_galleries_comments,feature_article_comments,feature_faq_comments,feature_poll_comments,map_comments');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_remove_comments', 'Can delete comments', 'editors', 'comments', NULL, 'feature_wiki_comments,feature_blog_comments,feature_blogposts_comments,feature_file_galleries_comments,feature_image_galleries_comments,feature_article_comments,feature_faq_comments,feature_poll_comments,map_comments');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_vote_comments', 'Can vote comments', 'registered', 'comments', NULL, 'feature_wiki_comments,feature_blog_comments,feature_blogposts_comments,feature_file_galleries_comments,feature_image_galleries_comments,feature_article_comments,feature_faq_comments,feature_poll_comments,map_comments');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_comments', 'Can admin comments', 'admin', 'comments', 'y', 'feature_wiki_comments,feature_blogposts_comments,feature_file_galleries_comments,feature_image_galleries_comments,feature_article_comments,feature_faq_comments,feature_poll_comments,map_comments');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_comments', 'Can edit all comments', 'editors', 'comments', NULL, 'feature_wiki_comments,feature_blogposts_comments,feature_file_galleries_comments,feature_image_galleries_comments,feature_article_comments,feature_faq_comments,feature_poll_comments,map_comments');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_post_comments', 'Can post new comments', 'registered', 'comments', NULL, 'feature_wiki_comments,feature_blogposts_comments,feature_file_galleries_comments,feature_image_galleries_comments,feature_article_comments,feature_faq_comments,feature_poll_comments,map_comments');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_read_comments', 'Can read comments', 'basic', 'comments', NULL, 'feature_wiki_comments,feature_blogposts_comments,feature_file_galleries_comments,feature_image_galleries_comments,feature_article_comments,feature_faq_comments,feature_poll_comments,map_comments');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_remove_comments', 'Can delete comments', 'editors', 'comments', NULL, 'feature_wiki_comments,feature_blogposts_comments,feature_file_galleries_comments,feature_image_galleries_comments,feature_article_comments,feature_faq_comments,feature_poll_comments,map_comments');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_vote_comments', 'Can vote comments', 'registered', 'comments', NULL, 'feature_wiki_comments,feature_blogposts_comments,feature_file_galleries_comments,feature_image_galleries_comments,feature_article_comments,feature_faq_comments,feature_poll_comments,map_comments');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_content_templates', 'Can admin content templates', 'admin', 'content templates', 'y', 'feature_wiki_templates,feature_cms_templates');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_content_templates', 'Can edit content templates', 'editors', 'content templates', NULL, 'feature_wiki_templates,feature_cms_templates');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_use_content_templates', 'Can use content templates', 'registered', 'content templates', NULL, 'feature_wiki_templates,feature_cms_templates');

------------------------------------------------------------------------
r27802 | lphuberdeau | 2010-06-29 13:05:55 -0400 (ter, 29 jun 2010) | 1 line

[MRG] Automatic merge, branches/5.x 27724 to 27798

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 27801)
+++ tiki.sql	(revision 27802)
@@ -230,7 +230,8 @@
   `use_dates` char(1) default NULL,
   `created` int(14) default NULL,
   `message` text,
-  PRIMARY KEY (`banId`)
+  PRIMARY KEY (`banId`),
+  INDEX ban(`use_dates`, `date_from`, `date_to`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `tiki_banning_sections`;

------------------------------------------------------------------------
r27790 | sylvieg | 2010-06-28 16:38:30 -0400 (seg, 28 jun 2010) | 1 line

[ENH]payment: display also the suer who creates the payment

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 27789)
+++ tiki.sql	(revision 27790)
@@ -3603,6 +3603,7 @@
     `description` VARCHAR(100) NOT NULL,
     `actions` TEXT,
     `detail` TEXT,
+	`userId` int(8),
     PRIMARY KEY( `paymentRequestId` )
 );
 
@@ -3614,6 +3615,7 @@
     `amount` DECIMAL(7,2),
     `type` VARCHAR(15),
     `details` TEXT,
+	`userId` int(8),
     PRIMARY KEY(`paymentReceivedId`),
     KEY `payment_request_ix` (`paymentRequestId`)
 );

------------------------------------------------------------------------
r27737 | nkoth | 2010-06-22 01:55:57 -0400 (ter, 22 jun 2010) | 1 line

[ENH] Auto guess prefix alias links so that for example ((Project:Title of Project)) will can link to itemId with that title

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 27736)
+++ tiki.sql	(revision 27737)
@@ -3336,6 +3336,7 @@
 
 INSERT INTO tiki_semantic_tokens (token, label) VALUES('alias', 'Page Alias');
 INSERT INTO tiki_semantic_tokens (token, label) VALUES('prefixalias', 'Page Prefix Alias');
+INSERT INTO tiki_semantic_tokens (token, label) VALUES('titlefieldid', 'Field Id for Page Title'),('trackerid', 'Id of Embedded Tracker');
 
 
 DROP TABLE IF EXISTS `tiki_webservice`;

------------------------------------------------------------------------
r27735 | nkoth | 2010-06-22 00:22:16 -0400 (ter, 22 jun 2010) | 1 line

[NEW] Ability to redirect something like Project:15 to tiki-index.php?page=Project&itemId=15 where Project is a pretty tracker page, using semantic prefix alias link

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 27734)
+++ tiki.sql	(revision 27735)
@@ -3335,6 +3335,7 @@
 ) ENGINE=MyISAM ;
 
 INSERT INTO tiki_semantic_tokens (token, label) VALUES('alias', 'Page Alias');
+INSERT INTO tiki_semantic_tokens (token, label) VALUES('prefixalias', 'Page Prefix Alias');
 
 
 DROP TABLE IF EXISTS `tiki_webservice`;

------------------------------------------------------------------------
r27698 | sylvieg | 2010-06-18 10:52:27 -0400 (sex, 18 jun 2010) | 1 line

[ENH]calendar: 2 perms to be able to add yourself to the participants of an event and to add guest

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 27697)
+++ tiki.sql	(revision 27698)
@@ -2686,6 +2686,8 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_change_events', 'Can change events in the calendar', 'registered', 'calendar', NULL, 'feature_calendar');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_calendar', 'Can browse the calendar', 'basic', 'calendar', NULL, 'feature_calendar');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_events', 'Can view events details', 'registered', 'calendar', NULL, 'feature_calendar');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_calendar_add_my_particip', 'Can add own user to the participants', 'registered', 'calendar', NULL, 'feature_calendar');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_calendar_add_guest_particip', 'Can add guest to the participants', 'registered', 'calendar', NULL, 'feature_calendar');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_tiki_calendar', 'Can view Tikiwiki tools calendar', 'basic', 'calendar', NULL, 'feature_calendar');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_chat', 'Administrator, can create channels remove channels etc', 'editors', 'chat', 'y', 'feature_minichat,feature_live_support');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_chat', 'Can use the chat system', 'registered', 'chat', NULL, 'feature_minichat,feature_live_support');

------------------------------------------------------------------------
r27674 | nkoth | 2010-06-17 11:24:12 -0400 (qui, 17 jun 2010) | 1 line

[NEW] Sefurl rule for tiki-user_information.php

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 27673)
+++ tiki.sql	(revision 27674)
@@ -3445,6 +3445,7 @@
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-view_tracker_item.php\\?trackerId=(\\d+)\\&itemId=(\\d+)', 'item$2', 'trackeritem', 'feature_trackers', 200);
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-view_tracker_item.php\\?itemId=(\\d+)', 'item$1', 'trackeritem', 'feature_trackers', 200);
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-list_file_gallery.php\\?galleryId=(\\d+)', 'file$1', 'file gallery', 'feature_file_galleries', 200);
+INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-user_information.php\\?userId=(\\d+)','user$1', '', '', 200);
  
 UPDATE tiki_menu_options SET icon = 'icon-configuration48x48' WHERE name = 'Admin';
 UPDATE tiki_menu_options SET icon = 'xfce4-appfinder48x48' WHERE name = 'Search';

------------------------------------------------------------------------
r27600 | pkdille | 2010-06-11 14:37:32 -0400 (sex, 11 jun 2010) | 1 line

[FIX] external RSS: An url with more than 256 chars can happen

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 27599)
+++ tiki.sql	(revision 27600)
@@ -3626,7 +3626,7 @@
     `rssItemId` INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
     `rssId` INT NOT NULL,
     `guid` VARCHAR(255) NOT NULL,
-    `url` VARCHAR(255) NOT NULL,
+    `url` TEXT NOT NULL,
     `publication_date` INT UNSIGNED NOT NULL,
     `title` VARCHAR(255) NOT NULL,
     `author` VARCHAR(255),

------------------------------------------------------------------------
r27538 | jonnybradley | 2010-06-08 05:34:12 -0400 (ter, 08 jun 2010) | 1 line

[MRG] Automatic merge, branches/5.x 27492 to 27535

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 27537)
+++ tiki.sql	(revision 27538)
@@ -2903,7 +2903,7 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_plugin_viewdetail', 'Can view unapproved plugin details', 'registered', 'wiki', NULL, 'feature_wiki');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_plugin_preview', 'Can execute unapproved plugin', 'registered', 'wiki', NULL, 'feature_wiki');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_plugin_approve', 'Can approve plugin execution', 'editors', 'wiki', NULL, 'feature_wiki');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_trust_input', 'Trust all user inputs (no security checks)', 'admin', 'tiki', NULL, NULL);
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_trust_input', 'Trust all user inputs including plugins (no security checks)', 'admin', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_backlink', 'View page backlinks', 'basic', 'wiki', NULL, 'feature_wiki');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_notifications', 'Can admin mail notifications', 'editors', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_invite', 'Can invite user in groups', 'editors', 'tiki', NULL, NULL);

------------------------------------------------------------------------
r27310 | nkoth | 2010-05-25 11:13:12 -0400 (ter, 25 mai 2010) | 1 line

[ENH] New Jquery validation to receive message to be shown when validation fails

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 27309)
+++ tiki.sql	(revision 27310)
@@ -2194,6 +2194,7 @@
   `descriptionIsParsed` char(1) default 'n',
   `validation` varchar(255) default '',
   `validationParam` varchar(255) default '',
+  `validationMessage` varchar(255) default '',
   PRIMARY KEY (`fieldId`),
   INDEX `trackerId` (`trackerId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;

------------------------------------------------------------------------
r27305 | nkoth | 2010-05-24 22:33:09 -0400 (seg, 24 mai 2010) | 1 line

[NEW] AJAX Tracker entry validation using JQuery Validation plugin

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 27304)
+++ tiki.sql	(revision 27305)
@@ -2192,6 +2192,8 @@
   `visibleBy` text,
   `editableBy` text,
   `descriptionIsParsed` char(1) default 'n',
+  `validation` varchar(255) default '',
+  `validationParam` varchar(255) default '',
   PRIMARY KEY (`fieldId`),
   INDEX `trackerId` (`trackerId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;

------------------------------------------------------------------------
r27239 | sylvieg | 2010-05-19 07:51:17 -0400 (qua, 19 mai 2010) | 1 line

[NEW]tracker: action log for view item (only on TRACKER and tiki-view_tracker_item for now)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 27238)
+++ tiki.sql	(revision 27239)
@@ -3188,6 +3188,8 @@
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('feature', 'system', 'y');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Updated', 'trackeritem', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Created', 'trackeritem', 'n');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Viewed', 'trackeritem', 'n');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Viewed', 'trackeritem', 'n');
 
 DROP TABLE IF EXISTS `tiki_freetags`;
 CREATE TABLE `tiki_freetags` (

------------------------------------------------------------------------
r27131 | sylvieg | 2010-05-12 14:19:55 -0400 (qua, 12 mai 2010) | 1 line

[MRG] Automatic merge, branches/5.x 27081 to 27130

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 27130)
+++ tiki.sql	(revision 27131)
@@ -1286,7 +1286,8 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Last Changes','tiki-lastchanges.php',205,'feature_wiki,feature_lastChanges','tiki_p_view','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Dump','dump/new.tar',210,'feature_wiki,feature_dump','tiki_p_view','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Rankings','tiki-wiki_rankings.php',215,'feature_wiki,feature_wiki_rankings','tiki_p_view','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Pages','tiki-listpages.php',220,'feature_wiki,feature_listPages','tiki_p_view','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Pages','tiki-listpages.php',220,'feature_wiki,feature_listPages','tiki_p_view','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Create a Wiki Page','tiki-listpages.php?cookietab=2#tab2',222,'feature_wiki,feature_listPages','tiki_p_view,tiki_p_edit','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Orphan Pages','tiki-orphan_pages.php',225,'feature_wiki,feature_listorphanPages','tiki_p_view','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Sandbox','tiki-editpage.php?page=sandbox',230,'feature_wiki,feature_sandbox','tiki_p_view','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Multiple Print','tiki-print_pages.php',235,'feature_wiki,feature_wiki_multiprint','tiki_p_view','',0);
@@ -1484,8 +1485,8 @@
 CREATE TABLE `tiki_modules` (
   `moduleId` int(8) NOT NULL auto_increment,
   `name` varchar(200) NOT NULL default '',
-  `position` char(1) default NULL,
-  `ord` int(4) default NULL,
+  `position` char(1) NOT NULL DEFAULT '',
+  `ord` int(4) NOT NULL DEFAULT '0',
   `type` char(1) default NULL,
   `title` varchar(255) default NULL,
   `cache_time` int(14) default NULL,
@@ -2406,7 +2407,7 @@
   PRIMARY KEY (`name`)
 ) ENGINE=MyISAM;
 
-INSERT INTO tiki_user_modules (name, title, data, parse) VALUES ('Application Menu', 'Menu', '{menu id=42}', 'n');
+INSERT INTO tiki_user_modules (name, title, data, parse) VALUES ('Application Menu', 'Menu', '{menu id=42 css=y type=vert}', 'n');
 
 DROP TABLE IF EXISTS `tiki_user_notes`;
 CREATE TABLE `tiki_user_notes` (

------------------------------------------------------------------------
r27056 | cdrwhite | 2010-05-10 10:49:28 -0400 (seg, 10 mai 2010) | 2 lines

Social networks integration (twitter) for shoutbox


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 27055)
+++ tiki.sql	(revision 27056)
@@ -1431,13 +1431,13 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Comments','tiki-list_comments.php',1260,'feature_poll_comments','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Comments','tiki-list_comments.php',1260,'feature_faq_comments','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Contribution','tiki-admin_contribution.php',1265,'feature_contribution','tiki_p_admin_contribution','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 's', 'Kaltura Video', 'tiki-list_kaltura_entries.php', 950, 'feature_kaltura', 'tiki_p_admin | tiki_p_admin_kaltura | tiki_p_list_videos', '', 0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'o', 'List Entries', 'tiki-list_kaltura_entries.php', 952, 'feature_kaltura', 'tiki_p_admin | tiki_p_admin_kaltura | tiki_p_list_videos', '', 0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'o', 'Upload Media', 'tiki-kaltura_upload.php', 954, 'feature_kaltura', 'tiki_p_admin | tiki_p_admin_kaltura | tiki_p_upload_videos', '', 0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s', 'Kaltura Video', 'tiki-list_kaltura_entries.php', 950, 'feature_kaltura', 'tiki_p_admin | tiki_p_admin_kaltura | tiki_p_list_videos', '', 0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o', 'List Entries', 'tiki-list_kaltura_entries.php', 952, 'feature_kaltura', 'tiki_p_admin | tiki_p_admin_kaltura | tiki_p_list_videos', '', 0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o', 'Upload Media', 'tiki-kaltura_upload.php', 954, 'feature_kaltura', 'tiki_p_admin | tiki_p_admin_kaltura | tiki_p_upload_videos', '', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Permissions','tiki-objectpermissions.php',1077,'','tiki_p_admin|tiki_p_admin_objects','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Social networks','tiki-socialnetworks.php',115,'feature_mytiki,feature_socialnetworks','tiki_p_socialnetworks|tiki_p_admin_socialnetworks','Registered',0);
 
 
-
 DROP TABLE IF EXISTS `tiki_menus`;
 CREATE TABLE `tiki_menus` (
   `menuId` int(8) NOT NULL auto_increment,
@@ -1999,6 +1999,7 @@
   `timestamp` int(14) default NULL,
   `user` varchar(200) NULL default '',
   `hash` varchar(32) default NULL,
+  `tweetId` bigint(20) unsigned NOT NULL,
   PRIMARY KEY (`msgId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
@@ -2942,6 +2943,8 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_bigbluebutton_moderate', 'Can moderate a meeting', 'admin', 'bigbluebutton', NULL, 'bigbluebutton_feature');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_bigbluebutton_create', 'Can create a meeting', 'admin', 'bigbluebutton', NULL, 'bigbluebutton_feature');
 
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_socialnetworks', 'user can use social network integration', 'registered', 'socialnetworks', NULL, 'feature_socialnetworks');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_socialnetworks', 'user can register this site with socialnetworks', 'admin', 'socialnetworks', 'y', 'feature_socialnetworks');
 
 DROP TABLE IF EXISTS `users_usergroups`;
 CREATE TABLE `users_usergroups` (

------------------------------------------------------------------------
r26935 | nkoth | 2010-05-06 10:19:30 -0400 (qui, 06 mai 2010) | 1 line

[FIX] text field cannot have default in some operating systems

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 26934)
+++ tiki.sql	(revision 26935)
@@ -84,7 +84,7 @@
   `ip` varchar(39) default NULL,
   `comment` varchar(200) default NULL,
   `categId` int(12) NOT NULL default '0',
-	`client` VARCHAR( 200 ) NULL DEFAULT NULL,
+    `client` VARCHAR( 200 ) NULL DEFAULT NULL,
   PRIMARY KEY (`actionId`),
   KEY `lastModif` (`lastModif`),
   KEY `object` (`object`(100), `objectType`, `action`(100))
@@ -373,8 +373,8 @@
   KEY `calendarId` (`calendarId`),
   FULLTEXT KEY `ft` (`name`,`description`),
   CONSTRAINT `fk_calitems_recurrence`
-	FOREIGN KEY (`recurrenceId`) REFERENCES `tiki_calendar_recurrence`(`recurrenceId`)
-	ON UPDATE CASCADE ON DELETE SET NULL
+    FOREIGN KEY (`recurrenceId`) REFERENCES `tiki_calendar_recurrence`(`recurrenceId`)
+    ON UPDATE CASCADE ON DELETE SET NULL
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `tiki_calendar_locations`;
@@ -416,10 +416,10 @@
 
 DROP TABLE IF EXISTS `tiki_calendar_options`;
 CREATE TABLE `tiki_calendar_options` (
-	`calendarId` int(14) NOT NULL default 0,
-	`optionName` varchar(120) NOT NULL default '',
-	`value` varchar(255),
-	PRIMARY KEY (`calendarId`,`optionName`)
+    `calendarId` int(14) NOT NULL default 0,
+    `optionName` varchar(120) NOT NULL default '',
+    `value` varchar(255),
+    PRIMARY KEY (`calendarId`,`optionName`)
 ) ENGINE=MyISAM ;
 
 DROP TABLE IF EXISTS `tiki_categories`;
@@ -1528,11 +1528,11 @@
 
 DROP TABLE IF EXISTS `tiki_newsletter_pages`;
 CREATE TABLE `tiki_newsletter_pages` (
-	`nlId` INT( 12 ) NOT NULL ,
-	`wikiPageName` VARCHAR( 160 ) NOT NULL ,
-	`validateAddrs` CHAR( 1 ) NOT NULL DEFAULT 'n',
-	`addToList` CHAR( 1 ) NOT NULL DEFAULT 'n',
-	PRIMARY KEY ( `nlId` , `wikiPageName` )
+    `nlId` INT( 12 ) NOT NULL ,
+    `wikiPageName` VARCHAR( 160 ) NOT NULL ,
+    `validateAddrs` CHAR( 1 ) NOT NULL DEFAULT 'n',
+    `addToList` CHAR( 1 ) NOT NULL DEFAULT 'n',
+    PRIMARY KEY ( `nlId` , `wikiPageName` )
 ) ENGINE = MYISAM ;
 
 DROP TABLE IF EXISTS `tiki_newsletters`;
@@ -1553,7 +1553,7 @@
   `author` varchar(200) default NULL,
   `allowArticleClip` char(1) default 'y',
   `autoArticleClip` char(1) default 'n',
-  `articleClipTypes` text  default '',
+  `articleClipTypes` text,
   `articleClipRange` int(14) default NULL,
   PRIMARY KEY (`nlId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
@@ -2355,10 +2355,10 @@
 
 DROP TABLE IF EXISTS `tiki_user_login_cookies`;
 CREATE TABLE `tiki_user_login_cookies` (
-	`userId` INT NOT NULL,
-	`secret` CHAR(64) NOT NULL,
-	`expiration` TIMESTAMP NOT NULL,
-	PRIMARY KEY (`userId`, `secret`)
+    `userId` INT NOT NULL,
+    `secret` CHAR(64) NOT NULL,
+    `expiration` TIMESTAMP NOT NULL,
+    PRIMARY KEY (`userId`, `secret`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `tiki_user_mail_accounts`;
@@ -2375,8 +2375,8 @@
   `smtp` varchar(255) default NULL,
   `useAuth` char(1) default NULL,
   `smtpPort` int(4) default NULL,
-  `flagsPublic` char(1) default 'n',				-- COMMENT 'MatWho - Shared Group Mail box if y',
-  `autoRefresh` int(4) NOT NULL default 0,		-- COMMENT 'seconds for mail list to refresh, 0 = none',
+  `flagsPublic` char(1) default 'n',                -- COMMENT 'MatWho - Shared Group Mail box if y',
+  `autoRefresh` int(4) NOT NULL default 0,        -- COMMENT 'seconds for mail list to refresh, 0 = none',
   `imap` varchar( 255 ) default NULL,
   `mbox` varchar( 255 ) default NULL,
   `maildir` varchar( 255 ) default NULL,
@@ -3511,97 +3511,97 @@
 
 DROP TABLE IF EXISTS `tiki_transitions`;
 CREATE TABLE `tiki_transitions` (
-	`transitionId` int NOT NULL AUTO_INCREMENT,
-	`preserve` int(1) NOT NULL DEFAULT 0,
-	`name` varchar(50),
-	`type` varchar(20) NOT NULL,
-	`from` varchar(255) NOT NULL,
-	`to` varchar(255) NOT NULL,
-	`guards` text,
-	PRIMARY KEY(`transitionId`),
-	KEY `transition_lookup` (`type`, `from`)
+    `transitionId` int NOT NULL AUTO_INCREMENT,
+    `preserve` int(1) NOT NULL DEFAULT 0,
+    `name` varchar(50),
+    `type` varchar(20) NOT NULL,
+    `from` varchar(255) NOT NULL,
+    `to` varchar(255) NOT NULL,
+    `guards` text,
+    PRIMARY KEY(`transitionId`),
+    KEY `transition_lookup` (`type`, `from`)
 ) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_auth_tokens`;
 CREATE TABLE `tiki_auth_tokens` (
-	`tokenId` INT NOT NULL AUTO_INCREMENT,
-	`creation` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
-	`timeout` INT NOT NULL DEFAULT 0,
-	`hits` INT NOT NULL DEFAULT 1,
-	`token` CHAR(32),
-	`entry` VARCHAR(50),
-	`parameters` VARCHAR(255),
-	`groups` VARCHAR(255),
-	PRIMARY KEY( `tokenId` ),
-	KEY `tiki_auth_tokens_token` (`token`)
+    `tokenId` INT NOT NULL AUTO_INCREMENT,
+    `creation` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    `timeout` INT NOT NULL DEFAULT 0,
+    `hits` INT NOT NULL DEFAULT 1,
+    `token` CHAR(32),
+    `entry` VARCHAR(50),
+    `parameters` VARCHAR(255),
+    `groups` VARCHAR(255),
+    PRIMARY KEY( `tokenId` ),
+    KEY `tiki_auth_tokens_token` (`token`)
 );
 
 DROP TABLE IF EXISTS `metrics_assigned`;
 CREATE TABLE `metrics_assigned` (
-	`assigned_id` int(11) NOT NULL AUTO_INCREMENT,
-	`metric_id` int(11) NOT NULL,
-	`tab_id` int(11) NOT NULL,
-	PRIMARY KEY (`assigned_id`),
-	KEY `metric_id` (`metric_id`),
-	KEY `tab_id` (`tab_id`)
+    `assigned_id` int(11) NOT NULL AUTO_INCREMENT,
+    `metric_id` int(11) NOT NULL,
+    `tab_id` int(11) NOT NULL,
+    PRIMARY KEY (`assigned_id`),
+    KEY `metric_id` (`metric_id`),
+    KEY `tab_id` (`tab_id`)
 );
 
 DROP TABLE IF EXISTS `metrics_metric`;
 CREATE TABLE `metrics_metric` (
-	`metric_id` int(11) NOT NULL AUTO_INCREMENT,
-	`metric_name` varchar(255) NOT NULL,
-	`metric_range` varchar(1) NOT NULL DEFAULT '+' COMMENT 'values: + (daily), @ (monthly&weekly), - (weekly)',
-	`metric_datatype` varchar(1) NOT NULL DEFAULT 'i' COMMENT 'values: i(nteger), %(percentage), f(loat), L(ist)',
-	`metric_lastupdate` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
-	`metric_query` text,
-	`metric_dsn` VARCHAR(200) NOT NULL DEFAULT 'local',
-	PRIMARY KEY (`metric_id`),
-	UNIQUE KEY `metric_name` (`metric_name`)
+    `metric_id` int(11) NOT NULL AUTO_INCREMENT,
+    `metric_name` varchar(255) NOT NULL,
+    `metric_range` varchar(1) NOT NULL DEFAULT '+' COMMENT 'values: + (daily), @ (monthly&weekly), - (weekly)',
+    `metric_datatype` varchar(1) NOT NULL DEFAULT 'i' COMMENT 'values: i(nteger), %(percentage), f(loat), L(ist)',
+    `metric_lastupdate` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    `metric_query` text,
+    `metric_dsn` VARCHAR(200) NOT NULL DEFAULT 'local',
+    PRIMARY KEY (`metric_id`),
+    UNIQUE KEY `metric_name` (`metric_name`)
 );
 
 DROP TABLE IF EXISTS `metrics_tab`;
 CREATE TABLE `metrics_tab` (
-	`tab_id` int(11) NOT NULL AUTO_INCREMENT,
-	`tab_name` varchar(255) NOT NULL,
-	`tab_order` int(11) NOT NULL DEFAULT '0',
-	`tab_content` longtext NOT NULL,
-	PRIMARY KEY (`tab_id`),
-	UNIQUE KEY `tab_name` (`tab_name`)
+    `tab_id` int(11) NOT NULL AUTO_INCREMENT,
+    `tab_name` varchar(255) NOT NULL,
+    `tab_order` int(11) NOT NULL DEFAULT '0',
+    `tab_content` longtext NOT NULL,
+    PRIMARY KEY (`tab_id`),
+    UNIQUE KEY `tab_name` (`tab_name`)
 );
 
 DROP TABLE IF EXISTS `tiki_file_backlinks`;
 CREATE TABLE `tiki_file_backlinks` (
-	   `fileId` int(14) NOT NULL,
-	   `objectId` int(12) NOT NULL,
-	   KEY `objectId` (`objectId`),
-	   KEY `fileId` (`fileId`)
+       `fileId` int(14) NOT NULL,
+       `objectId` int(12) NOT NULL,
+       KEY `objectId` (`objectId`),
+       KEY `fileId` (`fileId`)
 );
 
 DROP TABLE IF EXISTS `tiki_payment_requests`;
 CREATE TABLE `tiki_payment_requests` (
-	`paymentRequestId` INT NOT NULL AUTO_INCREMENT,
-	`amount` DECIMAL(7,2) NOT NULL,
-	`amount_paid` DECIMAL(7,2) NOT NULL DEFAULT 0.0,
-	`currency` CHAR(3) NOT NULL,
-	`request_date` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
-	`due_date` TIMESTAMP NOT NULL,
-	`cancel_date` TIMESTAMP NULL,
-	`description` VARCHAR(100) NOT NULL,
-	`actions` TEXT,
-	`detail` TEXT,
-	PRIMARY KEY( `paymentRequestId` )
+    `paymentRequestId` INT NOT NULL AUTO_INCREMENT,
+    `amount` DECIMAL(7,2) NOT NULL,
+    `amount_paid` DECIMAL(7,2) NOT NULL DEFAULT 0.0,
+    `currency` CHAR(3) NOT NULL,
+    `request_date` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    `due_date` TIMESTAMP NOT NULL,
+    `cancel_date` TIMESTAMP NULL,
+    `description` VARCHAR(100) NOT NULL,
+    `actions` TEXT,
+    `detail` TEXT,
+    PRIMARY KEY( `paymentRequestId` )
 );
 
 DROP TABLE IF EXISTS `tiki_payment_received`;
 CREATE TABLE `tiki_payment_received` (
-	`paymentReceivedId` INT NOT NULL AUTO_INCREMENT,
-	`paymentRequestId` INT NOT NULL,
-	`payment_date` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
-	`amount` DECIMAL(7,2),
-	`type` VARCHAR(15),
-	`details` TEXT,
-	PRIMARY KEY(`paymentReceivedId`),
-	KEY `payment_request_ix` (`paymentRequestId`)
+    `paymentReceivedId` INT NOT NULL AUTO_INCREMENT,
+    `paymentRequestId` INT NOT NULL,
+    `payment_date` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
+    `amount` DECIMAL(7,2),
+    `type` VARCHAR(15),
+    `details` TEXT,
+    PRIMARY KEY(`paymentReceivedId`),
+    KEY `payment_request_ix` (`paymentRequestId`)
 );
 DROP TABLE IF EXISTS `tiki_translations_in_progress`;
 CREATE TABLE IF NOT EXISTS `tiki_translations_in_progress` (
@@ -3614,58 +3614,58 @@
 
 DROP TABLE IF EXISTS `tiki_rss_items`;
 CREATE TABLE `tiki_rss_items` (
-	`rssItemId` INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
-	`rssId` INT NOT NULL,
-	`guid` VARCHAR(255) NOT NULL,
-	`url` VARCHAR(255) NOT NULL,
-	`publication_date` INT UNSIGNED NOT NULL,
-	`title` VARCHAR(255) NOT NULL,
-	`author` VARCHAR(255),
-	`description` TEXT,
-	`content` TEXT,
-	KEY `tiki_rss_items_rss` (`rssId`),
-	UNIQUE `tiki_rss_items_item` (`rssId`, `guid`)
+    `rssItemId` INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
+    `rssId` INT NOT NULL,
+    `guid` VARCHAR(255) NOT NULL,
+    `url` VARCHAR(255) NOT NULL,
+    `publication_date` INT UNSIGNED NOT NULL,
+    `title` VARCHAR(255) NOT NULL,
+    `author` VARCHAR(255),
+    `description` TEXT,
+    `content` TEXT,
+    KEY `tiki_rss_items_rss` (`rssId`),
+    UNIQUE `tiki_rss_items_item` (`rssId`, `guid`)
 );
 
 DROP TABLE IF EXISTS `tiki_object_attributes`;
 CREATE TABLE `tiki_object_attributes` (
-	`attributeId` INT PRIMARY KEY AUTO_INCREMENT,
-	`type` varchar(50) NOT NULL,
-	`itemId` varchar(255) NOT NULL,
-	`attribute` varchar(25) NOT NULL,
-	`value` varchar(100),
-	UNIQUE `item_attribute_uq` ( `type`, `itemId`, `attribute` ),
-	KEY `attribute_lookup_ix` (`attribute`, `value`)
+    `attributeId` INT PRIMARY KEY AUTO_INCREMENT,
+    `type` varchar(50) NOT NULL,
+    `itemId` varchar(255) NOT NULL,
+    `attribute` varchar(25) NOT NULL,
+    `value` varchar(100),
+    UNIQUE `item_attribute_uq` ( `type`, `itemId`, `attribute` ),
+    KEY `attribute_lookup_ix` (`attribute`, `value`)
 );
 
 DROP TABLE IF EXISTS `tiki_rating_configs`;
 CREATE TABLE `tiki_rating_configs` (
-	`ratingConfigId` INT PRIMARY KEY AUTO_INCREMENT,
-	`name` VARCHAR(50) NOT NULL,
-	`expiry` INT NOT NULL DEFAULT 3600,
-	`formula` TEXT NOT NULL,
-	`callbacks` TEXT
+    `ratingConfigId` INT PRIMARY KEY AUTO_INCREMENT,
+    `name` VARCHAR(50) NOT NULL,
+    `expiry` INT NOT NULL DEFAULT 3600,
+    `formula` TEXT NOT NULL,
+    `callbacks` TEXT
 );
 
 DROP TABLE IF EXISTS `tiki_rating_obtained`;
 CREATE TABLE `tiki_rating_obtained` (
-	`ratingId` INT PRIMARY KEY AUTO_INCREMENT,
-	`ratingConfigId` INT NOT NULL,
-	`type` VARCHAR(50) NOT NULL,
-	`object` INT NOT NULL,
-	`expire` INT NOT NULL,
-	`value` FLOAT NOT NULL,
-	UNIQUE `tiki_obtained_rating_uq` (`type`, `object`, `ratingConfigId`)
+    `ratingId` INT PRIMARY KEY AUTO_INCREMENT,
+    `ratingConfigId` INT NOT NULL,
+    `type` VARCHAR(50) NOT NULL,
+    `object` INT NOT NULL,
+    `expire` INT NOT NULL,
+    `value` FLOAT NOT NULL,
+    UNIQUE `tiki_obtained_rating_uq` (`type`, `object`, `ratingConfigId`)
 );
 
 DROP TABLE IF EXISTS `tiki_object_relations`;
 CREATE TABLE `tiki_object_relations` (
-	`relationId` INT PRIMARY KEY AUTO_INCREMENT,
-	`relation` varchar(25) NOT NULL,
-	`source_type` varchar(50) NOT NULL,
-	`source_itemId` varchar(255) NOT NULL,
-	`target_type` varchar(50) NOT NULL,
-	`target_itemId` varchar(255) NOT NULL,
-	KEY `relation_source_ix` (`source_type`, `source_itemId`),
-	KEY `relation_target_ix` (`target_type`, `target_itemId`)
+    `relationId` INT PRIMARY KEY AUTO_INCREMENT,
+    `relation` varchar(25) NOT NULL,
+    `source_type` varchar(50) NOT NULL,
+    `source_itemId` varchar(255) NOT NULL,
+    `target_type` varchar(50) NOT NULL,
+    `target_itemId` varchar(255) NOT NULL,
+    KEY `relation_source_ix` (`source_type`, `source_itemId`),
+    KEY `relation_target_ix` (`target_type`, `target_itemId`)
 );

------------------------------------------------------------------------
r26856 | jonnybradley | 2010-05-01 16:55:08 -0400 (sÃ¡b, 01 mai 2010) | 3 lines

[ENH] Newsletter pages: Use wiki pages as subscription lists either to update subscriptions, or at send time.
Allows use of tracker data (via pretty tracker templates), or any other way of making a wiki page.
Some control of subscription/cancellation - needs refining (& testing!)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 26855)
+++ tiki.sql	(revision 26856)
@@ -1526,6 +1526,15 @@
   PRIMARY KEY (`nlId`,`includedId`)
 ) ENGINE=MyISAM;
 
+DROP TABLE IF EXISTS `tiki_newsletter_pages`;
+CREATE TABLE `tiki_newsletter_pages` (
+	`nlId` INT( 12 ) NOT NULL ,
+	`wikiPageName` VARCHAR( 160 ) NOT NULL ,
+	`validateAddrs` CHAR( 1 ) NOT NULL DEFAULT 'n',
+	`addToList` CHAR( 1 ) NOT NULL DEFAULT 'n',
+	PRIMARY KEY ( `nlId` , `wikiPageName` )
+) ENGINE = MYISAM ;
+
 DROP TABLE IF EXISTS `tiki_newsletters`;
 CREATE TABLE `tiki_newsletters` (
   `nlId` int(12) NOT NULL auto_increment,

------------------------------------------------------------------------
r26745 | sylvieg | 2010-04-23 00:38:37 -0400 (sex, 23 abr 2010) | 1 line

[NEW]tracker: log tracker modification (todo: attach, img + display hisory)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 26744)
+++ tiki.sql	(revision 26745)
@@ -2228,6 +2228,18 @@
   FULLTEXT KEY `ft` (value)
 ) ENGINE=MyISAM;
 
+DROP TABLE IF EXISTS `tiki_tracker_item_field_logs`;
+CREATE TABLE `tiki_tracker_item_field_logs` (
+  `version` int(12) NOT NULL,
+  `itemId` int(12) NOT NULL default '0',
+  `fieldId` int(12) NOT NULL default '0',
+  `value` text,
+  `lang` char(16) default NULL,
+  INDEX `version` (`version`),
+  INDEX `itemId` (`itemId`),
+  INDEX `fieldId` (`itemId`)
+) ENGINE=MyISAM;
+
 DROP TABLE IF EXISTS `tiki_tracker_items`;
 CREATE TABLE `tiki_tracker_items` (
   `itemId` int(12) NOT NULL auto_increment,
@@ -3161,6 +3173,8 @@
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Viewed', 'article', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('%', 'system', 'y');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('feature', 'system', 'y');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Updated', 'trackeritem', 'n');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Created', 'trackeritem', 'n');
 
 DROP TABLE IF EXISTS `tiki_freetags`;
 CREATE TABLE `tiki_freetags` (

------------------------------------------------------------------------
r26709 | jonnybradley | 2010-04-20 12:50:48 -0400 (ter, 20 abr 2010) | 1 line

[MRG] Automatic merge, branches/5.x 26666 to 26706

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 26708)
+++ tiki.sql	(revision 26709)
@@ -1492,9 +1492,9 @@
   `rows` int(4) default NULL,
   `params` text,
   `groups` text,
-  PRIMARY KEY (`name`(100), `position`, `ord`, `params`(140)),
+  PRIMARY KEY (`moduleId`),
   KEY `positionType` (position, type),
-  KEY `moduleId` (`moduleId`)
+  KEY `namePosOrdParam` (`name`(100), `position`, `ord`, `params`(140))
 ) ENGINE=MyISAM;
 
 INSERT INTO tiki_modules (name,position,ord,cache_time,params,groups) VALUES ('Application Menu','l',30,0,'flip=y','a:1:{i:0;s:10:"Registered";}');
@@ -2917,6 +2917,9 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_request', 'Can request a payment', 'admin', 'payment', NULL, 'payment_feature');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES ('tiki_p_admin_modules', 'User can Administer Modules', 'registered', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_tracker_dump', 'Can save a CSV backup of entire trackers', 'admin', 'trackers', NULL, 'feature_trackers');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_bigbluebutton_join', 'Can join a meeting', 'basic', 'bigbluebutton', NULL, 'bigbluebutton_feature');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_bigbluebutton_moderate', 'Can moderate a meeting', 'admin', 'bigbluebutton', NULL, 'bigbluebutton_feature');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_bigbluebutton_create', 'Can create a meeting', 'admin', 'bigbluebutton', NULL, 'bigbluebutton_feature');
 
 
 DROP TABLE IF EXISTS `users_usergroups`;

------------------------------------------------------------------------
r26661 | sylvieg | 2010-04-16 15:12:50 -0400 (sex, 16 abr 2010) | 1 line

[MRG] Automatic merge, branches/5.x 26623 to 26659

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 26660)
+++ tiki.sql	(revision 26661)
@@ -3132,7 +3132,7 @@
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Uploaded', 'file gallery', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Uploaded', 'image gallery', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('%', 'category', 'n');
-INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('login', 'system', 'n');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('login', 'system', 'y');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Posted', 'message', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Replied', 'message', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Viewed', 'message', 'n');
@@ -3156,7 +3156,8 @@
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Removed', 'blog', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Removed', 'file', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Viewed', 'article', 'n');
-INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('%', 'system', 'n');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('%', 'system', 'y');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('feature', 'system', 'y');
 
 DROP TABLE IF EXISTS `tiki_freetags`;
 CREATE TABLE `tiki_freetags` (

------------------------------------------------------------------------
r26602 | jonnybradley | 2010-04-13 08:05:22 -0400 (ter, 13 abr 2010) | 1 line

[MRG] Automatic merge, branches/5.x 26526 to 26600

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 26601)
+++ tiki.sql	(revision 26602)
@@ -739,10 +739,10 @@
   `quota` int(8) default 0,
   `size` int(14) default NULL,
   `wiki_syntax` varchar(200) default NULL,
+  `backlinkPerms` char(1) default 'n',
+  `show_backlinks` char(1) default NULL,
   `image_max_size_x` int(8) NOT NULL default '0',
   `image_max_size_y` int(8) NOT NULL default '0',
-  `backlinkPerms` char(1) default 'n',
-  `show_backlinks` char(1) default NULL,
   PRIMARY KEY (`galleryId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
@@ -1490,7 +1490,7 @@
   `title` varchar(255) default NULL,
   `cache_time` int(14) default NULL,
   `rows` int(4) default NULL,
-  `params` varchar(255) default NULL,
+  `params` text,
   `groups` text,
   PRIMARY KEY (`name`(100), `position`, `ord`, `params`(140)),
   KEY `positionType` (position, type),

------------------------------------------------------------------------
r26290 | nkoth | 2010-03-24 13:54:21 -0400 (qua, 24 mar 2010) | 1 line

[NEW] Clip from articles into newsletter capability (part 1, part 2 coming later today)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 26289)
+++ tiki.sql	(revision 26290)
@@ -1542,6 +1542,10 @@
   `frequency` int(14) default NULL,
   `allowTxt` char(1) default 'y',
   `author` varchar(200) default NULL,
+  `allowArticleClip` char(1) default 'y',
+  `autoArticleClip` char(1) default 'n',
+  `articleClipTypes` text  default '',
+  `articleClipRange` int(14) default NULL,
   PRIMARY KEY (`nlId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 

------------------------------------------------------------------------
r26196 | sylvieg | 2010-03-18 10:08:55 -0400 (qui, 18 mar 2010) | 1 line

[MRG] Automatic merge, branches/5.x 26159 to 26195

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 26195)
+++ tiki.sql	(revision 26196)
@@ -739,6 +739,8 @@
   `quota` int(8) default 0,
   `size` int(14) default NULL,
   `wiki_syntax` varchar(200) default NULL,
+  `image_max_size_x` int(8) NOT NULL default '0',
+  `image_max_size_y` int(8) NOT NULL default '0',
   `backlinkPerms` char(1) default 'n',
   `show_backlinks` char(1) default NULL,
   PRIMARY KEY (`galleryId`)

------------------------------------------------------------------------
r26088 | sylvieg | 2010-03-12 15:44:30 -0400 (sex, 12 mar 2010) | 1 line

[NEW]group: option to put automatically at registration or by batch user in a group depending a pattern on their email

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 26087)
+++ tiki.sql	(revision 26088)
@@ -2622,6 +2622,7 @@
   `groupTheme` varchar(255) default '',
   `isExternal` char(1) default 'n',
   `expireAfter` int(14) default 0,
+  `emailPattern`  varchar(255) default '',
   PRIMARY KEY (`id`),
   UNIQUE KEY `groupName` (`groupName`),
   KEY `expireAfter` (`expireAfter`)

------------------------------------------------------------------------
r26020 | jonnybradley | 2010-03-09 12:08:39 -0400 (ter, 09 mar 2010) | 1 line

[ENH] Add parentSheetId to tiki_sheets table - plus admin interface (multi-sheet implementation to come soon)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 26019)
+++ tiki.sql	(revision 26020)
@@ -1973,6 +1973,7 @@
   `title` varchar(200) NOT NULL default '',
   `description` text,
   `author` varchar(200) NOT NULL default '',
+  `parentSheetId` int(8) NULL,
   PRIMARY KEY (`sheetId`)
 ) ENGINE=MyISAM;
 

------------------------------------------------------------------------
r26015 | sylvieg | 2010-03-09 10:14:00 -0400 (ter, 09 mar 2010) | 1 line

[NEW]fgal: option a user can give a duration after a file can be deleted

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 26014)
+++ tiki.sql	(revision 26015)
@@ -774,6 +774,7 @@
   `lockedby` varchar(200) default '',
   `comment` varchar(200) default NULL,
   `archiveId` int(14) default 0,
+  `deleteAfter` int(14) default NULL,
   PRIMARY KEY (`fileId`),
   KEY `name` (name),
   KEY `description` (description(255)),

------------------------------------------------------------------------
r25759 | jonnybradley | 2010-02-26 20:07:39 -0400 (sex, 26 fev 2010) | 1 line

[FIX] feature check for 'Content Templates' menu item

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 25758)
+++ tiki.sql	(revision 25759)
@@ -1419,7 +1419,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Action Log','tiki-admin_actionlog.php',1255,'feature_actionlog','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Action Log','tiki-admin_actionlog.php',1255,'feature_actionlog','tiki_p_view_actionlog','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Action Log','tiki-admin_actionlog.php',1255,'feature_actionlog','tiki_p_view_actionlog_owngroups','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Content Templates','tiki-admin_content_templates.php',1256,'','tiki_p_edit_content_templates','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Content Templates','tiki-admin_content_templates.php',1256,'feature_wiki_templates','tiki_p_edit_content_templates','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Comments','tiki-list_comments.php',1260,'feature_wiki_comments','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Comments','tiki-list_comments.php',1260,'feature_article_comments','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Comments','tiki-list_comments.php',1260,'feature_blog_comments','tiki_p_admin','',0);

------------------------------------------------------------------------
r25749 | jonnybradley | 2010-02-26 14:34:09 -0400 (sex, 26 fev 2010) | 3 lines

[NEW] Tracker dump. Allows an entire tracker to be exported as CSV. Overrides existing permissions so has it's own new perm, and saves raw values only (so far).
Tested with up to 15,000 items with 20 fields each.
Faster with more memory assigned but tested successfully down to around 45M.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 25748)
+++ tiki.sql	(revision 25749)
@@ -2906,7 +2906,8 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_view', 'Can view payment requests and details', 'admin', 'payment', NULL, 'payment_feature');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_manual', 'Can enter manual payments', 'admin', 'payment', NULL, 'payment_feature');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_request', 'Can request a payment', 'admin', 'payment', NULL, 'payment_feature');
-INSERT INTO users_permissions (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES ('tiki_p_admin_modules', 'User can Administer Modules', 'registered', 'tiki', NULL, NULL);
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES ('tiki_p_admin_modules', 'User can Administer Modules', 'registered', 'tiki', NULL, NULL);
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_tracker_dump', 'Can save a CSV backup of entire trackers', 'admin', 'trackers', NULL, 'feature_trackers');
 
 
 DROP TABLE IF EXISTS `users_usergroups`;

------------------------------------------------------------------------
r25671 | lphuberdeau | 2010-02-24 12:03:21 -0400 (qua, 24 fev 2010) | 1 line

[MOD] Generic object relations

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 25670)
+++ tiki.sql	(revision 25671)
@@ -3620,3 +3620,15 @@
 	`value` FLOAT NOT NULL,
 	UNIQUE `tiki_obtained_rating_uq` (`type`, `object`, `ratingConfigId`)
 );
+
+DROP TABLE IF EXISTS `tiki_object_relations`;
+CREATE TABLE `tiki_object_relations` (
+	`relationId` INT PRIMARY KEY AUTO_INCREMENT,
+	`relation` varchar(25) NOT NULL,
+	`source_type` varchar(50) NOT NULL,
+	`source_itemId` varchar(255) NOT NULL,
+	`target_type` varchar(50) NOT NULL,
+	`target_itemId` varchar(255) NOT NULL,
+	KEY `relation_source_ix` (`source_type`, `source_itemId`),
+	KEY `relation_target_ix` (`target_type`, `target_itemId`)
+);

------------------------------------------------------------------------
r25570 | pascalstjean | 2010-02-23 17:47:22 -0400 (ter, 23 fev 2010) | 1 line

[NEW] - Added 'always_owner' column to tiki_blogs database table

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 25569)
+++ tiki.sql	(revision 25570)
@@ -299,6 +299,7 @@
   `add_poster` char(1) default NULL,
   `allow_comments` char(1) default NULL,
   `show_avatar` char(1) default NULL,
+  `always_owner` char(1) default NULL,
   PRIMARY KEY (`blogId`),
   KEY `title` (`title`),
   KEY `description` (`description`(255)),

------------------------------------------------------------------------
r25513 | jonnybradley | 2010-02-22 15:38:15 -0400 (seg, 22 fev 2010) | 1 line

[ENH] Add 'from' email address to webmail accounts - overrides user pref if set.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 25512)
+++ tiki.sql	(revision 25513)
@@ -2351,6 +2351,7 @@
   `mbox` varchar( 255 ) default NULL,
   `maildir` varchar( 255 ) default NULL,
   `useSSL` char( 1 ) NOT NULL default 'n',
+  `fromEmail` varchar( 255 ) NOT NULL default '',
   PRIMARY KEY (`accountId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 

------------------------------------------------------------------------
r25485 | chealer | 2010-02-22 01:44:38 -0400 (seg, 22 fev 2010) | 3 lines

[FIX] failure to create tiki_user_login_cookies
oops
Thanks Nelson Koth

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 25484)
+++ tiki.sql	(revision 25485)
@@ -2326,7 +2326,7 @@
 DROP TABLE IF EXISTS `tiki_user_login_cookies`;
 CREATE TABLE `tiki_user_login_cookies` (
 	`userId` INT NOT NULL,
-	`secret` TEXT NOT NULL,
+	`secret` CHAR(64) NOT NULL,
 	`expiration` TIMESTAMP NOT NULL,
 	PRIMARY KEY (`userId`, `secret`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;

------------------------------------------------------------------------
r25346 | lphuberdeau | 2010-02-18 12:01:46 -0400 (qui, 18 fev 2010) | 1 line

[NEW] Allow to generate auth tokens from tell a friend page to provide privileged access.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 25345)
+++ tiki.sql	(revision 25346)
@@ -3488,6 +3488,7 @@
 	`tokenId` INT NOT NULL AUTO_INCREMENT,
 	`creation` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
 	`timeout` INT NOT NULL DEFAULT 0,
+	`hits` INT NOT NULL DEFAULT 1,
 	`token` CHAR(32),
 	`entry` VARCHAR(50),
 	`parameters` VARCHAR(255),

------------------------------------------------------------------------
r25341 | chealer | 2010-02-18 05:26:58 -0400 (qui, 18 fev 2010) | 3 lines

[SEC] move persistent login cookies from tiki_preferences to new table tiki_user_login_cookies
Intertiki changes untested
userslib: remove unused functions get_user_hash() and get_user_by_hash()

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 25340)
+++ tiki.sql	(revision 25341)
@@ -2323,6 +2323,14 @@
   PRIMARY KEY (`urlId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
+DROP TABLE IF EXISTS `tiki_user_login_cookies`;
+CREATE TABLE `tiki_user_login_cookies` (
+	`userId` INT NOT NULL,
+	`secret` TEXT NOT NULL,
+	`expiration` TIMESTAMP NOT NULL,
+	PRIMARY KEY (`userId`, `secret`)
+) ENGINE=MyISAM AUTO_INCREMENT=1 ;
+
 DROP TABLE IF EXISTS `tiki_user_mail_accounts`;
 CREATE TABLE `tiki_user_mail_accounts` (
   `accountId` int(12) NOT NULL auto_increment,

------------------------------------------------------------------------
r25325 | lphuberdeau | 2010-02-17 17:55:51 -0400 (qua, 17 fev 2010) | 1 line

[NEW] Admin panel to configure rating calculations

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 25324)
+++ tiki.sql	(revision 25325)
@@ -3589,3 +3589,23 @@
 	UNIQUE `item_attribute_uq` ( `type`, `itemId`, `attribute` ),
 	KEY `attribute_lookup_ix` (`attribute`, `value`)
 );
+
+DROP TABLE IF EXISTS `tiki_rating_configs`;
+CREATE TABLE `tiki_rating_configs` (
+	`ratingConfigId` INT PRIMARY KEY AUTO_INCREMENT,
+	`name` VARCHAR(50) NOT NULL,
+	`expiry` INT NOT NULL DEFAULT 3600,
+	`formula` TEXT NOT NULL,
+	`callbacks` TEXT
+);
+
+DROP TABLE IF EXISTS `tiki_rating_obtained`;
+CREATE TABLE `tiki_rating_obtained` (
+	`ratingId` INT PRIMARY KEY AUTO_INCREMENT,
+	`ratingConfigId` INT NOT NULL,
+	`type` VARCHAR(50) NOT NULL,
+	`object` INT NOT NULL,
+	`expire` INT NOT NULL,
+	`value` FLOAT NOT NULL,
+	UNIQUE `tiki_obtained_rating_uq` (`type`, `object`, `ratingConfigId`)
+);

------------------------------------------------------------------------
r25280 | lphuberdeau | 2010-02-16 15:04:14 -0400 (ter, 16 fev 2010) | 1 line

[NEW] Adding very simple library to manage attributes on any object (to be used by upcoming features)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 25279)
+++ tiki.sql	(revision 25280)
@@ -3579,3 +3579,13 @@
 	UNIQUE `tiki_rss_items_item` (`rssId`, `guid`)
 );
 
+DROP TABLE IF EXISTS `tiki_object_attributes`;
+CREATE TABLE `tiki_object_attributes` (
+	`attributeId` INT PRIMARY KEY AUTO_INCREMENT,
+	`type` varchar(50) NOT NULL,
+	`itemId` varchar(255) NOT NULL,
+	`attribute` varchar(25) NOT NULL,
+	`value` varchar(100),
+	UNIQUE `item_attribute_uq` ( `type`, `itemId`, `attribute` ),
+	KEY `attribute_lookup_ix` (`attribute`, `value`)
+);

------------------------------------------------------------------------
r25278 | jonnybradley | 2010-02-16 14:27:10 -0400 (ter, 16 fev 2010) | 1 line

[MOD] Rename TikiSheet to Spreadsheets (user visible instances only)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 25277)
+++ tiki.sql	(revision 25278)
@@ -1343,7 +1343,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Quizzes','tiki-list_quizzes.php',755,'feature_quizzes','tiki_p_take_quiz','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Quiz Stats','tiki-quiz_stats.php',760,'feature_quizzes','tiki_p_view_quiz_stats','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Admin Quizzes','tiki-edit_quiz.php',765,'feature_quizzes','tiki_p_admin_quizzes','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','TikiSheet','tiki-sheets.php',780,'feature_sheet','tiki_p_view_sheet','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','Spreadsheets','tiki-sheets.php',780,'feature_sheet','tiki_p_view_sheet','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Sheets','tiki-sheets.php',782,'feature_sheet','tiki_p_view_sheet','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','Trackers','tiki-list_trackers.php',800,'feature_trackers','tiki_p_list_trackers','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Trackers','tiki-list_trackers.php',805,'feature_trackers','tiki_p_list_trackers','',0);

------------------------------------------------------------------------
r25234 | lphuberdeau | 2010-02-15 13:56:23 -0400 (seg, 15 fev 2010) | 1 line

[NEW] Adding user ratings to articles

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 25233)
+++ tiki.sql	(revision 25234)
@@ -2656,6 +2656,7 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_remove_article', 'Can remove articles', 'editors', 'cms', NULL, 'feature_articles');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_remove_submission', 'Can remove submissions', 'editors', 'cms', NULL, 'feature_articles');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_submit_article', 'Can submit articles', 'basic', 'cms', NULL, 'feature_articles');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_rate_article', 'Can rate articles', 'basic', 'cms', NULL, 'feature_articles');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_topic_read', 'Can read a topic (Applies only to individual topic perms)', 'basic', 'cms', NULL, 'feature_articles');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_contribution', 'Can admin contributions', 'admin', 'contribution', 'y', 'feature_contribution');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_directory', 'Can admin the directory', 'editors', 'directory', 'y', 'feature_directory');

------------------------------------------------------------------------
r25198 | sylvieg | 2010-02-13 18:49:54 -0400 (sÃ¡b, 13 fev 2010) | 1 line

[FIX]key: use as much as possible - group can be long (todo: use id)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 25197)
+++ tiki.sql	(revision 25198)
@@ -959,7 +959,7 @@
 CREATE TABLE `tiki_group_inclusion` (
   `groupName` varchar(255) NOT NULL default '',
   `includeGroup` varchar(255) NOT NULL default '',
-  PRIMARY KEY (`groupName`(30),`includeGroup`(30))
+  PRIMARY KEY (`groupName`(120),`includeGroup`(120))
 ) ENGINE=MyISAM;
 INSERT INTO  `tiki_group_inclusion` (`groupName` ,`includeGroup`) VALUES ('Registered','Anonymous');
 

------------------------------------------------------------------------
r25097 | jonnybradley | 2010-02-11 15:20:58 -0400 (qui, 11 fev 2010) | 2 lines

[ENH] Tiki-sheet can now parse wiki syntax in cells.
More to come (has produced more problems saving sheets with jQuery.sheet - saveSheet() needs rewiting... next)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 25096)
+++ tiki.sql	(revision 25097)
@@ -1944,6 +1944,7 @@
   `headerRow` int(4) NOT NULL default '0',
   `footerRow` int(4) NOT NULL default '0',
   `className` varchar(64) default NULL,
+  `parseValues` char( 1 ) NOT NULL default 'n',
   UNIQUE KEY `sheetId` (`sheetId`, `begin`)
 ) ENGINE=MyISAM;
 

------------------------------------------------------------------------
r25087 | lphuberdeau | 2010-02-11 14:15:02 -0400 (qui, 11 fev 2010) | 1 line

[NEW] Allow to pull RSS feeds into tiki articles

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 25086)
+++ tiki.sql	(revision 25087)
@@ -1832,6 +1832,7 @@
   `showPubDate` char(1) default 'n',
   `sitetitle` VARCHAR(255),
   `siteurl` VARCHAR(255),
+  `actions` TEXT,
   PRIMARY KEY (`rssId`),
   KEY `name` (name)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;

------------------------------------------------------------------------
r25074 | lphuberdeau | 2010-02-11 11:35:36 -0400 (qui, 11 fev 2010) | 1 line

[MOD] Rewriting external feed library to use Zend_Feed_Reader rather than an assorted set of regex. Should add support for more formats, resolve multiple issues and speed up feed display (feeds used to be parsed every single time they were displayed and sorted manually)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 25073)
+++ tiki.sql	(revision 25074)
@@ -1830,7 +1830,8 @@
   `lastUpdated` int(14) default NULL,
   `showTitle` char(1) default 'n',
   `showPubDate` char(1) default 'n',
-  `content` longblob,
+  `sitetitle` VARCHAR(255),
+  `siteurl` VARCHAR(255),
   PRIMARY KEY (`rssId`),
   KEY `name` (name)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
@@ -3559,3 +3560,19 @@
    KEY `language` (`language`),
    UNIQUE (`page_id`, `language`)
 );
+
+DROP TABLE IF EXISTS `tiki_rss_items`;
+CREATE TABLE `tiki_rss_items` (
+	`rssItemId` INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
+	`rssId` INT NOT NULL,
+	`guid` VARCHAR(255) NOT NULL,
+	`url` VARCHAR(255) NOT NULL,
+	`publication_date` INT UNSIGNED NOT NULL,
+	`title` VARCHAR(255) NOT NULL,
+	`author` VARCHAR(255),
+	`description` TEXT,
+	`content` TEXT,
+	KEY `tiki_rss_items_rss` (`rssId`),
+	UNIQUE `tiki_rss_items_item` (`rssId`, `guid`)
+);
+

------------------------------------------------------------------------
r25064 | jonnybradley | 2010-02-11 09:40:44 -0400 (qui, 11 fev 2010) | 1 line

[ENH] Object perms management page gets it's own menu item

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 25063)
+++ tiki.sql	(revision 25064)
@@ -1430,6 +1430,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 's', 'Kaltura Video', 'tiki-list_kaltura_entries.php', 950, 'feature_kaltura', 'tiki_p_admin | tiki_p_admin_kaltura | tiki_p_list_videos', '', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'o', 'List Entries', 'tiki-list_kaltura_entries.php', 952, 'feature_kaltura', 'tiki_p_admin | tiki_p_admin_kaltura | tiki_p_list_videos', '', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'o', 'Upload Media', 'tiki-kaltura_upload.php', 954, 'feature_kaltura', 'tiki_p_admin | tiki_p_admin_kaltura | tiki_p_upload_videos', '', 0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Permissions','tiki-objectpermissions.php',1077,'','tiki_p_admin|tiki_p_admin_objects','',0);
 
 
 

------------------------------------------------------------------------
r24894 | sylvieg | 2010-02-05 15:10:05 -0400 (sex, 05 fev 2010) | 1 line

[NEW]wiki: new perm tiki_p_wiki_view_ref to be able to see a page in modules and rss (without the data) convenient for a site with only one page visible. (more modules to come) 

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 24893)
+++ tiki.sql	(revision 24894)
@@ -2791,6 +2791,7 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_upload_picture', 'Can upload pictures to wiki pages', 'registered', 'wiki', NULL, 'feature_wiki_pictures');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_use_as_template', 'Can use the page as a tracker template', 'basic', 'wiki', NULL, 'feature_wiki');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view', 'Can view page/pages', 'basic', 'wiki', NULL, 'feature_wiki');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_wiki_view_ref', 'Can view in module and feed the wiki pages reference', 'basic', 'wiki', NULL, 'feature_wiki');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_watch_structure', 'Can watch structure', 'registered', 'wiki', NULL, 'feature_wiki_structure');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_wiki_admin_attachments', 'Can admin attachments to wiki pages', 'editors', 'wiki', NULL, 'feature_wiki_attachments');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_wiki_admin_ratings', 'Can add and change ratings on wiki pages', 'admin', 'wiki', NULL, 'feature_wiki_ratings');

------------------------------------------------------------------------
r24869 | sept_7 | 2010-02-05 06:41:59 -0400 (sex, 05 fev 2010) | 3 lines

[MERGE] merging of experimental/tiki-log-merge to trunk
The aim of this is to unify tikilogs adn tikiactionlog, so now all logs are recorded via tikiactions logs...


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 24868)
+++ tiki.sql	(revision 24869)
@@ -81,9 +81,10 @@
   `object` varchar(255) default NULL,
   `objectType` varchar(32) NOT NULL default '',
   `user` varchar(200) default '',
-  `ip` varchar(15) default NULL,
+  `ip` varchar(39) default NULL,
   `comment` varchar(200) default NULL,
   `categId` int(12) NOT NULL default '0',
+	`client` VARCHAR( 200 ) NULL DEFAULT NULL,
   PRIMARY KEY (`actionId`),
   KEY `lastModif` (`lastModif`),
   KEY `object` (`object`(100), `objectType`, `action`(100))
@@ -3104,8 +3105,8 @@
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Viewed', 'image gallery', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Uploaded', 'file gallery', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Uploaded', 'image gallery', 'n');
-INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('*', 'category', 'n');
-INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('*', 'login', 'n');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('%', 'category', 'n');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('login', 'system', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Posted', 'message', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Replied', 'message', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Viewed', 'message', 'n');
@@ -3129,6 +3130,7 @@
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Removed', 'blog', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Removed', 'file', 'n');
 INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('Viewed', 'article', 'n');
+INSERT IGNORE INTO tiki_actionlog_conf(action, `objectType`, status) VALUES ('%', 'system', 'n');
 
 DROP TABLE IF EXISTS `tiki_freetags`;
 CREATE TABLE `tiki_freetags` (

------------------------------------------------------------------------
r24818 | lphuberdeau | 2010-02-03 14:28:47 -0400 (qua, 03 fev 2010) | 1 line

[NEW] Cart

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 24817)
+++ tiki.sql	(revision 24818)
@@ -3532,6 +3532,7 @@
 	`cancel_date` TIMESTAMP NULL,
 	`description` VARCHAR(100) NOT NULL,
 	`actions` TEXT,
+	`detail` TEXT,
 	PRIMARY KEY( `paymentRequestId` )
 );
 

------------------------------------------------------------------------
r24784 | sylvieg | 2010-02-01 17:04:25 -0400 (seg, 01 fev 2010) | 1 line

missing table

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 24783)
+++ tiki.sql	(revision 24784)
@@ -3546,3 +3546,11 @@
 	PRIMARY KEY(`paymentReceivedId`),
 	KEY `payment_request_ix` (`paymentRequestId`)
 );
+DROP TABLE IF EXISTS `tiki_translations_in_progress`;
+CREATE TABLE IF NOT EXISTS `tiki_translations_in_progress` (
+   `page_id` int(14) NOT NULL,
+   `language` char(2) NOT NULL,
+   KEY `page_id` (`page_id`),
+   KEY `language` (`language`),
+   UNIQUE (`page_id`, `language`)
+);

------------------------------------------------------------------------
r24745 | lphuberdeau | 2010-01-29 13:07:46 -0400 (sex, 29 jan 2010) | 1 line

[KIL]Â Screencast won't be used

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 24744)
+++ tiki.sql	(revision 24745)
@@ -2883,7 +2883,6 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_download_videos', 'Can download kaltura entry', 'registered', 'kaltura', NULL, 'feature_kaltura');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_list_videos', 'Can list kaltura entries', 'basic', 'kaltura', NULL, 'feature_kaltura');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_videos', 'Can view kaltura entry', 'basic', 'kaltura', NULL, 'feature_kaltura');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_upload_screencast', 'Can upload screencasts to wiki pages', 'basic', 'registered', NULL, 'feature_wiki_screencasts');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_dsn_query', 'Can execute arbitrary queries on a given DSN', 'admin', 'dsn', NULL, NULL);
 
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_admin', 'Can administer payments', 'admin', 'payment', 'y', 'payment_feature');

------------------------------------------------------------------------
r24744 | lphuberdeau | 2010-01-29 12:53:17 -0400 (sex, 29 jan 2010) | 1 line

[KIL]Â Pagelist won't be used

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 24743)
+++ tiki.sql	(revision 24744)
@@ -3468,25 +3468,6 @@
 	KEY `transition_lookup` (`type`, `from`)
 ) ENGINE=MyISAM;
 
-DROP TABLE IF EXISTS `tiki_page_lists`;
-CREATE TABLE IF NOT EXISTS `tiki_page_lists` (
-  `list_type_id` int(8) unsigned NOT NULL,
-  `priority` int(8) unsigned NOT NULL,
-  `page_name` varchar(160) NOT NULL,
-  `score` float default NULL,
-  PRIMARY KEY  (`list_type_id`,`page_name`)
-) ENGINE=MyISAM;
-
-DROP TABLE IF EXISTS `tiki_page_list_types`;
-CREATE TABLE IF NOT EXISTS `tiki_page_list_types` (
-  `id` int(8) unsigned NOT NULL auto_increment,
-  `name` varchar(40) NOT NULL,
-  `title` varchar(160) default NULL,
-  `description` varchar(200) default NULL,
-  PRIMARY KEY  (`name`),
-  UNIQUE KEY `id` (`id`)
-) ENGINE=MyISAM AUTO_INCREMENT=1 ;
-
 DROP TABLE IF EXISTS `tiki_auth_tokens`;
 CREATE TABLE `tiki_auth_tokens` (
 	`tokenId` INT NOT NULL AUTO_INCREMENT,

------------------------------------------------------------------------
r24732 | chealer | 2010-01-29 01:34:35 -0400 (sex, 29 jan 2010) | 2 lines

[KIL] unused events: evlib, tiki_events and now unused functions from notificationlib and registrationlib
Ref: http://sourceforge.net/mailarchive/forum.php?thread_name=4d9048fc1001280740o7325e83fq3b9e821b9f1f39cd%40mail.gmail.com&forum_name=tikiwiki-devel

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 24731)
+++ tiki.sql	(revision 24732)
@@ -3072,23 +3072,6 @@
   PRIMARY KEY (`object`(200),`type`,`day`)
 ) ENGINE=MyISAM;
 
-DROP TABLE IF EXISTS `tiki_events`;
-CREATE TABLE `tiki_events` (
-  `callback_type` int(1) NOT NULL default '3',
-  `order` int(2) NOT NULL default '50',
-  `event` varchar(200) NOT NULL default '',
-  `file` varchar(200) NOT NULL default '',
-  `object` varchar(200) NOT NULL default '',
-  `method` varchar(200) NOT NULL default '',
-  PRIMARY KEY (`callback_type`,`order`)
-) ENGINE=MyISAM;
-
-INSERT IGNORE INTO tiki_events(callback_type,`order`,event,file,object,method) VALUES ('1', '20', 'user_registers', 'lib/registration/registrationlib.php', 'registrationlib', 'callback_tikiwiki_setup_custom_fields');
-INSERT IGNORE INTO tiki_events(event,file,object,method) VALUES ('user_registers', 'lib/registration/registrationlib.php', 'registrationlib', 'callback_tikiwiki_save_registration');
-INSERT IGNORE INTO tiki_events(callback_type,`order`,event,file,object,method) VALUES ('5', '20', 'user_registers', 'lib/registration/registrationlib.php', 'registrationlib', 'callback_logslib_user_registers');
-INSERT IGNORE INTO tiki_events(callback_type,`order`,event,file,object,method) VALUES ('5', '25', 'user_registers', 'lib/registration/registrationlib.php', 'registrationlib', 'callback_tikiwiki_send_email');
-INSERT IGNORE INTO tiki_events(callback_type,`order`,event,file,object,method) VALUES ('5', '30', 'user_registers', 'lib/registration/registrationlib.php', 'registrationlib', 'callback_tikimail_user_registers');
-
 DROP TABLE IF EXISTS `tiki_registration_fields`;
 CREATE TABLE `tiki_registration_fields` (
   `id` int(11) NOT NULL auto_increment,

------------------------------------------------------------------------
r24719 | sylvieg | 2010-01-28 14:52:04 -0400 (qui, 28 jan 2010) | 1 line

[NEW]blog: new permission to be able to see modules and rss blog without having the perm to read the complete blog

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 24718)
+++ tiki.sql	(revision 24719)
@@ -2697,6 +2697,8 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_blog_post', 'Can post to a blog', 'registered', 'blogs', NULL, 'feature_blogs');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_create_blogs', 'Can create a blog', 'editors', 'blogs', NULL, 'feature_blogs');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_read_blog', 'Can read blogs', 'basic', 'blogs', NULL, 'feature_blogs');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_blog_post_view_ref', 'Can view in module and feed the blog posts', 'basic', 'blogs', NULL, 'feature_blogs');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_blog_view_ref', 'Can view in module and feed the blog', 'basic', 'blogs', NULL, 'feature_blogs');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_file_galleries', 'Can admin file galleries', 'editors', 'file galleries', 'y', 'feature_file_galleries');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_assign_perm_file_gallery', 'Can assign perms to file gallery', 'admin', 'file galleries', NULL, 'feature_file_galleries');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_batch_upload_file_dir', 'Can use Directory Batch Load', 'editors', 'file galleries', NULL, 'feature_file_galleries');

------------------------------------------------------------------------
r24687 | sylvieg | 2010-01-26 17:21:30 -0400 (ter, 26 jan 2010) | 1 line

[NEW]fgal: can display last Download

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 24686)
+++ tiki.sql	(revision 24687)
@@ -717,6 +717,7 @@
   `max_desc` int(8) default NULL,
   `show_created` char(1) default NULL,
   `show_hits` char(1) default NULL,
+  `show_lastDownload` char(1) default NULL,
   `parentId` int(14) NOT NULL default -1,
   `lockable` char(1) default 'n',
   `show_lockedby` char(1) default NULL,

------------------------------------------------------------------------
r24683 | sylvieg | 2010-01-26 16:24:13 -0400 (ter, 26 jan 2010) | 1 line

[NEW]fgal: memo last download time - can be approximative due to browser cache

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 24682)
+++ tiki.sql	(revision 24683)
@@ -758,6 +758,7 @@
   `user` varchar(200) default '',
   `author` varchar(40) default NULL,
   `hits` int(14) default NULL,
+  `lastDownload` int(14) default NULL,
   `votes` int(8) default NULL,
   `points` decimal(8,2) default NULL,
   `path` varchar(255) default NULL,

------------------------------------------------------------------------
r24586 | chealer | 2010-01-20 22:16:26 -0400 (qua, 20 jan 2010) | 1 line

[NEW] restore Tiki search for a few advantages over MySQL search

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 24585)
+++ tiki.sql	(revision 24586)
@@ -1246,7 +1246,8 @@
 
 -- when adding new inserts, order commands by position
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Home','./',10,'','','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Search','tiki-searchresults.php',13,'feature_search','tiki_p_search','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Search','tiki-searchresults.php',13,'feature_search_fulltext','tiki_p_search','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Search','tiki-searchindex.php',13,'feature_search','tiki_p_search','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Contact Us','tiki-contact.php',20,'feature_contact,feature_messages','','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Stats','tiki-stats.php',23,'feature_stats','tiki_p_view_stats','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Categories','tiki-browse_categories.php',25,'feature_categories','tiki_p_view_category','',0);
@@ -1840,6 +1841,36 @@
   PRIMARY KEY (`name`,`rssVer`)
 ) ENGINE=MyISAM;
 
+DROP TABLE IF EXISTS `tiki_searchindex`;
+CREATE TABLE tiki_searchindex(
+  `searchword` varchar(80) NOT NULL default '',
+  `location` varchar(80) NOT NULL default '',
+  `page` varchar(255) NOT NULL default '',
+  `count` int(11) NOT NULL default '1',
+  `last_update` int(11) NOT NULL default '0',
+  PRIMARY KEY (`searchword`,`location`,`page`(80)),
+  KEY `last_update` (last_update),
+  KEY `location` (location(50), page(200))
+) ENGINE=MyISAM;
+
+-- LRU (last recently used) list for searching parts of words
+DROP TABLE IF EXISTS `tiki_searchsyllable`;
+CREATE TABLE tiki_searchsyllable(
+  `syllable` varchar(80) NOT NULL default '',
+  `lastUsed` int(11) NOT NULL default '0',
+  `lastUpdated` int(11) NOT NULL default '0',
+  PRIMARY KEY (`syllable`),
+  KEY `lastUsed` (`lastUsed`)
+) ENGINE=MyISAM;
+
+-- searchword caching table for search syllables
+DROP TABLE IF EXISTS `tiki_searchwords`;
+CREATE TABLE tiki_searchwords(
+  `syllable` varchar(80) NOT NULL default '',
+  `searchword` varchar(80) NOT NULL default '',
+  PRIMARY KEY (`syllable`,`searchword`)
+) ENGINE=MyISAM;
+
 DROP TABLE IF EXISTS `tiki_search_stats`;
 CREATE TABLE `tiki_search_stats` (
   `term` varchar(50) NOT NULL default '',

------------------------------------------------------------------------
r24545 | sylvieg | 2010-01-19 09:46:04 -0400 (ter, 19 jan 2010) | 1 line

[NEW]forum: option to display in the list topics author avatar or last post user avatar

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 24544)
+++ tiki.sql	(revision 24545)
@@ -862,6 +862,7 @@
   `topics_list_lastpost_title` char(1) default NULL,
   `topics_list_lastpost_avatar` char(1) default NULL,
   `topics_list_author` char(1) default NULL,
+  `topics_list_author_avatar` char(1) default NULL,
   `vote_threads` char(1) default NULL,
   `forum_last_n` int(2) default 0,
   `threadStyle` varchar(100) default NULL,

------------------------------------------------------------------------
r24508 | pascalstjean | 2010-01-18 17:15:25 -0400 (seg, 18 jan 2010) | 1 line

[NEW] Added Blog Property Use_Author in order to control the display of author

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 24507)
+++ tiki.sql	(revision 24508)
@@ -293,6 +293,7 @@
   `heading` text,
   `use_find` char(1) default NULL,
   `use_title` char(1) default NULL,
+  `use_author` char(1) default NULL,
   `add_date` char(1) default NULL,
   `add_poster` char(1) default NULL,
   `allow_comments` char(1) default NULL,

------------------------------------------------------------------------
r24501 | chealer | 2010-01-18 15:40:20 -0400 (seg, 18 jan 2010) | 2 lines

[KIL] Removal of DB Abstraction code (db/, search)
[FIX] colons inside tr blocks

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 24500)
+++ tiki.sql	(revision 24501)
@@ -1244,8 +1244,7 @@
 
 -- when adding new inserts, order commands by position
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Home','./',10,'','','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Search','tiki-searchresults.php',13,'feature_search_fulltext','tiki_p_search','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Search','tiki-searchindex.php',13,'feature_search','tiki_p_search','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Search','tiki-searchresults.php',13,'feature_search','tiki_p_search','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Contact Us','tiki-contact.php',20,'feature_contact,feature_messages','','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Stats','tiki-stats.php',23,'feature_stats','tiki_p_view_stats','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Categories','tiki-browse_categories.php',25,'feature_categories','tiki_p_view_category','',0);
@@ -1839,36 +1838,6 @@
   PRIMARY KEY (`name`,`rssVer`)
 ) ENGINE=MyISAM;
 
-DROP TABLE IF EXISTS `tiki_searchindex`;
-CREATE TABLE tiki_searchindex(
-  `searchword` varchar(80) NOT NULL default '',
-  `location` varchar(80) NOT NULL default '',
-  `page` varchar(255) NOT NULL default '',
-  `count` int(11) NOT NULL default '1',
-  `last_update` int(11) NOT NULL default '0',
-  PRIMARY KEY (`searchword`,`location`,`page`(80)),
-  KEY `last_update` (last_update),
-  KEY `location` (location(50), page(200))
-) ENGINE=MyISAM;
-
--- LRU (last recently used) list for searching parts of words
-DROP TABLE IF EXISTS `tiki_searchsyllable`;
-CREATE TABLE tiki_searchsyllable(
-  `syllable` varchar(80) NOT NULL default '',
-  `lastUsed` int(11) NOT NULL default '0',
-  `lastUpdated` int(11) NOT NULL default '0',
-  PRIMARY KEY (`syllable`),
-  KEY `lastUsed` (`lastUsed`)
-) ENGINE=MyISAM;
-
--- searchword caching table for search syllables
-DROP TABLE IF EXISTS `tiki_searchwords`;
-CREATE TABLE tiki_searchwords(
-  `syllable` varchar(80) NOT NULL default '',
-  `searchword` varchar(80) NOT NULL default '',
-  PRIMARY KEY (`syllable`,`searchword`)
-) ENGINE=MyISAM;
-
 DROP TABLE IF EXISTS `tiki_search_stats`;
 CREATE TABLE `tiki_search_stats` (
   `term` varchar(50) NOT NULL default '',

------------------------------------------------------------------------
r24481 | marclaporte | 2010-01-18 00:18:08 -0400 (seg, 18 jan 2010) | 1 line

[FIX] avoid 2 errors on clean install

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 24480)
+++ tiki.sql	(revision 24481)
@@ -3552,7 +3552,7 @@
 	   KEY `fileId` (`fileId`)
 );
 
-DROP TABLE `tiki_payment_requests`;
+DROP TABLE IF EXISTS `tiki_payment_requests`;
 CREATE TABLE `tiki_payment_requests` (
 	`paymentRequestId` INT NOT NULL AUTO_INCREMENT,
 	`amount` DECIMAL(7,2) NOT NULL,
@@ -3566,7 +3566,7 @@
 	PRIMARY KEY( `paymentRequestId` )
 );
 
-DROP TABLE `tiki_payment_received`;
+DROP TABLE IF EXISTS `tiki_payment_received`;
 CREATE TABLE `tiki_payment_received` (
 	`paymentReceivedId` INT NOT NULL AUTO_INCREMENT,
 	`paymentRequestId` INT NOT NULL,

------------------------------------------------------------------------
r24435 | pascalstjean | 2010-01-15 23:07:29 -0400 (sex, 15 jan 2010) | 1 line

[MOD] changed main menu List Pages to Pages. Because this is where the new Create page function resides. Therefore it was appropriate to rename the link and make it intuative for new users.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 24434)
+++ tiki.sql	(revision 24435)
@@ -1277,7 +1277,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Last Changes','tiki-lastchanges.php',205,'feature_wiki,feature_lastChanges','tiki_p_view','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Dump','dump/new.tar',210,'feature_wiki,feature_dump','tiki_p_view','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Rankings','tiki-wiki_rankings.php',215,'feature_wiki,feature_wiki_rankings','tiki_p_view','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','List Pages','tiki-listpages.php',220,'feature_wiki,feature_listPages','tiki_p_view','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Pages','tiki-listpages.php',220,'feature_wiki,feature_listPages','tiki_p_view','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Orphan Pages','tiki-orphan_pages.php',225,'feature_wiki,feature_listorphanPages','tiki_p_view','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Sandbox','tiki-editpage.php?page=sandbox',230,'feature_wiki,feature_sandbox','tiki_p_view','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Multiple Print','tiki-print_pages.php',235,'feature_wiki,feature_wiki_multiprint','tiki_p_view','',0);

------------------------------------------------------------------------
r24419 | pascalstjean | 2010-01-15 18:23:15 -0400 (sex, 15 jan 2010) | 1 line

[NEW] Admin Modules Permission SQL Query

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 24418)
+++ tiki.sql	(revision 24419)
@@ -1375,6 +1375,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'','tiki_p_admin_toolbars','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'','tiki_p_edit_menu','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'','tiki_p_clean_cache','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'','tiki_p_admin_modules','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Admin Home','tiki-admin.php',1051,'','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Live Support','tiki-live_support_admin.php',1055,'feature_live_support','tiki_p_live_support_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Live Support','tiki-live_support_admin.php',1055,'feature_live_support','user_is_operator','',0);
@@ -1383,7 +1384,7 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Users','tiki-adminusers.php',1070,'','tiki_p_admin_users','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Groups','tiki-admingroups.php',1075,'','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','External Pages Cache','tiki-list_cache.php',1080,'cachepages','tiki_p_admin','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Modules','tiki-admin_modules.php',1085,'','tiki_p_admin','',0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Modules','tiki-admin_modules.php',1085,'','tiki_p_admin_modules','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Hotwords','tiki-admin_hotwords.php',1095,'feature_hotwords','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','External Feeds','tiki-admin_rssmodules.php',1100,'','tiki_p_admin_rssmodules','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Menus','tiki-admin_menus.php',1105,'','tiki_p_edit_menu','',0);
@@ -2883,6 +2884,7 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_view', 'Can view payment requests and details', 'admin', 'payment', NULL, 'payment_feature');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_manual', 'Can enter manual payments', 'admin', 'payment', NULL, 'payment_feature');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_request', 'Can request a payment', 'admin', 'payment', NULL, 'payment_feature');
+INSERT INTO users_permissions (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES ('tiki_p_admin_modules', 'User can Administer Modules', 'registered', 'tiki', NULL, NULL);
 
 
 DROP TABLE IF EXISTS `users_usergroups`;

------------------------------------------------------------------------
r24390 | chealer | 2010-01-15 00:56:19 -0400 (sex, 15 jan 2010) | 1 line

[FIX] duplicate addition of payment permissions

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 24389)
+++ tiki.sql	(revision 24390)
@@ -3575,9 +3575,3 @@
 	PRIMARY KEY(`paymentReceivedId`),
 	KEY `payment_request_ix` (`paymentRequestId`)
 );
-
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_admin', 'Can administer paymenrs', 'admin', 'payment', 'y', 'payment_feature');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_view', 'Can view payment requests and details', 'admin', 'payment', NULL, 'payment_feature');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_manual', 'Can enter manual payments', 'admin', 'payment', NULL, 'payment_feature');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_request', 'Can request a payment', 'admin', 'payment', NULL, 'payment_feature');
-

------------------------------------------------------------------------
r24318 | sylvieg | 2010-01-13 17:05:13 -0400 (qua, 13 jan 2010) | 1 line

[MOD]forum: option not to see the last post title - it is usually the Re:topic title...)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 24317)
+++ tiki.sql	(revision 24318)
@@ -858,6 +858,8 @@
   `topics_list_reads` char(1) default NULL,
   `topics_list_pts` char(1) default NULL,
   `topics_list_lastpost` char(1) default NULL,
+  `topics_list_lastpost_title` char(1) default NULL,
+  `topics_list_lastpost_avatar` char(1) default NULL,
   `topics_list_author` char(1) default NULL,
   `vote_threads` char(1) default NULL,
   `forum_last_n` int(2) default 0,

------------------------------------------------------------------------
r24214 | marclaporte | 2010-01-08 12:39:41 -0400 (sex, 08 jan 2010) | 1 line

[FIX] typo

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 24213)
+++ tiki.sql	(revision 24214)
@@ -2877,7 +2877,7 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_upload_screencast', 'Can upload screencasts to wiki pages', 'basic', 'registered', NULL, 'feature_wiki_screencasts');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_dsn_query', 'Can execute arbitrary queries on a given DSN', 'admin', 'dsn', NULL, NULL);
 
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_admin', 'Can administer paymenrs', 'admin', 'payment', 'y', 'payment_feature');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_admin', 'Can administer payments', 'admin', 'payment', 'y', 'payment_feature');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_view', 'Can view payment requests and details', 'admin', 'payment', NULL, 'payment_feature');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_manual', 'Can enter manual payments', 'admin', 'payment', NULL, 'payment_feature');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_request', 'Can request a payment', 'admin', 'payment', NULL, 'payment_feature');

------------------------------------------------------------------------
r24207 | lphuberdeau | 2010-01-08 09:47:14 -0400 (sex, 08 jan 2010) | 1 line

[FIX] Forgot drop tables yesterday

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 24206)
+++ tiki.sql	(revision 24207)
@@ -3548,6 +3548,7 @@
 	   KEY `fileId` (`fileId`)
 );
 
+DROP TABLE `tiki_payment_requests`;
 CREATE TABLE `tiki_payment_requests` (
 	`paymentRequestId` INT NOT NULL AUTO_INCREMENT,
 	`amount` DECIMAL(7,2) NOT NULL,
@@ -3561,6 +3562,7 @@
 	PRIMARY KEY( `paymentRequestId` )
 );
 
+DROP TABLE `tiki_payment_received`;
 CREATE TABLE `tiki_payment_received` (
 	`paymentReceivedId` INT NOT NULL AUTO_INCREMENT,
 	`paymentRequestId` INT NOT NULL,

------------------------------------------------------------------------
r24205 | lphuberdeau | 2010-01-07 18:41:40 -0400 (qui, 07 jan 2010) | 1 line

[NEW] Basic payment management

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 24204)
+++ tiki.sql	(revision 24205)
@@ -2877,7 +2877,12 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_upload_screencast', 'Can upload screencasts to wiki pages', 'basic', 'registered', NULL, 'feature_wiki_screencasts');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_dsn_query', 'Can execute arbitrary queries on a given DSN', 'admin', 'dsn', NULL, NULL);
 
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_admin', 'Can administer paymenrs', 'admin', 'payment', 'y', 'payment_feature');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_view', 'Can view payment requests and details', 'admin', 'payment', NULL, 'payment_feature');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_manual', 'Can enter manual payments', 'admin', 'payment', NULL, 'payment_feature');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_request', 'Can request a payment', 'admin', 'payment', NULL, 'payment_feature');
 
+
 DROP TABLE IF EXISTS `users_usergroups`;
 CREATE TABLE `users_usergroups` (
   `userId` int(8) NOT NULL default '0',
@@ -3543,4 +3548,32 @@
 	   KEY `fileId` (`fileId`)
 );
 
+CREATE TABLE `tiki_payment_requests` (
+	`paymentRequestId` INT NOT NULL AUTO_INCREMENT,
+	`amount` DECIMAL(7,2) NOT NULL,
+	`amount_paid` DECIMAL(7,2) NOT NULL DEFAULT 0.0,
+	`currency` CHAR(3) NOT NULL,
+	`request_date` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
+	`due_date` TIMESTAMP NOT NULL,
+	`cancel_date` TIMESTAMP NULL,
+	`description` VARCHAR(100) NOT NULL,
+	`actions` TEXT,
+	PRIMARY KEY( `paymentRequestId` )
+);
 
+CREATE TABLE `tiki_payment_received` (
+	`paymentReceivedId` INT NOT NULL AUTO_INCREMENT,
+	`paymentRequestId` INT NOT NULL,
+	`payment_date` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
+	`amount` DECIMAL(7,2),
+	`type` VARCHAR(15),
+	`details` TEXT,
+	PRIMARY KEY(`paymentReceivedId`),
+	KEY `payment_request_ix` (`paymentRequestId`)
+);
+
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_admin', 'Can administer paymenrs', 'admin', 'payment', 'y', 'payment_feature');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_view', 'Can view payment requests and details', 'admin', 'payment', NULL, 'payment_feature');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_manual', 'Can enter manual payments', 'admin', 'payment', NULL, 'payment_feature');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_payment_request', 'Can request a payment', 'admin', 'payment', NULL, 'payment_feature');
+

------------------------------------------------------------------------
r24167 | sylvieg | 2010-01-06 13:02:15 -0400 (qua, 06 jan 2010) | 1 line

[NEW]forum: option to display in forum view the number of attachements of all the threads of a topic

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 24166)
+++ tiki.sql	(revision 24167)
@@ -832,6 +832,7 @@
   `att_store` varchar(4) default NULL,
   `att_store_dir` varchar(250) default NULL,
   `att_max_size` int(12) default NULL,
+  `att_list_nb` char(1) default NULL,
   `ui_level` char(1) default NULL,
   `forum_password` varchar(32) default NULL,
   `forum_use_password` char(1) default NULL,

------------------------------------------------------------------------
r24142 | sylvieg | 2010-01-04 15:21:34 -0400 (seg, 04 jan 2010) | 1 line

[MOD]tracker: new perm to be able to revote ratings

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 24141)
+++ tiki.sql	(revision 24142)
@@ -2759,6 +2759,7 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_modify_tracker_items_closed', 'Can change tracker closed items', 'registered', 'trackers', NULL, 'feature_trackers');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_tracker_view_ratings', 'Can view rating result for tracker items', 'basic', 'trackers', NULL, 'feature_trackers');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_tracker_vote_ratings', 'Can vote a rating for tracker items', 'registered', 'trackers', NULL, 'feature_trackers');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_tracker_revote_ratings', 'Can re-vote a rating for tracker items', 'registered', 'trackers', NULL, 'feature_trackers');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_trackers', 'Can view trackers', 'basic', 'trackers', NULL, 'feature_trackers');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_trackers_closed', 'Can view trackers closed items', 'registered', 'trackers', NULL, 'feature_trackers');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_trackers_pending', 'Can view trackers pending items', 'editors', 'trackers', NULL, 'feature_trackers');

------------------------------------------------------------------------
r24070 | lphuberdeau | 2009-12-28 13:46:06 -0400 (seg, 28 dez 2009) | 1 line

[NEW] Mozilla upstream. Wiki page keyword manager

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 24069)
+++ tiki.sql	(revision 24070)
@@ -1568,6 +1568,7 @@
   `wysiwyg` char(1) default NULL,
   `wiki_authors_style` varchar(20) default '',
   `comments_enabled` char(1) default NULL,
+  `keywords` TEXT, 
   PRIMARY KEY (`page_id`),
   UNIQUE KEY `pageName` (`pageName`),
   KEY `data` (`data`(255)),

------------------------------------------------------------------------
r23965 | sylvieg | 2009-12-18 20:14:23 -0400 (sex, 18 dez 2009) | 1 line

dbv sync

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 23964)
+++ tiki.sql	(revision 23965)
@@ -2962,7 +2962,7 @@
 
 INSERT INTO tiki_integrator_rules VALUES ('1','1','1','.*<body[^>]*?>(.*?)</body.*','\1','y','n','i','y','Extract code between <body> and </body> tags');
 INSERT INTO tiki_integrator_rules VALUES ('2','1','2','img src=(\"|\')(?!http://)','img src=\1{path}/','y','n','i','y','Fix image paths');
-INSERT INTO tiki_integrator_rules VALUES ('3','1','3','href=(\"|\')(?!(#|(http|ftp)://))','href=\1tiki-integrator.php?repID={repID}&file=','y','n','i','y','Replace internal links to integrator. Don\'t touch an external link.');
+INSERT INTO tiki_integrator_rules VALUES ('3','1','3','href=(\"|\')(?!(#|(http|ftp)://))','href=\1tiki-integrator.php?repID={repID}&file=','y','n','i','y','Replace internal links to integrator. Don not touch an external link.');
 
 -- Translated objects table
 DROP TABLE IF EXISTS `tiki_translated_objects`;

------------------------------------------------------------------------
r23919 | sylvieg | 2009-12-16 13:50:23 -0400 (qua, 16 dez 2009) | 1 line

[MOD]fgal: display nb backlinks in fgal

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 23918)
+++ tiki.sql	(revision 23919)
@@ -736,6 +736,7 @@
   `size` int(14) default NULL,
   `wiki_syntax` varchar(200) default NULL,
   `backlinkPerms` char(1) default 'n',
+  `show_backlinks` char(1) default NULL,
   PRIMARY KEY (`galleryId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 

------------------------------------------------------------------------
r23877 | lphuberdeau | 2009-12-14 13:36:53 -0400 (seg, 14 dez 2009) | 1 line

[NEW] Perspective UI (initial)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 23876)
+++ tiki.sql	(revision 23877)
@@ -2851,6 +2851,9 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_remove_object', 'Can remove objects from the category', 'editors', 'category', NULL, 'feature_categories');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_create_category', 'Can create new categories', 'admin', 'category', NULL, 'feature_categories');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_perspective_view', 'Can view the perspective', 'basic', 'perspective', NULL, 'feature_perspective');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_perspective_edit', 'Can edit the perspective', 'basic', 'perspective', NULL, 'feature_perspective');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_perspective_create', 'Can create a perspective', 'basic', 'perspective', NULL, 'feature_perspective');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_perspective_admin', 'Can admin perspectives', 'admin', 'perspective', 'y', 'feature_perspective');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_group_view', 'Can view the group', 'basic', 'group', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_group_view_members', 'Can view the group members', 'basic', 'group', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_group_add_member', 'Can add group members', 'admin', 'group', NULL, NULL);

------------------------------------------------------------------------
r23810 | lphuberdeau | 2009-12-10 14:47:16 -0400 (qui, 10 dez 2009) | 1 line

[MOD] Allow to use wiki pages for dynamic content

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 23809)
+++ tiki.sql	(revision 23810)
@@ -1647,6 +1647,7 @@
 CREATE TABLE `tiki_programmed_content` (
   `pId` int(8) NOT NULL auto_increment,
   `contentId` int(8) NOT NULL default '0',
+  `content_type` VARCHAR( 20 ) NOT NULL DEFAULT 'static',
   `publishDate` int(14) NOT NULL default '0',
   `data` text,
   PRIMARY KEY (`pId`)

------------------------------------------------------------------------
r23771 | sylvieg | 2009-12-09 12:30:57 -0400 (qua, 09 dez 2009) | 1 line

[FIX]fgal rss: need to limit the cache name for a long list og galleries

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 23770)
+++ tiki.sql	(revision 23771)
@@ -1824,7 +1824,7 @@
 
 DROP TABLE IF EXISTS `tiki_rss_feeds`;
 CREATE TABLE `tiki_rss_feeds` (
-  `name` varchar(30) NOT NULL default '',
+  `name` varchar(60) NOT NULL default '',
   `rssVer` char(1) NOT NULL default '1',
   `refresh` int(8) default '300',
   `lastUpdated` int(14) default NULL,

------------------------------------------------------------------------
r23759 | sylvieg | 2009-12-08 19:15:55 -0400 (ter, 08 dez 2009) | 1 line

[NEW]fgal: new option for a fgal: after fgal perms check, file perms check - check if the objects using the file are viewable - if None of them are viewable, the file can bot be seen

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 23758)
+++ tiki.sql	(revision 23759)
@@ -735,6 +735,7 @@
   `quota` int(8) default 0,
   `size` int(14) default NULL,
   `wiki_syntax` varchar(200) default NULL,
+  `backlinkPerms` char(1) default 'n',
   PRIMARY KEY (`galleryId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 

------------------------------------------------------------------------
r23675 | sylvieg | 2009-12-04 16:45:56 -0400 (sex, 04 dez 2009) | 1 line

[NEW]newletter: perm to see the archives different than perm to subscribe

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 23674)
+++ tiki.sql	(revision 23675)
@@ -2723,6 +2723,7 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_send_newsletters', 'Can send newsletters', 'editors', 'newsletters', NULL, 'feature_newsletters');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_subscribe_email', 'Can subscribe any email to newsletters', 'editors', 'newsletters', NULL, 'feature_newsletters');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_subscribe_newsletters', 'Can subscribe to newsletters', 'basic', 'newsletters', NULL, 'feature_newsletters');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_newsletter', 'Can view the archive of a newsletters', 'basic', 'newsletters', NULL, 'feature_newsletters');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_list_newsletters', 'Can list newsletters', 'basic', 'newsletters', NULL, 'feature_newsletters');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_polls', 'Can admin polls', 'admin', 'polls', 'y', 'feature_polls');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_poll_results', 'Can view poll results', 'basic', 'polls', NULL, 'feature_polls');

------------------------------------------------------------------------
r23669 | sylvieg | 2009-12-04 12:08:25 -0400 (sex, 04 dez 2009) | 1 line

[MRG] Automatic merge, branches/4.x 23636 to 23661

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 23668)
+++ tiki.sql	(revision 23669)
@@ -734,6 +734,7 @@
   `default_view` varchar(20) default NULL,
   `quota` int(8) default 0,
   `size` int(14) default NULL,
+  `wiki_syntax` varchar(200) default NULL,
   PRIMARY KEY (`galleryId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 

------------------------------------------------------------------------
r23646 | lphuberdeau | 2009-12-03 13:38:27 -0400 (qui, 03 dez 2009) | 1 line

[FIX] Forgot to add this field a few weeks ago.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 23645)
+++ tiki.sql	(revision 23646)
@@ -552,6 +552,7 @@
 DROP TABLE IF EXISTS `tiki_content_templates`;
 CREATE TABLE `tiki_content_templates` (
   `templateId` int(10) NOT NULL auto_increment,
+  `template_type` VARCHAR( 20 ) NOT NULL DEFAULT 'static',
   `content` longblob,
   `name` varchar(200) default NULL,
   `created` int(14) default NULL,

------------------------------------------------------------------------
r23635 | jonnybradley | 2009-12-02 15:21:27 -0400 (qua, 02 dez 2009) | 1 line

[FIX] Remove duplicated insert statement

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 23634)
+++ tiki.sql	(revision 23635)
@@ -3328,7 +3328,6 @@
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`) VALUES('tiki-browse_image.php\\?imageId=(\\d+)', 'browseimage$1', 'image', 'feature_galleries');
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`) VALUES('tiki-directory_browse.php\\?parent=(\\d+)', 'directory$1', 'directory', 'feature_directory');
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`) VALUES('tiki-view_faq.php\\?faqId=(\\d+)', 'faq$1', 'faq', 'feature_faqs');
-INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`) VALUES('tiki-list_file_gallery.php\\?galleryId=(\\d+)', 'file$1', 'file', 'feature_file_galleries');
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`) VALUES('tiki-download_file.php\\?fileId=(\\d+)', 'dl$1', 'file', 'feature_file_galleries');
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`) VALUES('tiki-download_file.php\\?fileId=(\\d+)&amp;thumbnail', 'thumbnail$1', 'thumbnail', 'feature_file_galleries');
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`) VALUES('tiki-download_file.php\\?fileId=(\\d+)&amp;display', 'display$1', 'display', 'feature_file_galleries');

------------------------------------------------------------------------
r23539 | lphuberdeau | 2009-11-26 14:16:53 -0400 (qui, 26 nov 2009) | 1 line

[NEW] Mozilla upstream. Allow dynamic language variables to be language specific.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 23538)
+++ tiki.sql	(revision 23539)
@@ -638,7 +638,7 @@
 CREATE TABLE `tiki_dynamic_variables` (
   `name` varchar(40) NOT NULL,
   `data` text,
-  PRIMARY KEY (`name`)
+  `lang` VARCHAR(16) NULL
 );
 
 DROP TABLE IF EXISTS `tiki_extwiki`;

------------------------------------------------------------------------
r23515 | jonnybradley | 2009-11-25 15:55:20 -0400 (qua, 25 nov 2009) | 1 line

[MRG] Automatic merge, branches/4.x 23509 to 23514

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 23514)
+++ tiki.sql	(revision 23515)
@@ -1563,6 +1563,7 @@
   `created` int(14),
   `wysiwyg` char(1) default NULL,
   `wiki_authors_style` varchar(20) default '',
+  `comments_enabled` char(1) default NULL,
   PRIMARY KEY (`page_id`),
   UNIQUE KEY `pageName` (`pageName`),
   KEY `data` (`data`(255)),

------------------------------------------------------------------------
r23494 | sylvieg | 2009-11-24 17:48:44 -0400 (ter, 24 nov 2009) | 1 line

[NEW]fgal: backlink to files for wiki page (only the last version) + blog: warning when you want to delete a file that has backlinks

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 23493)
+++ tiki.sql	(revision 23494)
@@ -3465,7 +3465,7 @@
   `page_name` varchar(160) NOT NULL,
   `score` float default NULL,
   PRIMARY KEY  (`list_type_id`,`page_name`)
-) ENGINE=MyISAM DEFAULT CHARSET=latin1;
+) ENGINE=MyISAM;
 
 DROP TABLE IF EXISTS `tiki_page_list_types`;
 CREATE TABLE IF NOT EXISTS `tiki_page_list_types` (
@@ -3475,7 +3475,7 @@
   `description` varchar(200) default NULL,
   PRIMARY KEY  (`name`),
   UNIQUE KEY `id` (`id`)
-) ENGINE=MyISAM DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;
+) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 
 DROP TABLE IF EXISTS `tiki_auth_tokens`;
 CREATE TABLE `tiki_auth_tokens` (
@@ -3489,7 +3489,6 @@
 	PRIMARY KEY( `tokenId` ),
 	KEY `tiki_auth_tokens_token` (`token`)
 );
--- --------------------------------------------------------
 
 DROP TABLE IF EXISTS `metrics_assigned`;
 CREATE TABLE `metrics_assigned` (
@@ -3524,3 +3523,12 @@
 	UNIQUE KEY `tab_name` (`tab_name`)
 );
 
+DROP TABLE IF EXISTS `tiki_file_backlinks`;
+CREATE TABLE `tiki_file_backlinks` (
+	   `fileId` int(14) NOT NULL,
+	   `objectId` int(12) NOT NULL,
+	   KEY `objectId` (`objectId`),
+	   KEY `fileId` (`fileId`)
+);
+
+

------------------------------------------------------------------------
r23481 | lphuberdeau | 2009-11-24 11:19:58 -0400 (ter, 24 nov 2009) | 1 line

[NEW] Mozilla upstream. Metrics dashboard.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 23480)
+++ tiki.sql	(revision 23481)
@@ -2862,6 +2862,7 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_list_videos', 'Can list kaltura entries', 'basic', 'kaltura', NULL, 'feature_kaltura');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_videos', 'Can view kaltura entry', 'basic', 'kaltura', NULL, 'feature_kaltura');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_upload_screencast', 'Can upload screencasts to wiki pages', 'basic', 'registered', NULL, 'feature_wiki_screencasts');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_dsn_query', 'Can execute arbitrary queries on a given DSN', 'admin', 'dsn', NULL, NULL);
 
 
 DROP TABLE IF EXISTS `users_usergroups`;
@@ -3489,3 +3490,37 @@
 	KEY `tiki_auth_tokens_token` (`token`)
 );
 -- --------------------------------------------------------
+
+DROP TABLE IF EXISTS `metrics_assigned`;
+CREATE TABLE `metrics_assigned` (
+	`assigned_id` int(11) NOT NULL AUTO_INCREMENT,
+	`metric_id` int(11) NOT NULL,
+	`tab_id` int(11) NOT NULL,
+	PRIMARY KEY (`assigned_id`),
+	KEY `metric_id` (`metric_id`),
+	KEY `tab_id` (`tab_id`)
+);
+
+DROP TABLE IF EXISTS `metrics_metric`;
+CREATE TABLE `metrics_metric` (
+	`metric_id` int(11) NOT NULL AUTO_INCREMENT,
+	`metric_name` varchar(255) NOT NULL,
+	`metric_range` varchar(1) NOT NULL DEFAULT '+' COMMENT 'values: + (daily), @ (monthly&weekly), - (weekly)',
+	`metric_datatype` varchar(1) NOT NULL DEFAULT 'i' COMMENT 'values: i(nteger), %(percentage), f(loat), L(ist)',
+	`metric_lastupdate` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
+	`metric_query` text,
+	`metric_dsn` VARCHAR(200) NOT NULL DEFAULT 'local',
+	PRIMARY KEY (`metric_id`),
+	UNIQUE KEY `metric_name` (`metric_name`)
+);
+
+DROP TABLE IF EXISTS `metrics_tab`;
+CREATE TABLE `metrics_tab` (
+	`tab_id` int(11) NOT NULL AUTO_INCREMENT,
+	`tab_name` varchar(255) NOT NULL,
+	`tab_order` int(11) NOT NULL DEFAULT '0',
+	`tab_content` longtext NOT NULL,
+	PRIMARY KEY (`tab_id`),
+	UNIQUE KEY `tab_name` (`tab_name`)
+);
+

------------------------------------------------------------------------
r23403 | lphuberdeau | 2009-11-20 11:12:40 -0400 (sex, 20 nov 2009) | 1 line

[FIX] Poll filter never worked correctly, causing thousands of rows to be scanned on poll-intensive sites. Added an index to speed up the search as well.

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 23402)
+++ tiki.sql	(revision 23403)
@@ -1617,6 +1617,7 @@
   `voteConsiderationSpan` int(4) default 0,
   PRIMARY KEY (`pollId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
+ALTER TABLE tiki_polls ADD INDEX tiki_poll_lookup ( active , title );
 
 DROP TABLE IF EXISTS `tiki_preferences`;
 CREATE TABLE `tiki_preferences` (

------------------------------------------------------------------------
r23363 | sylvieg | 2009-11-18 12:33:31 -0400 (qua, 18 nov 2009) | 1 line

[MOD]sefurl: some sefurl in CATEGORY

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 23362)
+++ tiki.sql	(revision 23363)
@@ -3368,6 +3368,8 @@
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-mobile.php', 'mobile', '', 'feature_mobile', 200);
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-sheets.php', 'sheets', '', 'feature_sheet', 200);
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-view_tracker_item.php\\?trackerId=(\\d+)\\&itemId=(\\d+)', 'item$2', 'trackeritem', 'feature_trackers', 200);
+INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-view_tracker_item.php\\?itemId=(\\d+)', 'item$1', 'trackeritem', 'feature_trackers', 200);
+INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-list_file_gallery.php\\?galleryId=(\\d+)', 'file$1', 'file gallery', 'feature_file_galleries', 200);
  
 UPDATE tiki_menu_options SET icon = 'icon-configuration48x48' WHERE name = 'Admin';
 UPDATE tiki_menu_options SET icon = 'xfce4-appfinder48x48' WHERE name = 'Search';

------------------------------------------------------------------------
r23282 | sylvieg | 2009-11-14 08:50:23 -0400 (sÃ¡b, 14 nov 2009) | 1 line

[MRG] Automatic merge, branches/4.x 23227 to 23279

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 23281)
+++ tiki.sql	(revision 23282)
@@ -1479,7 +1479,7 @@
   KEY `moduleId` (`moduleId`)
 ) ENGINE=MyISAM;
 
-INSERT INTO tiki_modules (name,position,ord,cache_time,params,groups) VALUES ('Application_Menu','l',30,0,'flip=y','a:1:{i:0;s:10:"Registered";}');
+INSERT INTO tiki_modules (name,position,ord,cache_time,params,groups) VALUES ('Application Menu','l',30,0,'flip=y','a:1:{i:0;s:10:"Registered";}');
 
 DROP TABLE IF EXISTS `tiki_newsletter_subscriptions`;
 CREATE TABLE `tiki_newsletter_subscriptions` (
@@ -2345,7 +2345,7 @@
   PRIMARY KEY (`name`)
 ) ENGINE=MyISAM;
 
-INSERT INTO tiki_user_modules (name, title, data, parse) VALUES ('Application_Menu', 'Menu', '{menu id=42}', 'n');
+INSERT INTO tiki_user_modules (name, title, data, parse) VALUES ('Application Menu', 'Menu', '{menu id=42}', 'n');
 
 DROP TABLE IF EXISTS `tiki_user_notes`;
 CREATE TABLE `tiki_user_notes` (

------------------------------------------------------------------------
r23228 | lphuberdeau | 2009-11-13 09:31:34 -0400 (sex, 13 nov 2009) | 1 line

[MRG] Automatic merge, branches/4.x 23155 to 23227

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 23227)
+++ tiki.sql	(revision 23228)
@@ -1479,7 +1479,7 @@
   KEY `moduleId` (`moduleId`)
 ) ENGINE=MyISAM;
 
-INSERT INTO tiki_modules (name,position,ord,cache_time,params,groups) VALUES ('mnu_application_menu','l',30,0,'flip=y','a:1:{i:0;s:10:"Registered";}');
+INSERT INTO tiki_modules (name,position,ord,cache_time,params,groups) VALUES ('Application_Menu','l',30,0,'flip=y','a:1:{i:0;s:10:"Registered";}');
 
 DROP TABLE IF EXISTS `tiki_newsletter_subscriptions`;
 CREATE TABLE `tiki_newsletter_subscriptions` (
@@ -2345,7 +2345,7 @@
   PRIMARY KEY (`name`)
 ) ENGINE=MyISAM;
 
-INSERT INTO tiki_user_modules (name, title, data, parse) VALUES ('mnu_application_menu', 'Menu', '{menu id=42}', 'n');
+INSERT INTO tiki_user_modules (name, title, data, parse) VALUES ('Application_Menu', 'Menu', '{menu id=42}', 'n');
 
 DROP TABLE IF EXISTS `tiki_user_notes`;
 CREATE TABLE `tiki_user_notes` (

------------------------------------------------------------------------
r23123 | lphuberdeau | 2009-11-12 11:52:10 -0400 (qui, 12 nov 2009) | 1 line

[MRG] Automatic merge, branches/4.x 23047 to 23122

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 23122)
+++ tiki.sql	(revision 23123)
@@ -732,6 +732,7 @@
   `show_slideshow` char(1) default NULL,
   `default_view` varchar(20) default NULL,
   `quota` int(8) default 0,
+  `size` int(14) default NULL,
   PRIMARY KEY (`galleryId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 

------------------------------------------------------------------------
r22989 | sylvieg | 2009-11-09 12:54:41 -0400 (seg, 09 nov 2009) | 1 line

[MRG] Automatic merge, branches/4.x 22939 to 22987

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 22988)
+++ tiki.sql	(revision 22989)
@@ -94,7 +94,7 @@
   `actionId` int(8) NOT NULL,
   `name` varchar(40) NOT NULL,
   `value` text,
-  KEY `actionIDIndex` (`actionId`),
+  KEY `actionId` (`actionId`),
   KEY `nameValue` (`name`, `value`(200))
 ) ENGINE=MyISAM;
 
@@ -3285,7 +3285,7 @@
   `objectType` varchar( 20 ) NOT NULL default '',
   `objectId` varchar(10) NOT NULL default '',
   `displayEachuser` char( 1 ) default NULL ,
-  PRIMARY KEY ( `objectType`, `objectId` )
+  PRIMARY KEY (`groupName`, `objectType`, `objectId` )
 ) ENGINE=MyISAM ;
 
 DROP TABLE IF EXISTS `tiki_sent_newsletters_files`;

------------------------------------------------------------------------
r22937 | lphuberdeau | 2009-11-06 09:06:46 -0400 (sex, 06 nov 2009) | 1 line

[FIX] Forgot to add to tiki.sql

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 22936)
+++ tiki.sql	(revision 22937)
@@ -3453,6 +3453,7 @@
 	KEY `transition_lookup` (`type`, `from`)
 ) ENGINE=MyISAM;
 
+DROP TABLE IF EXISTS `tiki_page_lists`;
 CREATE TABLE IF NOT EXISTS `tiki_page_lists` (
   `list_type_id` int(8) unsigned NOT NULL,
   `priority` int(8) unsigned NOT NULL,
@@ -3461,6 +3462,7 @@
   PRIMARY KEY  (`list_type_id`,`page_name`)
 ) ENGINE=MyISAM DEFAULT CHARSET=latin1;
 
+DROP TABLE IF EXISTS `tiki_page_list_types`;
 CREATE TABLE IF NOT EXISTS `tiki_page_list_types` (
   `id` int(8) unsigned NOT NULL auto_increment,
   `name` varchar(40) NOT NULL,
@@ -3470,3 +3472,16 @@
   UNIQUE KEY `id` (`id`)
 ) ENGINE=MyISAM DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;
 
+DROP TABLE IF EXISTS `tiki_auth_tokens`;
+CREATE TABLE `tiki_auth_tokens` (
+	`tokenId` INT NOT NULL AUTO_INCREMENT,
+	`creation` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
+	`timeout` INT NOT NULL DEFAULT 0,
+	`token` CHAR(32),
+	`entry` VARCHAR(50),
+	`parameters` VARCHAR(255),
+	`groups` VARCHAR(255),
+	PRIMARY KEY( `tokenId` ),
+	KEY `tiki_auth_tokens_token` (`token`)
+);
+-- --------------------------------------------------------

------------------------------------------------------------------------
r22845 | nagendra016 | 2009-11-03 15:04:01 -0400 (ter, 03 nov 2009) | 1 line

[FIX]Broken Kaltura upload link on clean install

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 22844)
+++ tiki.sql	(revision 22845)
@@ -1413,9 +1413,9 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Comments','tiki-list_comments.php',1260,'feature_poll_comments','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Comments','tiki-list_comments.php',1260,'feature_faq_comments','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Contribution','tiki-admin_contribution.php',1265,'feature_contribution','tiki_p_admin_contribution','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 's', 'Kaltura', 'tiki-list_kaltura_entries.php', 950, 'feature_kaltura', 'tiki_p_admin | tiki_p_admin_kaltura | tiki_p_list_videos', '', 0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 's', 'Kaltura Video', 'tiki-list_kaltura_entries.php', 950, 'feature_kaltura', 'tiki_p_admin | tiki_p_admin_kaltura | tiki_p_list_videos', '', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'o', 'List Entries', 'tiki-list_kaltura_entries.php', 952, 'feature_kaltura', 'tiki_p_admin | tiki_p_admin_kaltura | tiki_p_list_videos', '', 0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'o', 'Upload Media', 'tiki-kaltura_video.php', 954, 'feature_kaltura', 'tiki_p_admin | tiki_p_admin_kaltura | tiki_p_upload_videos', '', 0);
+INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'o', 'Upload Media', 'tiki-kaltura_upload.php', 954, 'feature_kaltura', 'tiki_p_admin | tiki_p_admin_kaltura | tiki_p_upload_videos', '', 0);
 
 
 

------------------------------------------------------------------------
r22802 | marclaporte | 2009-11-02 20:54:09 -0400 (seg, 02 nov 2009) | 1 line

[KIL] Remove Workspace-Helper related files, as explained at http://article.gmane.org/gmane.comp.cms.tiki.devel/14261 Hope it is completed and added to Tiki5 or Tiki4.1    Workspace withouth helper, are working fine

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 22801)
+++ tiki.sql	(revision 22802)
@@ -1345,9 +1345,6 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','Newsletters','tiki-newsletters.php',900,'feature_newsletters','tiki_p_list_newsletters','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Send Newsletters','tiki-send_newsletters.php',905,'feature_newsletters','tiki_p_send_newsletters','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Admin Newsletters','tiki-admin_newsletters.php',910,'feature_newsletters','tiki_p_admin_newsletters','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'s','Workspaces','tiki-my-workspaces.php',920,'feature_workspaces','tiki_p_ws_view','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','My Workspaces','tiki-my-workspaces.php',925,'feature_workspaces','tiki_p_ws_view','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Manage Workspaces','tiki-manage-workspaces.php',935,'feature_workspaces','tiki_p_admin_ws.php','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'','tiki_p_admin_categories','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'r','Admin','tiki-admin.php',1050,'','tiki_p_admin_banners','',0);
@@ -1416,7 +1413,6 @@
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Comments','tiki-list_comments.php',1260,'feature_poll_comments','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Comments','tiki-list_comments.php',1260,'feature_faq_comments','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Contribution','tiki-admin_contribution.php',1265,'feature_contribution','tiki_p_admin_contribution','',0);
-INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42,'o','Workspaces','tiki-admin.php?page=workspaces',1270,'feature_workspaces','tiki_p_admin','',0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 's', 'Kaltura', 'tiki-list_kaltura_entries.php', 950, 'feature_kaltura', 'tiki_p_admin | tiki_p_admin_kaltura | tiki_p_list_videos', '', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'o', 'List Entries', 'tiki-list_kaltura_entries.php', 952, 'feature_kaltura', 'tiki_p_admin | tiki_p_admin_kaltura | tiki_p_list_videos', '', 0);
 INSERT INTO `tiki_menu_options` (`menuId`, `type`, `name`, `url`, `position`, `section`, `perm`, `groupname`, `userlevel`) VALUES (42, 'o', 'Upload Media', 'tiki-kaltura_video.php', 954, 'feature_kaltura', 'tiki_p_admin | tiki_p_admin_kaltura | tiki_p_upload_videos', '', 0);
@@ -2854,13 +2850,6 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_group_join', 'Can join or leave the group', 'admin', 'group', NULL, NULL);
 
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_trigger_transition', 'Can trigger the transition between two states', 'admin', 'transition', NULL, 'feature_group_transition,feature_category_transition');
-INSERT INTO users_permissions (`permName`, `permDesc`, level, type, admin) VALUES ('tiki_p_ws_admin', 'Can admin all ws', 'globaladmin', 'ws', 'y');
-INSERT INTO users_permissions (`permName`, `permDesc`, level, type) VALUES ('tiki_p_ws_addws', 'Can add ws', 'globaladmin', 'ws');
-INSERT INTO users_permissions (`permName`, `permDesc`, level, type) VALUES ('tiki_p_ws_removews', 'Can remove ws', 'globaladmin', 'ws');
-INSERT INTO users_permissions (`permName`, `permDesc`, level, type) VALUES ('tiki_p_ws_adminws', 'Can admin a single ws', 'admin', 'ws');
-INSERT INTO users_permissions (`permName`, `permDesc`, level, type) VALUES ('tiki_p_ws_adminresources', 'Can admin resources into single ws', 'admin', 'ws');
-INSERT INTO users_permissions (`permName`, `permDesc`, level, type) VALUES ('tiki_p_ws_admingroups', 'Can admin groups in a single ws', 'admin', 'ws');
-INSERT INTO users_permissions (`permName`, `permDesc`, level, type) VALUES ('tiki_p_ws_view', 'Can view a single ws', 'registered', 'ws');
 
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_kaltura', 'Can admin kaltura feature', 'admin', 'kaltura', 'y', 'feature_kaltura');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_upload_videos', 'Can upload video on kaltura server', 'editors', 'kaltura', NULL, 'feature_kaltura');

------------------------------------------------------------------------
r22728 | sylvieg | 2009-10-28 19:23:08 -0400 (qua, 28 out 2009) | 1 line

[MOD]fgal quota: alllows to limit the volume that is uploaded globally to the fgals or locally to a fgal

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 22727)
+++ tiki.sql	(revision 22728)
@@ -731,6 +731,7 @@
   `show_path` char(1) default NULL,
   `show_slideshow` char(1) default NULL,
   `default_view` varchar(20) default NULL,
+  `quota` int(8) default 0,
   PRIMARY KEY (`galleryId`)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 

------------------------------------------------------------------------
r22609 | sylvieg | 2009-10-23 09:37:15 -0400 (sex, 23 out 2009) | 1 line

[FIX]report: unused columnn needs a default

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 22608)
+++ tiki.sql	(revision 22609)
@@ -3419,7 +3419,7 @@
   `interval` varchar(20) NOT NULL,
   `view` varchar(8) NOT NULL,
   `type` varchar(5) NOT NULL,
-  `time_to_send` datetime NOT NULL,
+  `time_to_send` datetime NULL default 0,
   `always_email` tinyint(1) NOT NULL,
   `last_report` datetime NOT NULL,
   PRIMARY KEY (`id`)

------------------------------------------------------------------------
r22599 | chealer | 2009-10-23 02:59:51 -0400 (sex, 23 out 2009) | 2 lines

bump tiki_user_bookmarks_url.name from varchar(30) to varchar(200)


Index: tiki.sql
===================================================================
--- tiki.sql	(revision 22598)
+++ tiki.sql	(revision 22599)
@@ -2295,7 +2295,7 @@
 DROP TABLE IF EXISTS `tiki_user_bookmarks_urls`;
 CREATE TABLE `tiki_user_bookmarks_urls` (
   `urlId` int(12) NOT NULL auto_increment,
-  `name` varchar(30) default NULL,
+  `name` varchar(200) default NULL,
   `url` varchar(250) default NULL,
   `data` longblob,
   `lastUpdated` int(14) default NULL,

------------------------------------------------------------------------
r22525 | lphuberdeau | 2009-10-21 12:23:01 -0400 (qua, 21 out 2009) | 1 line

[NEW] Page list feature for l10n dashboard (upstream from Mozilla)

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 22524)
+++ tiki.sql	(revision 22525)
@@ -3463,3 +3463,20 @@
 	KEY `transition_lookup` (`type`, `from`)
 ) ENGINE=MyISAM;
 
+CREATE TABLE IF NOT EXISTS `tiki_page_lists` (
+  `list_type_id` int(8) unsigned NOT NULL,
+  `priority` int(8) unsigned NOT NULL,
+  `page_name` varchar(160) NOT NULL,
+  `score` float default NULL,
+  PRIMARY KEY  (`list_type_id`,`page_name`)
+) ENGINE=MyISAM DEFAULT CHARSET=latin1;
+
+CREATE TABLE IF NOT EXISTS `tiki_page_list_types` (
+  `id` int(8) unsigned NOT NULL auto_increment,
+  `name` varchar(40) NOT NULL,
+  `title` varchar(160) default NULL,
+  `description` varchar(200) default NULL,
+  PRIMARY KEY  (`name`),
+  UNIQUE KEY `id` (`id`)
+) ENGINE=MyISAM DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;
+

------------------------------------------------------------------------
r22503 | sylvieg | 2009-10-20 17:42:59 -0400 (ter, 20 out 2009) | 1 line

[FIX]sefurl : for trackeritem

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 22502)
+++ tiki.sql	(revision 22503)
@@ -3376,7 +3376,8 @@
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-list_trackers.php', 'trackers', '', 'feature_trackers', 200);
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-mobile.php', 'mobile', '', 'feature_mobile', 200);
 INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-sheets.php', 'sheets', '', 'feature_sheet', 200);
-
+INSERT INTO `tiki_sefurl_regex_out` (`left`, `right`, `type`, `feature`, `order`) VALUES('tiki-view_tracker_item.php\\?trackerId=(\\d+)\\&itemId=(\\d+)', 'item$2', 'trackeritem', 'feature_trackers', 200);
+ 
 UPDATE tiki_menu_options SET icon = 'icon-configuration48x48' WHERE name = 'Admin';
 UPDATE tiki_menu_options SET icon = 'xfce4-appfinder48x48' WHERE name = 'Search';
 UPDATE tiki_menu_options SET icon = 'wikipages48x48' WHERE name = 'Wiki';

------------------------------------------------------------------------
r22501 | lphuberdeau | 2009-10-20 16:51:42 -0400 (ter, 20 out 2009) | 1 line

[NEW] Upstreaming screencast feature from Mozilla, UI issues remaining

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 22500)
+++ tiki.sql	(revision 22501)
@@ -2869,6 +2869,7 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_download_videos', 'Can download kaltura entry', 'registered', 'kaltura', NULL, 'feature_kaltura');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_list_videos', 'Can list kaltura entries', 'basic', 'kaltura', NULL, 'feature_kaltura');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_videos', 'Can view kaltura entry', 'basic', 'kaltura', NULL, 'feature_kaltura');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_upload_screencast', 'Can upload screencasts to wiki pages', 'basic', 'registered', NULL, 'feature_wiki_screencasts');
 
 
 DROP TABLE IF EXISTS `users_usergroups`;

------------------------------------------------------------------------
r22494 | sylvieg | 2009-10-20 14:12:04 -0400 (ter, 20 out 2009) | 1 line

[MOD]faq: last validated faq questions

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 22493)
+++ tiki.sql	(revision 22494)
@@ -656,10 +656,12 @@
   `position` int(4) default NULL,
   `question` text,
   `answer` text,
+  `created` int(14) default NULL,
   PRIMARY KEY (`questionId`),
   KEY `faqId` (`faqId`),
   KEY `question` (question(255)),
   KEY `answer` (answer(255)),
+  KEY `created` (`created`),
   FULLTEXT KEY `ft` (question,answer)
 ) ENGINE=MyISAM AUTO_INCREMENT=1 ;
 

------------------------------------------------------------------------
r22470 | jonnybradley | 2009-10-20 10:22:24 -0400 (ter, 20 out 2009) | 2 lines

[FIX] Bigger user prefs value size (so it's now the same as tiki_prefs)
Was preventing group selection being saved on object perms

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 22469)
+++ tiki.sql	(revision 22470)
@@ -2374,7 +2374,7 @@
 CREATE TABLE `tiki_user_preferences` (
   `user` varchar(200) NOT NULL default '',
   `prefName` varchar(40) NOT NULL default '',
-  `value` varchar(250) default NULL,
+  `value` TEXT,
   PRIMARY KEY (`user`,`prefName`)
 ) ENGINE=MyISAM;
 

------------------------------------------------------------------------
r22426 | jonnybradley | 2009-10-19 13:59:13 -0400 (seg, 19 out 2009) | 1 line

[MOD] Moving a few perms that were not feature related and on their own into the tiki (or user)  perm "type"

Index: tiki.sql
===================================================================
--- tiki.sql	(revision 22425)
+++ tiki.sql	(revision 22426)
@@ -2662,8 +2662,8 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_detach_translation', 'Can remove association between two pages in a translation set', 'registered', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_cookies', 'Can admin cookies', 'editors', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_languages', 'Can edit translations and create new languages', 'editors', 'tiki', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_menu', 'Can edit menu', 'admin', 'menus', NULL, NULL);
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_menu_option', 'Can edit menu option', 'admin', 'menus', NULL, NULL);
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_menu', 'Can edit menu', 'admin', 'tiki', NULL, NULL);
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_menu_option', 'Can edit menu option', 'admin', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_templates', 'Can edit site templates', 'admin', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_search', 'Can search', 'basic', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_site_report', 'Can report a link to the webmaster', 'basic', 'tiki', NULL, NULL);
@@ -2724,7 +2724,7 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_poll_results', 'Can view poll results', 'basic', 'polls', NULL, 'feature_polls');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_vote_poll', 'Can vote polls', 'basic', 'polls', NULL, 'feature_polls');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_poll_voters', 'Can view poll voters', 'basic', 'polls', NULL, 'feature_polls');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_toolbars', 'Can admin toolbars', 'admin', 'toolbars', 'y', NULL);
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_toolbars', 'Can admin toolbars', 'admin', 'tiki', 'y', NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_quizzes', 'Can admin quizzes', 'editors', 'quizzes', 'y', 'feature_quizzes');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_take_quiz', 'Can take quizzes', 'basic', 'quizzes', NULL, 'feature_quizzes');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_quiz_stats', 'Can view quiz stats', 'basic', 'quizzes', NULL, 'feature_quizzes');
@@ -2815,7 +2815,7 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_use_content_templates', 'Can use content templates', 'registered', 'content templates', NULL, 'feature_wiki_templates,feature_cms_templates');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_edit_html_pages', 'Can edit HTML pages', 'editors', 'html pages', NULL, 'feature_html_pages');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_html_pages', 'Can view HTML pages', 'basic', 'html pages', NULL, 'feature_html_pages');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_list_users', 'Can list registered users', 'registered', 'community', NULL, 'feature_friends');
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_list_users', 'Can list registered users', 'registered', 'user', NULL, 'feature_friends');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_live_support_admin', 'Admin live support system', 'admin', 'support', 'y', 'feature_live_support');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_live_support', 'Can use live support system', 'basic', 'support', NULL, 'feature_live_support');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_map_create', 'Can create new mapfile', 'admin', 'maps', NULL, 'feature_maps');
@@ -2833,7 +2833,7 @@
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_plugin_approve', 'Can approve plugin execution', 'editors', 'wiki', NULL, 'feature_wiki');
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_trust_input', 'Trust all user inputs (no security checks)', 'admin', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_view_backlink', 'View page backlinks', 'basic', 'wiki', NULL, 'feature_wiki');
-INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_notifications', 'Can admin mail notifications', 'editors', 'mail notifications', NULL, NULL);
+INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_notifications', 'Can admin mail notifications', 'editors', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_invite', 'Can invite user in groups', 'editors', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_delete_account', 'Can delete his own account', 'admin', 'tiki', NULL, NULL);
 INSERT INTO `users_permissions` (`permName`, `permDesc`, `level`, `type`, `admin`, `feature_check`) VALUES('tiki_p_admin_importer', 'Can use the Tiki Importer', 'admin', 'tiki', 'y', NULL);

------------------------------------------------------------------------
r22374 | chealer | 2009-10-15 16:26:47 -0400 (qui, 15 out 2009) | 4 lines

rename RSS modules to External Feeds and RSS feeds to Feeds to generalize
while we're renaming menu links, also rename "Wiki Cache" to "External Pages Cache"
change External Feeds Admin help link to Feeds User


